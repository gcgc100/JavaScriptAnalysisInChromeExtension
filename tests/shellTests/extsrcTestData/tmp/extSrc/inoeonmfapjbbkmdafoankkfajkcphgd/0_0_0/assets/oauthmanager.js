this.oAuthManager=function(){this._profile=null,this._xmlhttp=new XMLHttpRequest,this._token='',this._getProfileDetailsURL='',this._callback=null,this._params=null,this.refreshAuthToken=function(){this._callback=null,this._params=null,chrome.identity.getAuthToken({interactive:!0},this.bind(this.onToken,this))},this.refreshAuthTokenSilent=function(){this._callback=null,this._params=null,chrome.identity.getAuthToken({interactive:!1},this.bind(this.onTokenSilent,this))},this.getAuthToken=function(a,b){return void 0==a?void this.refreshAuthToken():null==a?void this.refreshAuthToken():void(this._callback=a,this._params=b,chrome.identity.getAuthToken({interactive:!0},this.bind(this.onToken,this)))},this.getAuthTokenSilent=function(a,b){return void 0==a?void this.refreshAuthTokenSilent():null==a?void this.refreshAuthTokenSilent():void(this._callback=a,this._params=b,chrome.identity.getAuthToken({interactive:!1},this.bind(this.onTokenSilent,this)))},this.onToken=function(a){return null==a||void 0==a?null==this._callback?void 0:(this._callback(null,this._params),this._callback=null,void(this._params=null)):void(this._token=a,this._getProfileDetailsURL='https://www.googleapis.com/oauth2/v2/userinfo?access_token='+a,this._xmlhttp.onreadystatechange=this.bind(this.onProfile,this),this._xmlhttp.open('GET',this._getProfileDetailsURL,!0),this._xmlhttp.send())},this.onTokenSilent=function(a){return null==a||void 0==a?null==this._callback?void 0:(this._callback(null,this._params),this._callback=null,void(this._params=null)):void(this._token=a,this._getProfileDetailsURL='https://www.googleapis.com/oauth2/v2/userinfo?access_token='+a,this._xmlhttp.onreadystatechange=this.bind(this.onProfileSilent,this),this._xmlhttp.open('GET',this._getProfileDetailsURL,!0),this._xmlhttp.send())},this.onProfile=function(){if(4==this._xmlhttp.readyState&&200==this._xmlhttp.status){if(this._profile=JSON.parse(this._xmlhttp.responseText),this.convertImgToBase64(this._profile.picture,this.bind(this.onConvertProfileImagetoBase64,this)),this._profile.token=this._token,null==this._callback)return;this._callback(this._profile,this._params),this._callback=null,this._params=null}4==this._xmlhttp.readyState&&401==this._xmlhttp.status&&(console.log('401 error'),chrome.identity.removeCachedAuthToken({token:this._token},this.bind(this.onCachedTokenRemoved,this)))},this.onProfileSilent=function(){if(4==this._xmlhttp.readyState&&200==this._xmlhttp.status){if(this._profile=JSON.parse(this._xmlhttp.responseText),this.convertImgToBase64(this._profile.picture,this.bind(this.onConvertProfileImagetoBase64,this)),this._profile.token=this._token,null==this._callback)return;this._callback(this._profile,this._params),this._callback=null,this._params=null}4==this._xmlhttp.readyState&&401==this._xmlhttp.status&&(console.log('401 error'),chrome.identity.removeCachedAuthToken({token:this._token},this.bind(this.onCachedTokenRemovedSilent,this)))},this.getProfileDetails=function(){return this._profile},this.onConvertProfileImagetoBase64=function(a){this._profile.pictureBase64=a},this.onCachedTokenRemoved=function(){this.refreshAuthToken()},this.onCachedTokenRemovedSilent=function(){this.refreshAuthTokenSilent()},this.convertImgToBase64=function(a,b,c){var d=document.createElement('CANVAS'),e=d.getContext('2d'),f=new Image;f.crossOrigin='Anonymous',f.onload=function(){d.height=f.height,d.width=f.width,e.drawImage(f,0,0);var a=d.toDataURL(c||'image/png');b.call(this,a),d=null},f.src=a},this.bind=function(a,b){return function(){return a.apply(b,Array.prototype.slice.call(arguments))}}};