(function(a,b){'object'==typeof exports&&'object'==typeof module?module.exports=b():'function'==typeof define&&define.amd?define([],b):'object'==typeof exports?exports.texthelpcheckit=b():a.texthelpcheckit=b()})('undefined'==typeof self?this:self,function(){return function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,b),e.l=!0,e.exports}var c={};return b.m=a,b.c=c,b.d=function(a,c,d){b.o(a,c)||Object.defineProperty(a,c,{configurable:!1,enumerable:!0,get:d})},b.n=function(a){var c=a&&a.__esModule?function(){return a['default']}:function(){return a};return b.d(c,'a',c),c},b.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},b.p='',b(b.s=1)}([function(a,b){'use strict';Object.defineProperty(b,'__esModule',{value:!0});class c{constructor(a,b){this._currentPageURL=a,this._extensionID=b,this._itemsToIgnore={},this._itemsToIgnore.ignoredWords=[],this._itemsToIgnore.dictionaryWords=[],this._itemsToIgnore.ignoredRules=[],texthelp.CheckitLib.disabledRules=[],null==texthelp.CheckitLib.PubSub&&(texthelp.CheckitLib.PubSub=texthelp.CheckitLib.CheckItPubSub()),this._currentCheckItToShow=null,this._ciManager=new texthelp.CheckitLib.GDocsManager;var c=document.createElement('style');c.appendChild(document.createTextNode('')),document.head.appendChild(c),this.m_sheet=c.sheet,this.m_checkItArrowPositionRuleID=null,window.addEventListener('resize',()=>this._onResizeBrowserWindow(event)),this._getIgnoreItems(),this._langauge='en-US'}checkItOn(){var a=0<arguments.length&&arguments[0]!==void 0?arguments[0]:!0,b=1<arguments.length&&arguments[1]!==void 0?arguments[1]:!0;null==this._unsub&&texthelp.CheckitLib.PubSub!==void 0&&(this._unsub=texthelp.CheckitLib.PubSub.sub(this._onPubSubEvent.bind(this))),this._ciManager.checkItOn(a,b,this.productString)}checkItOff(){null==this._unsub||(this._unsub(),this._unsub=null),this._ciManager.checkItOff()}clearOtherProductHighlights(){var a=0<arguments.length&&arguments[0]!==void 0?arguments[0]:'';1>a.length||this._ciManager.clearOtherProductHighlights(a)}get productString(){return''}set language(a){if(-1<['en_US','en_GB'].indexOf(a)){this._langauge=a;var b={};b.method='onLanguageChanged',b.type='FR_P_1342_CK',b.language=a,chrome.runtime.sendMessage(this._extensionID,b)}}get language(){return this._langauge}getAllDocumentText(){return this._ciManager.getAllDocumentText()}reCheckPages(){this._ciManager.reCheckPages()}_onPubSubEvent(a,b){try{this['_on'+a]!==void 0&&this['_on'+a](b)}catch(a){console.log(a)}}_onCheckItText(a,b,c,d){var e={};e.textDetails=a,e.method='onCheckitRequest',e.type='FR_P_1342_CK',e.id=b,e.hash=c,e.metaData=d,chrome.runtime.sendMessage(this._extensionID,e,function(a){texthelp.CheckitLib.PubSub!==void 0&&texthelp.CheckitLib.PubSub.pub('TPSOnCheckit',a)}.bind(this)),this._sendAnalyticsEvent('checkit lookup')}_onTPSDoCheckit(a){this._onCheckItText(a[0],a[1],a[2],a[3])}_getIgnoreItems(){var a={};a.method='onGetSavedIgnoreLists',a.type='FR_P_1342_CK',chrome.runtime.sendMessage(this._extensionID,a,function(a){try{this._itemsToIgnore.dictionaryWords=a.payload.dictionaryWords,this._saveItemsToIgnore()}catch(a){}}.bind(this))}_updateDomWithIgnoredWord(a){var b=1<arguments.length&&arguments[1]!==void 0?arguments[1]:!0,c=[].slice.call(document.querySelectorAll('.th-checkit-word-'+this._ciManager._toHash(a.toString())));c.forEach((a)=>{a.classList.add('th-checkit-ignore')})}_addToDictionaryWords(a){if(!(-1<this._itemsToIgnore.dictionaryWords.indexOf(a))){this._itemsToIgnore.dictionaryWords.push(a),this._saveItemsToIgnore();var b={};b.method='onAddToDictionaryWords',b.type='FR_P_1342_CK',b.wordToIgnore=this.trimPuncOffStartAndEndOfString(a),chrome.runtime.sendMessage(this._extensionID,b)}}_are_arrs_different(a,b){return a.sort().toString()!==b.sort().toString()}_get_arr1_not_arr2(a,b){return a.filter((a)=>!b.includes(a))}_onTPSCheckitDictionaryChanged(a){var b=this._itemsToIgnore.dictionaryWords.length!==a.length;if(b||(b=this._are_arrs_different(this._itemsToIgnore.dictionaryWords,a)),!!b){var c=this._get_arr1_not_arr2(a,this._itemsToIgnore.dictionaryWords),d=this._get_arr1_not_arr2(this._itemsToIgnore.dictionaryWords,a);if(0<d.length){var e=[];d.forEach((a)=>{e=[].slice.call(document.querySelectorAll('.th-checkit-word-'+this._ciManager._toHash(a.toString()))),e.forEach((a)=>{a.classList.remove('th-checkit-ignore')})})}if(0<c.length){var f=[];c.forEach((a)=>{f=[].slice.call(document.querySelectorAll('.th-checkit-word-'+this._ciManager._toHash(a).toString())),f.forEach((a)=>{a.classList.add('th-checkit-ignore')})})}this._itemsToIgnore.dictionaryWords=a,this._saveItemsToIgnore()}}_saveItemsToIgnore(){var a=this._itemsToIgnore.dictionaryWords.concat(this._itemsToIgnore.ignoredWords);this._ciManager.setItemsToIgnore(a,this._itemsToIgnore.ignoredRules);var b={};b.method='onUpdateDictionaryItems',b.type='FR_P_1342_CK',b.dictionary=this._itemsToIgnore.dictionaryWords,chrome.runtime.sendMessage(this._extensionID,b)}_setIgnoreGrammarRule(a){0>this._itemsToIgnore.ignoredRules.indexOf(a)&&(this._itemsToIgnore.ignoredRules.push(a),this._ciManager.setIgnoreGrammarRule(a))}_ignoreCurrentGrammarMistake(){try{var a=this._ciManager.ignoreCurrentGrammarMistake();this._sendAnalyticsEvent('ignoregrammarrule:'+this._langauge+':'+a.rule.id)}catch(a){}}_ignoreAllSpellingMistake(){try{var a=this._ciManager.ignoreAllSpellingMistake();0>this._itemsToIgnore.ignoredWords.indexOf(a)&&(this._itemsToIgnore.ignoredWords.push(a),this._saveItemsToIgnore(),this._sendAnalyticsEvent('ignoreall:'+this._langauge+':'+a))}catch(a){}}_addSpellingMistakeToDictionary(){try{var a=this._ciManager.ignoreAllSpellingMistake();this._addToDictionaryWords(a),this._sendAnalyticsEvent('addtodictionary:'+this._langauge+':'+a)}catch(a){}}_changeToSuggestion(a,b){try{this._ciManager.changeToSuggestion(a,b),this._sendAnalyticsEvent('changetosuggestion:'+this._langauge+':'+b.word.substr(0,b.length)+':'+a)}catch(a){}}_closeCheckItUI(){0<arguments.length&&arguments[0]!==void 0?arguments[0]:null}_onResizeBrowserWindow(){null==this._unsub&&texthelp.CheckitLib.PubSub.pub('TPSOnCheckit',null),this._closeCheckItUI()}_getElemsWithClassFromPoint(a,b,c){var d=document.elementsFromPoint(b,c);return d=d.filter((b)=>b.classList.contains(a)),0<d.length?d:[]}_sendAnalyticsEvent(a){var b=textHelp.webreaderapi.HelpersSingleton.getInst().getLicense(),c=[];c.push(a),c.push(b.Email),c.push(b.Email.split('@')[1]),window.thPostMessage({type:'1757FROM_PAGERW4G',key:'function',method:'SendEvent',parameters:c},'*')}}b.default=c},function(a,b,c){'use strict';function d(a){return a&&a.__esModule?a:{default:a}}var e=c(0),f=d(e),g=c(2),h=d(g);window.texthelp=window.texthelp||{},window.texthelp.CheckitLib=window.texthelp.CheckitLib||{},window.texthelp.CheckitLib.CheckItManager=f.default,window.texthelp.CheckitLib.CheckItPubSub=h.default},function(a){'use strict';a.exports=()=>{var a=new Set;return Object.freeze({pub:(b,c)=>a.forEach((a)=>a(b,c)),sub:(b)=>(a.add(b),()=>a.delete(b))})}}])});