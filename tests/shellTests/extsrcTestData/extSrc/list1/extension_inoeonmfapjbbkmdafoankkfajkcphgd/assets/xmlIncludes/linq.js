var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(t,e){var n={Identity:function(t){return t},True:function(){return!0},Blank:function(){}},r={Boolean:_typeof(!0),Number:_typeof(0),String:_typeof(""),Object:_typeof({}),Undefined:"undefined",Function:_typeof(function(){})},o={createLambda:function(t){if(null==t)return n.Identity;if((void 0===t?"undefined":_typeof(t))==r.String){if(""==t)return n.Identity;if(-1==t.indexOf("=>")){for(var e,o=new RegExp("[$]+","g"),u=0;e=o.exec(t);){var i=e[0].length;i>u&&(u=i)}for(var c=[],a=1;a<=u;a++){for(var f="",s=0;s<a;s++)f+="$";c.push(f)}var l=Array.prototype.join.call(c,",");return new Function(l,"return "+t)}var p=t.match(/^[(\s]*([^()]*?)[)\s]*=>(.*)/);return new Function(p[1],"return "+p[2])}return t},isIEnumerable:function(t){if(("undefined"==typeof Enumerator?"undefined":_typeof(Enumerator))!==r.Undefined)try{return new Enumerator(t),!0}catch(t){}return!1},defineProperty:null!=Object.defineProperties?function(t,e,n){Object.defineProperty(t,e,{enumerable:!1,configurable:!0,writable:!0,value:n})}:function(t,e,n){t[e]=n},compare:function(t,e){return t===e?0:t>e?1:-1},dispose:function(t){null!=t&&t.dispose()}},u={Before:0,Running:1,After:2},i=function(t,e,n){var r=new c,o=u.Before;this.current=r.current,this.moveNext=function(){try{switch(o){case u.Before:o=u.Running,t();case u.Running:return!!e.apply(r)||(this.dispose(),!1);case u.After:return!1}}catch(t){throw this.dispose(),t}},this.dispose=function(){if(o==u.Running)try{n()}finally{o=u.After}}},c=function(){var t=null;this.current=function(){return t},this.yieldReturn=function(e){return t=e,!0},this.yieldBreak=function(){return!1}},a=function(t){this.getEnumerator=t};a.Utils={},a.Utils.createLambda=function(t){return o.createLambda(t)},a.Utils.createEnumerable=function(t){return new a(t)},a.Utils.createEnumerator=function(t,e,n){return new i(t,e,n)},a.Utils.extendTo=function(t){var e,n=t.prototype;t===Array?(e=p.prototype,o.defineProperty(n,"getSource",function(){return this})):(e=a.prototype,o.defineProperty(n,"getEnumerator",function(){return a.from(this).getEnumerator()}));for(var r in e){var u=e[r];n[r]!=u&&(null!=n[r]&&(r+="ByLinq",n[r]==u)||u instanceof Function&&o.defineProperty(n,r,u))}},a.choice=function(){var t=arguments;return new a(function(){return new i(function(){t=t[0]instanceof Array?t[0]:null!=t[0].getEnumerator?t[0].toArray():t},function(){return this.yieldReturn(t[Math.floor(Math.random()*t.length)])},n.Blank)})},a.cycle=function(){var t=arguments;return new a(function(){var e=0;return new i(function(){t=t[0]instanceof Array?t[0]:null!=t[0].getEnumerator?t[0].toArray():t},function(){return e>=t.length&&(e=0),this.yieldReturn(t[e++])},n.Blank)})},a.empty=function(){return new a(function(){return new i(n.Blank,function(){return!1},n.Blank)})},a.from=function(t){if(null==t)return a.empty();if(t instanceof a)return t;if((void 0===t?"undefined":_typeof(t))==r.Number||(void 0===t?"undefined":_typeof(t))==r.Boolean)return a.repeat(t,1);if((void 0===t?"undefined":_typeof(t))==r.String)return new a(function(){var e=0;return new i(n.Blank,function(){return e<t.length&&this.yieldReturn(t.charAt(e++))},n.Blank)});if((void 0===t?"undefined":_typeof(t))!=r.Function){if(_typeof(t.length)==r.Number)return new p(t);if(!(t instanceof Object)&&o.isIEnumerable(t))return new a(function(){var e,r=!0;return new i(function(){e=new Enumerator(t)},function(){return r?r=!1:e.moveNext(),!e.atEnd()&&this.yieldReturn(e.item())},n.Blank)});if(("undefined"==typeof Windows?"undefined":_typeof(Windows))===r.Object&&_typeof(t.first)===r.Function)return new a(function(){var e,r=!0;return new i(function(){e=t.first()},function(){return r?r=!1:e.moveNext(),e.hasCurrent?this.yieldReturn(e.current):this.yieldBreak()},n.Blank)})}return new a(function(){var e=[],r=0;return new i(function(){for(var n in t){var r=t[n];r instanceof Function||!Object.prototype.hasOwnProperty.call(t,n)||e.push({key:n,value:r})}},function(){return r<e.length&&this.yieldReturn(e[r++])},n.Blank)})},a.make=function(t){return a.repeat(t,1)},a.matches=function(t,e,r){return null==r&&(r=""),e instanceof RegExp&&(r+=e.ignoreCase?"i":"",r+=e.multiline?"m":"",e=e.source),-1===r.indexOf("g")&&(r+="g"),new a(function(){var o;return new i(function(){o=new RegExp(e,r)},function(){var e=o.exec(t);return!!e&&this.yieldReturn(e)},n.Blank)})},a.range=function(t,e,r){return null==r&&(r=1),new a(function(){var o,u=0;return new i(function(){o=t-r},function(){return u++<e?this.yieldReturn(o+=r):this.yieldBreak()},n.Blank)})},a.rangeDown=function(t,e,r){return null==r&&(r=1),new a(function(){var o,u=0;return new i(function(){o=t+r},function(){return u++<e?this.yieldReturn(o-=r):this.yieldBreak()},n.Blank)})},a.rangeTo=function(t,e,r){return null==r&&(r=1),new a(t<e?function(){var o;return new i(function(){o=t-r},function(){var t=o+=r;return t<=e?this.yieldReturn(t):this.yieldBreak()},n.Blank)}:function(){var o;return new i(function(){o=t+r},function(){var t=o-=r;return t>=e?this.yieldReturn(t):this.yieldBreak()},n.Blank)})},a.repeat=function(t,e){return null!=e?a.repeat(t).take(e):new a(function(){return new i(n.Blank,function(){return this.yieldReturn(t)},n.Blank)})},a.repeatWithFinalize=function(t,e){return t=o.createLambda(t),e=o.createLambda(e),new a(function(){var n;return new i(function(){n=t()},function(){return this.yieldReturn(n)},function(){null!=n&&(e(n),n=null)})})},a.generate=function(t,e){return null!=e?a.generate(t).take(e):(t=o.createLambda(t),new a(function(){return new i(n.Blank,function(){return this.yieldReturn(t())},n.Blank)}))},a.toInfinity=function(t,e){return null==t&&(t=0),null==e&&(e=1),new a(function(){var r;return new i(function(){r=t-e},function(){return this.yieldReturn(r+=e)},n.Blank)})},a.toNegativeInfinity=function(t,e){return null==t&&(t=0),null==e&&(e=1),new a(function(){var r;return new i(function(){r=t+e},function(){return this.yieldReturn(r-=e)},n.Blank)})},a.unfold=function(t,e){return e=o.createLambda(e),new a(function(){var r,o=!0;return new i(n.Blank,function(){return o?(o=!1,r=t,this.yieldReturn(r)):(r=e(r),this.yieldReturn(r))},n.Blank)})},a.defer=function(t){return new a(function(){var e;return new i(function(){e=a.from(t()).getEnumerator()},function(){return e.moveNext()?this.yieldReturn(e.current()):this.yieldBreak()},function(){o.dispose(e)})})},a.prototype.traverseBreadthFirst=function(t,e){var n=this;return t=o.createLambda(t),e=o.createLambda(e),new a(function(){var r,u=0,c=[];return new i(function(){r=n.getEnumerator()},function(){for(;;){if(r.moveNext())return c.push(r.current()),this.yieldReturn(e(r.current(),u));var n=a.from(c).selectMany(function(e){return t(e)});if(!n.any())return!1;u++,c=[],o.dispose(r),r=n.getEnumerator()}},function(){o.dispose(r)})})},a.prototype.traverseDepthFirst=function(t,e){var n=this;return t=o.createLambda(t),e=o.createLambda(e),new a(function(){var r,u=[];return new i(function(){r=n.getEnumerator()},function(){for(;;){if(r.moveNext()){var n=e(r.current(),u.length);return u.push(r),r=a.from(t(r.current())).getEnumerator(),this.yieldReturn(n)}if(u.length<=0)return!1;o.dispose(r),r=u.pop()}},function(){try{o.dispose(r)}finally{a.from(u).forEach(function(t){t.dispose()})}})})},a.prototype.flatten=function(){var t=this;return new a(function(){var e,r=null;return new i(function(){e=t.getEnumerator()},function(){for(;;){if(null!=r){if(r.moveNext())return this.yieldReturn(r.current());r=null}if(e.moveNext()){if(e.current()instanceof Array){o.dispose(r),r=a.from(e.current()).selectMany(n.Identity).flatten().getEnumerator();continue}return this.yieldReturn(e.current())}return!1}},function(){try{o.dispose(e)}finally{o.dispose(r)}})})},a.prototype.pairwise=function(t){var e=this;return t=o.createLambda(t),new a(function(){var n;return new i(function(){n=e.getEnumerator(),n.moveNext()},function(){var e=n.current();return!!n.moveNext()&&this.yieldReturn(t(e,n.current()))},function(){o.dispose(n)})})},a.prototype.scan=function(t,e){var n;null==e?(e=o.createLambda(t),n=!1):(e=o.createLambda(e),n=!0);var r=this;return new a(function(){var u,c,a=!0;return new i(function(){u=r.getEnumerator()},function(){if(a){if(a=!1,n)return this.yieldReturn(c=t);if(u.moveNext())return this.yieldReturn(c=u.current())}return!!u.moveNext()&&this.yieldReturn(c=e(c,u.current()))},function(){o.dispose(u)})})},a.prototype.select=function(t){if(t=o.createLambda(t),t.length<=1)return new d(this,null,t);var e=this;return new a(function(){var n,r=0;return new i(function(){n=e.getEnumerator()},function(){return!!n.moveNext()&&this.yieldReturn(t(n.current(),r++))},function(){o.dispose(n)})})},a.prototype.selectMany=function(t,e){var n=this;return t=o.createLambda(t),null==e&&(e=function(t,e){return e}),e=o.createLambda(e),new a(function(){var r,u=void 0,c=0;return new i(function(){r=n.getEnumerator()},function(){if(void 0===u&&!r.moveNext())return!1;do{if(null==u){var n=t(r.current(),c++);u=a.from(n).getEnumerator()}if(u.moveNext())return this.yieldReturn(e(r.current(),u.current()));o.dispose(u),u=null}while(r.moveNext());return!1},function(){try{o.dispose(r)}finally{o.dispose(u)}})})},a.prototype.where=function(t){if(t=o.createLambda(t),t.length<=1)return new h(this,t);var e=this;return new a(function(){var n,r=0;return new i(function(){n=e.getEnumerator()},function(){for(;n.moveNext();)if(t(n.current(),r++))return this.yieldReturn(n.current());return!1},function(){o.dispose(n)})})},a.prototype.choose=function(t){t=o.createLambda(t);var e=this;return new a(function(){var n,r=0;return new i(function(){n=e.getEnumerator()},function(){for(;n.moveNext();){var e=t(n.current(),r++);if(null!=e)return this.yieldReturn(e)}return this.yieldBreak()},function(){o.dispose(n)})})},a.prototype.ofType=function(t){var e;switch(t){case Number:e=r.Number;break;case String:e=r.String;break;case Boolean:e=r.Boolean;break;case Function:e=r.Function;break;default:e=null}return null===e?this.where(function(e){return e instanceof t}):this.where(function(t){return(void 0===t?"undefined":_typeof(t))===e})},a.prototype.zip=function(){var t=arguments,e=o.createLambda(arguments[arguments.length-1]),n=this;if(2==arguments.length){var r=arguments[0];return new a(function(){var t,u,c=0;return new i(function(){t=n.getEnumerator(),u=a.from(r).getEnumerator()},function(){return!(!t.moveNext()||!u.moveNext())&&this.yieldReturn(e(t.current(),u.current(),c++))},function(){try{o.dispose(t)}finally{o.dispose(u)}})})}return new a(function(){var r,u=0;return new i(function(){var e=a.make(n).concat(a.from(t).takeExceptLast().select(a.from)).select(function(t){return t.getEnumerator()}).toArray();r=a.from(e)},function(){if(r.all(function(t){return t.moveNext()})){var t=r.select(function(t){return t.current()}).toArray();return t.push(u++),this.yieldReturn(e.apply(null,t))}return this.yieldBreak()},function(){a.from(r).forEach(o.dispose)})})},a.prototype.merge=function(){var t=arguments,e=this;return new a(function(){var n,r=-1;return new i(function(){n=a.make(e).concat(a.from(t).select(a.from)).select(function(t){return t.getEnumerator()}).toArray()},function(){for(;n.length>0;){r=r>=n.length-1?0:r+1;var t=n[r];if(t.moveNext())return this.yieldReturn(t.current());t.dispose(),n.splice(r--,1)}return this.yieldBreak()},function(){a.from(n).forEach(o.dispose)})})},a.prototype.join=function(t,e,r,u,c){e=o.createLambda(e),r=o.createLambda(r),u=o.createLambda(u),c=o.createLambda(c);var f=this;return new a(function(){var s,l,p=null,h=0;return new i(function(){s=f.getEnumerator(),l=a.from(t).toLookup(r,n.Identity,c)},function(){for(;;){if(null!=p){var t=p[h++];if(void 0!==t)return this.yieldReturn(u(s.current(),t));t=null,h=0}if(!s.moveNext())return!1;var n=e(s.current());p=l.get(n).toArray()}},function(){o.dispose(s)})})},a.prototype.groupJoin=function(t,e,r,u,c){e=o.createLambda(e),r=o.createLambda(r),u=o.createLambda(u),c=o.createLambda(c);var f=this;return new a(function(){var s=f.getEnumerator(),l=null;return new i(function(){s=f.getEnumerator(),l=a.from(t).toLookup(r,n.Identity,c)},function(){if(s.moveNext()){var t=l.get(e(s.current()));return this.yieldReturn(u(s.current(),t))}return!1},function(){o.dispose(s)})})},a.prototype.all=function(t){t=o.createLambda(t);var e=!0;return this.forEach(function(n){if(!t(n))return e=!1,!1}),e},a.prototype.any=function(t){t=o.createLambda(t);var e=this.getEnumerator();try{if(0==arguments.length)return e.moveNext();for(;e.moveNext();)if(t(e.current()))return!0;return!1}finally{o.dispose(e)}},a.prototype.isEmpty=function(){return!this.any()},a.prototype.concat=function(){var t=this;if(1==arguments.length){var e=arguments[0];return new a(function(){var n,r;return new i(function(){n=t.getEnumerator()},function(){if(null==r){if(n.moveNext())return this.yieldReturn(n.current());r=a.from(e).getEnumerator()}return!!r.moveNext()&&this.yieldReturn(r.current())},function(){try{o.dispose(n)}finally{o.dispose(r)}})})}var n=arguments;return new a(function(){var e;return new i(function(){e=a.make(t).concat(a.from(n).select(a.from)).select(function(t){return t.getEnumerator()}).toArray()},function(){for(;e.length>0;){var t=e[0];if(t.moveNext())return this.yieldReturn(t.current());t.dispose(),e.splice(0,1)}return this.yieldBreak()},function(){a.from(e).forEach(o.dispose)})})},a.prototype.insert=function(t,e){var n=this;return new a(function(){var r,u,c=0,f=!1;return new i(function(){r=n.getEnumerator(),u=a.from(e).getEnumerator()},function(){return c==t&&u.moveNext()?(f=!0,this.yieldReturn(u.current())):r.moveNext()?(c++,this.yieldReturn(r.current())):!(f||!u.moveNext())&&this.yieldReturn(u.current())},function(){try{o.dispose(r)}finally{o.dispose(u)}})})},a.prototype.alternate=function(t){var e=this;return new a(function(){var n,r,u,c;return new i(function(){u=t instanceof Array||null!=t.getEnumerator?a.from(a.from(t).toArray()):a.make(t),r=e.getEnumerator(),r.moveNext()&&(n=r.current())},function(){for(;;){if(null!=c){if(c.moveNext())return this.yieldReturn(c.current());c=null}{if(null!=n||!r.moveNext()){if(null!=n){var t=n;return n=null,this.yieldReturn(t)}return this.yieldBreak()}n=r.current(),c=u.getEnumerator()}}},function(){try{o.dispose(r)}finally{o.dispose(c)}})})},a.prototype.contains=function(t,e){e=o.createLambda(e);var n=this.getEnumerator();try{for(;n.moveNext();)if(e(n.current())===t)return!0;return!1}finally{o.dispose(n)}},a.prototype.defaultIfEmpty=function(t){var e=this;return void 0===t&&(t=null),new a(function(){var n,r=!0;return new i(function(){n=e.getEnumerator()},function(){return n.moveNext()?(r=!1,this.yieldReturn(n.current())):!!r&&(r=!1,this.yieldReturn(t))},function(){o.dispose(n)})})},a.prototype.distinct=function(t){return this.except(a.empty(),t)},a.prototype.distinctUntilChanged=function(t){t=o.createLambda(t);var e=this;return new a(function(){var n,r,u;return new i(function(){n=e.getEnumerator()},function(){for(;n.moveNext();){var e=t(n.current());if(u)return u=!1,r=e,this.yieldReturn(n.current());if(r!==e)return r=e,this.yieldReturn(n.current())}return this.yieldBreak()},function(){o.dispose(n)})})},a.prototype.except=function(t,e){e=o.createLambda(e);var n=this;return new a(function(){var r,u;return new i(function(){r=n.getEnumerator(),u=new y(e),a.from(t).forEach(function(t){u.add(t)})},function(){for(;r.moveNext();){var t=r.current();if(!u.contains(t))return u.add(t),this.yieldReturn(t)}return!1},function(){o.dispose(r)})})},a.prototype.intersect=function(t,e){e=o.createLambda(e);var n=this;return new a(function(){var r,u,c;return new i(function(){r=n.getEnumerator(),u=new y(e),a.from(t).forEach(function(t){u.add(t)}),c=new y(e)},function(){for(;r.moveNext();){var t=r.current();if(!c.contains(t)&&u.contains(t))return c.add(t),this.yieldReturn(t)}return!1},function(){o.dispose(r)})})},a.prototype.sequenceEqual=function(t,e){e=o.createLambda(e);var n=this.getEnumerator();try{var r=a.from(t).getEnumerator();try{for(;n.moveNext();)if(!r.moveNext()||e(n.current())!==e(r.current()))return!1;return!r.moveNext()}finally{o.dispose(r)}}finally{o.dispose(n)}},a.prototype.union=function(t,e){e=o.createLambda(e);var n=this;return new a(function(){var r,u,c;return new i(function(){r=n.getEnumerator(),c=new y(e)},function(){var e;if(void 0===u){for(;r.moveNext();)if(e=r.current(),!c.contains(e))return c.add(e),this.yieldReturn(e);u=a.from(t).getEnumerator()}for(;u.moveNext();)if(e=u.current(),!c.contains(e))return c.add(e),this.yieldReturn(e);return!1},function(){try{o.dispose(r)}finally{o.dispose(u)}})})},a.prototype.orderBy=function(t){return new f(this,t,!1)},a.prototype.orderByDescending=function(t){return new f(this,t,!0)},a.prototype.reverse=function(){var t=this;return new a(function(){var e,r;return new i(function(){e=t.toArray(),r=e.length},function(){return r>0&&this.yieldReturn(e[--r])},n.Blank)})},a.prototype.shuffle=function(){var t=this;return new a(function(){var e;return new i(function(){e=t.toArray()},function(){if(e.length>0){var t=Math.floor(Math.random()*e.length);return this.yieldReturn(e.splice(t,1)[0])}return!1},n.Blank)})},a.prototype.weightedSample=function(t){t=o.createLambda(t);var e=this;return new a(function(){var r,o=0;return new i(function(){r=e.choose(function(e){var n=t(e);return n<=0?null:(o+=n,{value:e,bound:o})}).toArray()},function(){if(r.length>0){for(var t=Math.floor(Math.random()*o)+1,e=-1,n=r.length;n-e>1;){var u=Math.floor((e+n)/2);r[u].bound>=t?n=u:e=u}return this.yieldReturn(r[n].value)}return this.yieldBreak()},n.Blank)})},a.prototype.groupBy=function(t,e,n,r){var u=this;return t=o.createLambda(t),e=o.createLambda(e),null!=n&&(n=o.createLambda(n)),r=o.createLambda(r),new a(function(){var c;return new i(function(){c=u.toLookup(t,e,r).toEnumerable().getEnumerator()},function(){for(;c.moveNext();)return null==n?this.yieldReturn(c.current()):this.yieldReturn(n(c.current().key(),c.current()));return!1},function(){o.dispose(c)})})},a.prototype.partitionBy=function(t,e,n,r){var u=this;t=o.createLambda(t),e=o.createLambda(e),r=o.createLambda(r);var c;return null==n?(c=!1,n=function(t,e){return new m(t,e)}):(c=!0,n=o.createLambda(n)),new a(function(){var f,s,l,p=[];return new i(function(){f=u.getEnumerator(),f.moveNext()&&(s=t(f.current()),l=r(s),p.push(e(f.current())))},function(){for(var o;1==(o=f.moveNext())&&l===r(t(f.current()));)p.push(e(f.current()));if(p.length>0){var u=c?n(s,a.from(p)):n(s,p);return o?(s=t(f.current()),l=r(s),p=[e(f.current())]):p=[],this.yieldReturn(u)}return!1},function(){o.dispose(f)})})},a.prototype.buffer=function(t){var e=this;return new a(function(){var n;return new i(function(){n=e.getEnumerator()},function(){for(var e=[],r=0;n.moveNext();)if(e.push(n.current()),++r>=t)return this.yieldReturn(e);return e.length>0&&this.yieldReturn(e)},function(){o.dispose(n)})})},a.prototype.aggregate=function(t,e,n){return(n=o.createLambda(n))(this.scan(t,e,n).last())},a.prototype.average=function(t){t=o.createLambda(t);var e=0,n=0;return this.forEach(function(r){e+=t(r),++n}),e/n},a.prototype.count=function(t){t=null==t?n.True:o.createLambda(t);var e=0;return this.forEach(function(n,r){t(n,r)&&++e}),e},a.prototype.max=function(t){return null==t&&(t=n.Identity),this.select(t).aggregate(function(t,e){return t>e?t:e})},a.prototype.min=function(t){return null==t&&(t=n.Identity),this.select(t).aggregate(function(t,e){return t<e?t:e})},a.prototype.maxBy=function(t){return t=o.createLambda(t),this.aggregate(function(e,n){return t(e)>t(n)?e:n})},a.prototype.minBy=function(t){return t=o.createLambda(t),this.aggregate(function(e,n){return t(e)<t(n)?e:n})},a.prototype.sum=function(t){return null==t&&(t=n.Identity),this.select(t).aggregate(0,function(t,e){return t+e})},a.prototype.elementAt=function(t){var e,n=!1;if(this.forEach(function(r,o){if(o==t)return e=r,n=!0,!1}),!n)throw new Error("index is less than 0 or greater than or equal to the number of elements in source.");return e},a.prototype.elementAtOrDefault=function(t,e){void 0===e&&(e=null);var n,r=!1;return this.forEach(function(e,o){if(o==t)return n=e,r=!0,!1}),r?n:e},a.prototype.first=function(t){if(null!=t)return this.where(t).first();var e,n=!1;if(this.forEach(function(t){return e=t,n=!0,!1}),!n)throw new Error("first:No element satisfies the condition.");return e},a.prototype.firstOrDefault=function(t,e){if(void 0===e&&(e=null),null!=t)return this.where(t).firstOrDefault(null,e);var n,r=!1;return this.forEach(function(t){return n=t,r=!0,!1}),r?n:e},a.prototype.last=function(t){if(null!=t)return this.where(t).last();var e,n=!1;if(this.forEach(function(t){n=!0,e=t}),!n)throw new Error("last:No element satisfies the condition.");return e},a.prototype.lastOrDefault=function(t,e){if(void 0===e&&(e=null),null!=t)return this.where(t).lastOrDefault(null,e);var n,r=!1;return this.forEach(function(t){r=!0,n=t}),r?n:e},a.prototype.single=function(t){if(null!=t)return this.where(t).single();var e,n=!1;if(this.forEach(function(t){if(n)throw new Error("single:sequence contains more than one element.");n=!0,e=t}),!n)throw new Error("single:No element satisfies the condition.");return e},a.prototype.singleOrDefault=function(t,e){if(void 0===e&&(e=null),null!=t)return this.where(t).singleOrDefault(null,e);var n,r=!1;return this.forEach(function(t){if(r)throw new Error("single:sequence contains more than one element.");r=!0,n=t}),r?n:e},a.prototype.skip=function(t){var e=this;return new a(function(){var n,r=0;return new i(function(){for(n=e.getEnumerator();r++<t&&n.moveNext(););},function(){return!!n.moveNext()&&this.yieldReturn(n.current())},function(){o.dispose(n)})})},a.prototype.skipWhile=function(t){t=o.createLambda(t);var e=this;return new a(function(){var n,r=0,u=!1;return new i(function(){n=e.getEnumerator()},function(){for(;!u;){if(!n.moveNext())return!1;if(!t(n.current(),r++))return u=!0,this.yieldReturn(n.current())}return!!n.moveNext()&&this.yieldReturn(n.current())},function(){o.dispose(n)})})},a.prototype.take=function(t){var e=this;return new a(function(){var n,r=0;return new i(function(){n=e.getEnumerator()},function(){return!!(r++<t&&n.moveNext())&&this.yieldReturn(n.current())},function(){o.dispose(n)})})},a.prototype.takeWhile=function(t){t=o.createLambda(t);var e=this;return new a(function(){var n,r=0;return new i(function(){n=e.getEnumerator()},function(){return!(!n.moveNext()||!t(n.current(),r++))&&this.yieldReturn(n.current())},function(){o.dispose(n)})})},a.prototype.takeExceptLast=function(t){null==t&&(t=1);var e=this;return new a(function(){if(t<=0)return e.getEnumerator();var n,r=[];return new i(function(){n=e.getEnumerator()},function(){for(;n.moveNext();){if(r.length==t)return r.push(n.current()),this.yieldReturn(r.shift());r.push(n.current())}return!1},function(){o.dispose(n)})})},a.prototype.takeFromLast=function(t){if(t<=0||null==t)return a.empty();var e=this;return new a(function(){var n,r,u=[];return new i(function(){n=e.getEnumerator()},function(){for(;n.moveNext();)u.length==t&&u.shift(),u.push(n.current());return null==r&&(r=a.from(u).getEnumerator()),!!r.moveNext()&&this.yieldReturn(r.current())},function(){o.dispose(r)})})},a.prototype.indexOf=function(t){var e=null;return(void 0===t?"undefined":_typeof(t))===r.Function?this.forEach(function(n,r){if(t(n,r))return e=r,!1}):this.forEach(function(n,r){if(n===t)return e=r,!1}),null!==e?e:-1},a.prototype.lastIndexOf=function(t){var e=-1;return(void 0===t?"undefined":_typeof(t))===r.Function?this.forEach(function(n,r){t(n,r)&&(e=r)}):this.forEach(function(n,r){n===t&&(e=r)}),e},a.prototype.asEnumerable=function(){return a.from(this)},a.prototype.toArray=function(){var t=[];return this.forEach(function(e){t.push(e)}),t},a.prototype.toLookup=function(t,e,n){t=o.createLambda(t),e=o.createLambda(e),n=o.createLambda(n);var r=new y(n);return this.forEach(function(n){var o=t(n),u=e(n),i=r.get(o);void 0!==i?i.push(u):r.add(o,[u])}),new v(r)},a.prototype.toObject=function(t,e){t=o.createLambda(t),e=o.createLambda(e);var n={};return this.forEach(function(r){n[t(r)]=e(r)}),n},a.prototype.toDictionary=function(t,e,n){t=o.createLambda(t),e=o.createLambda(e),n=o.createLambda(n);var r=new y(n);return this.forEach(function(n){r.add(t(n),e(n))}),r},a.prototype.toJSONString=function(t,e){if(("undefined"==typeof JSON?"undefined":_typeof(JSON))===r.Undefined||null==JSON.stringify)throw new Error("toJSONString can't find JSON.stringify. This works native JSON support Browser or include json2.js");return JSON.stringify(this.toArray(),t,e)},a.prototype.toJoinedString=function(t,e){return null==t&&(t=""),null==e&&(e=n.Identity),this.select(e).toArray().join(t)},a.prototype.doAction=function(t){var e=this;return t=o.createLambda(t),new a(function(){var n,r=0;return new i(function(){n=e.getEnumerator()},function(){return!!n.moveNext()&&(t(n.current(),r++),this.yieldReturn(n.current()))},function(){o.dispose(n)})})},a.prototype.forEach=function(t){t=o.createLambda(t);var e=0,n=this.getEnumerator();try{for(;n.moveNext()&&!1!==t(n.current(),e++););}finally{o.dispose(n)}},a.prototype.write=function(t,e){null==t&&(t=""),e=o.createLambda(e);var n=!0;this.forEach(function(r){n?n=!1:document.write(t),document.write(e(r))})},a.prototype.writeLine=function(t){t=o.createLambda(t),this.forEach(function(e){document.writeln(t(e)+"<br />")})},a.prototype.force=function(){var t=this.getEnumerator();try{for(;t.moveNext(););}finally{o.dispose(t)}},a.prototype.letBind=function(t){t=o.createLambda(t);var e=this;return new a(function(){var n;return new i(function(){n=a.from(t(e)).getEnumerator()},function(){return!!n.moveNext()&&this.yieldReturn(n.current())},function(){o.dispose(n)})})},a.prototype.share=function(){var t,e=this,r=!1;return new l(function(){return new i(function(){null==t&&(t=e.getEnumerator())},function(){if(r)throw new Error("enumerator is disposed");return!!t.moveNext()&&this.yieldReturn(t.current())},n.Blank)},function(){r=!0,o.dispose(t)})},a.prototype.memoize=function(){var t,e,r=this,u=!1;return new l(function(){var o=-1;return new i(function(){null==e&&(e=r.getEnumerator(),t=[])},function(){if(u)throw new Error("enumerator is disposed");return o++,t.length<=o?!!e.moveNext()&&this.yieldReturn(t[o]=e.current()):this.yieldReturn(t[o])},n.Blank)},function(){u=!0,o.dispose(e),t=null})},a.prototype.catchError=function(t){t=o.createLambda(t);var e=this;return new a(function(){var n;return new i(function(){n=e.getEnumerator()},function(){try{return!!n.moveNext()&&this.yieldReturn(n.current())}catch(e){return t(e),!1}},function(){o.dispose(n)})})},a.prototype.finallyAction=function(t){t=o.createLambda(t);var e=this;return new a(function(){var n;return new i(function(){n=e.getEnumerator()},function(){return!!n.moveNext()&&this.yieldReturn(n.current())},function(){try{o.dispose(n)}finally{t()}})})},a.prototype.log=function(t){return t=o.createLambda(t),this.doAction(function(e){("undefined"==typeof console?"undefined":_typeof(console))!==r.Undefined&&console.log(t(e))})},a.prototype.trace=function(t,e){return null==t&&(t="Trace"),e=o.createLambda(e),this.doAction(function(n){("undefined"==typeof console?"undefined":_typeof(console))!==r.Undefined&&console.log(t,e(n))})};var f=function(t,e,n,r){this.source=t,this.keySelector=o.createLambda(e),this.descending=n,this.parent=r};f.prototype=new a,f.prototype.createOrderedEnumerable=function(t,e){return new f(this.source,t,e,this)},f.prototype.thenBy=function(t){return this.createOrderedEnumerable(t,!1)},f.prototype.thenByDescending=function(t){return this.createOrderedEnumerable(t,!0)},f.prototype.getEnumerator=function(){var t,e,r=this,o=0;return new i(function(){t=[],e=[],r.source.forEach(function(n,r){t.push(n),e.push(r)});var n=s.create(r,null);n.GenerateKeys(t),e.sort(function(t,e){return n.compare(t,e)})},function(){return o<e.length&&this.yieldReturn(t[e[o++]])},n.Blank)};var s=function(t,e,n){this.keySelector=t,this.descending=e,this.child=n,this.keys=null};s.create=function(t,e){var n=new s(t.keySelector,t.descending,e);return null!=t.parent?s.create(t.parent,n):n},s.prototype.GenerateKeys=function(t){for(var e=t.length,n=this.keySelector,r=new Array(e),o=0;o<e;o++)r[o]=n(t[o]);this.keys=r,null!=this.child&&this.child.GenerateKeys(t)},s.prototype.compare=function(t,e){var n=o.compare(this.keys[t],this.keys[e]);return 0==n?null!=this.child?this.child.compare(t,e):o.compare(t,e):this.descending?-n:n};var l=function(t,e){this.dispose=e,a.call(this,t)};l.prototype=new a;var p=function(t){this.getSource=function(){return t}};p.prototype=new a,p.prototype.any=function(t){return null==t?this.getSource().length>0:a.prototype.any.apply(this,arguments)},p.prototype.count=function(t){return null==t?this.getSource().length:a.prototype.count.apply(this,arguments)},p.prototype.elementAt=function(t){var e=this.getSource();return 0<=t&&t<e.length?e[t]:a.prototype.elementAt.apply(this,arguments)},p.prototype.elementAtOrDefault=function(t,e){void 0===e&&(e=null);var n=this.getSource();return 0<=t&&t<n.length?n[t]:e},p.prototype.first=function(t){var e=this.getSource();return null==t&&e.length>0?e[0]:a.prototype.first.apply(this,arguments)},p.prototype.firstOrDefault=function(t,e){if(void 0===e&&(e=null),null!=t)return a.prototype.firstOrDefault.apply(this,arguments);var n=this.getSource();return n.length>0?n[0]:e},p.prototype.last=function(t){var e=this.getSource();return null==t&&e.length>0?e[e.length-1]:a.prototype.last.apply(this,arguments)},p.prototype.lastOrDefault=function(t,e){if(void 0===e&&(e=null),null!=t)return a.prototype.lastOrDefault.apply(this,arguments);var n=this.getSource();return n.length>0?n[n.length-1]:e},p.prototype.skip=function(t){var e=this.getSource();return new a(function(){var r;return new i(function(){r=t<0?0:t},function(){return r<e.length&&this.yieldReturn(e[r++])},n.Blank)})},p.prototype.takeExceptLast=function(t){return null==t&&(t=1),this.take(this.getSource().length-t)},p.prototype.takeFromLast=function(t){return this.skip(this.getSource().length-t)},p.prototype.reverse=function(){var t=this.getSource();return new a(function(){var e;return new i(function(){e=t.length},function(){return e>0&&this.yieldReturn(t[--e])},n.Blank)})},p.prototype.sequenceEqual=function(t,e){return(!(t instanceof p||t instanceof Array)||null!=e||a.from(t).count()==this.count())&&a.prototype.sequenceEqual.apply(this,arguments)},p.prototype.toJoinedString=function(t,e){var n=this.getSource();return null==e&&n instanceof Array?(null==t&&(t=""),n.join(t)):a.prototype.toJoinedString.apply(this,arguments)},p.prototype.getEnumerator=function(){var t=this.getSource(),e=-1;return{current:function(){return t[e]},moveNext:function(){return++e<t.length},dispose:n.Blank}};var h=function(t,e){this.prevSource=t,this.prevPredicate=e};h.prototype=new a,h.prototype.where=function(t){if(t=o.createLambda(t),t.length<=1){var e=this.prevPredicate,n=function(n){return e(n)&&t(n)};return new h(this.prevSource,n)}return a.prototype.where.call(this,t)},h.prototype.select=function(t){return t=o.createLambda(t),t.length<=1?new d(this.prevSource,this.prevPredicate,t):a.prototype.select.call(this,t)},h.prototype.getEnumerator=function(){var t,e=this.prevPredicate,n=this.prevSource;return new i(function(){t=n.getEnumerator()},function(){for(;t.moveNext();)if(e(t.current()))return this.yieldReturn(t.current());return!1},function(){o.dispose(t)})};var d=function(t,e,n){this.prevSource=t,this.prevPredicate=e,this.prevSelector=n};d.prototype=new a,d.prototype.where=function(t){return t=o.createLambda(t),t.length<=1?new h(this,t):a.prototype.where.call(this,t)},d.prototype.select=function(t){if(t=o.createLambda(t),t.length<=1){var e=this.prevSelector,n=function(n){return t(e(n))};return new d(this.prevSource,this.prevPredicate,n)}return a.prototype.select.call(this,t)},d.prototype.getEnumerator=function(){var t,e=this.prevPredicate,n=this.prevSelector,r=this.prevSource;return new i(function(){
t=r.getEnumerator()},function(){for(;t.moveNext();)if(null==e||e(t.current()))return this.yieldReturn(n(t.current()));return!1},function(){o.dispose(t)})};var y=function(){var t=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e=function(t){return null===t?"null":void 0===t?"undefined":_typeof(t.toString)===r.Function?t.toString():Object.prototype.toString.call(t)},o=function(t,e){this.key=t,this.value=e,this.prev=null,this.next=null},u=function(){this.first=null,this.last=null};u.prototype={addLast:function(t){null!=this.last?(this.last.next=t,t.prev=this.last,this.last=t):this.first=this.last=t},replace:function(t,e){null!=t.prev?(t.prev.next=e,e.prev=t.prev):this.first=e,null!=t.next?(t.next.prev=e,e.next=t.next):this.last=e},remove:function(t){null!=t.prev?t.prev.next=t.next:this.first=t.next,null!=t.next?t.next.prev=t.prev:this.last=t.prev}};var c=function(t){this.countField=0,this.entryList=new u,this.buckets={},this.compareSelector=null==t?n.Identity:t};return c.prototype={add:function(n,r){var u=this.compareSelector(n),i=e(u),c=new o(n,r);if(t(this.buckets,i)){for(var a=this.buckets[i],f=0;f<a.length;f++)if(this.compareSelector(a[f].key)===u)return this.entryList.replace(a[f],c),void(a[f]=c);a.push(c)}else this.buckets[i]=[c];this.countField++,this.entryList.addLast(c)},get:function(n){var r=this.compareSelector(n),o=e(r);if(t(this.buckets,o))for(var u=this.buckets[o],i=0;i<u.length;i++){var c=u[i];if(this.compareSelector(c.key)===r)return c.value}},set:function(n,r){var u=this.compareSelector(n),i=e(u);if(t(this.buckets,i))for(var c=this.buckets[i],a=0;a<c.length;a++)if(this.compareSelector(c[a].key)===u){var f=new o(n,r);return this.entryList.replace(c[a],f),c[a]=f,!0}return!1},contains:function(n){var r=this.compareSelector(n),o=e(r);if(!t(this.buckets,o))return!1;for(var u=this.buckets[o],i=0;i<u.length;i++)if(this.compareSelector(u[i].key)===r)return!0;return!1},clear:function(){this.countField=0,this.buckets={},this.entryList=new u},remove:function(n){var r=this.compareSelector(n),o=e(r);if(t(this.buckets,o))for(var u=this.buckets[o],i=0;i<u.length;i++)if(this.compareSelector(u[i].key)===r)return this.entryList.remove(u[i]),u.splice(i,1),0==u.length&&delete this.buckets[o],void this.countField--},count:function(){return this.countField},toEnumerable:function(){var t=this;return new a(function(){var e;return new i(function(){e=t.entryList.first},function(){if(null!=e){var t={key:e.key,value:e.value};return e=e.next,this.yieldReturn(t)}return!1},n.Blank)})}},c}(),v=function(t){this.count=function(){return t.count()},this.get=function(e){return a.from(t.get(e))},this.contains=function(e){return t.contains(e)},this.toEnumerable=function(){return t.toEnumerable().select(function(t){return new m(t.key,t.value)})}},m=function(t,e){this.key=function(){return t},p.call(this,e)};m.prototype=new p,("undefined"==typeof define?"undefined":_typeof(define))===r.Function&&define.amd?define("linq",[],function(){return a}):("undefined"==typeof module?"undefined":_typeof(module))!==r.Undefined&&module.exports?module.exports=a:t.Enumerable=a}(this);