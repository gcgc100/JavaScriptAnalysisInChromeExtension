!function(e){function t(n){if(A[n])return A[n].exports;var l=A[n]={exports:{},id:n,loaded:!1};return e[n].call(l.exports,l,l.exports,t),l.loaded=!0,l.exports}var A={};return t.m=e,t.c=A,t.p="",t(0)}([function(e,t,A){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var l=A(1),o=n(l);window.texthelp=window.texthelp||{},window.texthelp.RW4GC=window.texthelp.RW4GC||{},window.texthelp.RW4GC.enums=window.texthelp.RW4GC.enums||{},window.texthelp.RW4GC.enums.AccessType=Object.freeze({IDENTITY:1,HIGHLIGHTS:2,VOCAB:3,VOICENOTES:4}),window.texthelp.RW4GC.enums.AccountType=Object.freeze({GOOGLE:"Google",MICROSOFTSHAREPOINT:"MicrosoftSharepoint"}),window.texthelp.RW4GC.IdentityManager=o.default,window.texthelp.RW4GC.promiseTimeout=function(e,t){return new Promise(function(A,n){var l=setTimeout(function(){n(new Error("promise timeout"))},e);t.then(function(e){clearTimeout(l),A(e)}).catch(function(e){clearTimeout(l),n(e)})})}},function(e,t,A){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var A=0;A<t.length;A++){var n=t[A];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,A,n){return A&&e(t.prototype,A),n&&e(t,n),t}}(),r=A(2),i=(n(r),A(7)),m=n(i),a=function(){function e(t){l(this,e),this._id="",this._license=null,this._productCode="",void 0===t&&(t=texthelp.RW4GC.enums.AccountType.GOOGLE),this._authenticator=new m.default(t).authenticator,this.getLicense(!1)}return o(e,[{key:"_getDailyInMemoryLicense",value:function(){var e=new Date,t=1e4*e.getFullYear()+100*e.getMonth()+e.getDate();return null==this._license?(this._id="",this._license=null,null):void 0==this._license.stamp?(this._id="",this._license=null,null):t!==this._license.stamp?(this._id="",this._license=null,null):null!==this._license&&void 0===this._license.error?this._license:null}},{key:"_getDailyChromeSyncLicense",value:function(e){var t=this;if(void 0!=e&&null!=e){var A=new Date,n=1e4*A.getFullYear()+100*A.getMonth()+A.getDate();chrome.storage.sync.get({thpl2:{daysleft:-1,noLicense:!0}},function(A){return void 0==A.thpl2.stamp?(e(null,n),t._id="",void(t._license=null)):n!==A.thpl2.stamp?(t._id="",t._license=null,void e(null,n)):void e(A.thpl2,n)})}}},{key:"getLicenseNoCache",value:function(e,t,A){var n=this;void 0==t&&(t=null),this._authenticator._getID(e,function(e){return null==e?void(null!==t&&t({error:"No id to license"})):0==e.length?void(null!==t&&t({error:"No id to license"})):void n._authenticator._getLicense(e,function(e){return void 0!==e.lt?(n._getDailyChromeSyncLicense(function(A,n){if(null===A);else{A.lt=e.lt,null!==t&&t(A);var l=moment(n)-moment(A.stamp);if(l>5){var o=A.Email,r=[];r.push("temp license extended use"),r.push(o),r.push(o.split("@")[1]),window.thFunctions.onSendEvent(r)}}}),void(null!==t&&t(e))):(void 0==e.lt&&(n._license=e,chrome.storage.sync.set({thpl2:e})),void(null!==t&&t(e)))},A)})}},{key:"getLicense",value:function(e,t,A){void 0==t&&(t=null),chrome.storage.managed.get("features",function(n){var l=this;void 0==n.features&&(n.features={});var o=this._getDailyInMemoryLicense();return null!==t&&null!==o?(o.pfs=n.features,void t(o)):void this._getDailyChromeSyncLicense(function(o,r){return null!==o?(l._license=o,void(null!==t&&(o.pfs=n.features,t(o)))):void l._authenticator._getID(e,function(e){return null==e?void(null!==t&&t({error:"No id to license"})):0==e.length?void(null!==t&&t({error:"No id to license"})):void l._authenticator._getLicense(e,function(e){if(null===l._license||void 0===e.lt)void 0==e.lt&&(l._license=e,chrome.storage.sync.set({thpl2:e})),null!==t&&(e.pfs=n.features,t(e));else if(l._license.lt=licence.lt,null!==t){var A=l._license;A.pfs=n.features,t(A)}},A)})})}.bind(this))}},{key:"getId",value:function(e,t){this._authenticator._getID(e,t)}},{key:"collectHighlights",value:function(e,t){this._authenticator._collectHighlights(e,t)}},{key:"vocab",value:function(e,t){this._authenticator._vocab(e,t)}},{key:"getVoiceNoteOAuthToken",value:function(e,t){this._authenticator._getVoiceNoteOAuthToken(e,t)}},{key:"setproductCode",value:function(e,t){this._productCode=e,this.getLicenseNoCache(!0,t,e)}},{key:"onBarShown",value:function(){this._authenticator._onBarShown()}},{key:"id",get:function(){return this._authenticator._id}}]),e}();t.default=a},function(e,t,A){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var A=0;A<t.length;A++){var n=t[A];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,A,n){return A&&e(t.prototype,A),n&&e(t,n),t}}(),m=A(3),a=n(m),s=function(e){function t(){l(this,t);var e=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.scopes={},e.scopes[texthelp.RW4GC.enums.AccessType.IDENTITY]=["https://www.googleapis.com/auth/userinfo.email"],e.scopes[texthelp.RW4GC.enums.AccessType.HIGHLIGHTS]=["https://www.googleapis.com/auth/drive.apps.readonly","https://www.googleapis.com/auth/drive","https://www.googleapis.com/auth/drive.appdata"],e.scopes[texthelp.RW4GC.enums.AccessType.VOCAB]=["https://www.googleapis.com/auth/drive.apps.readonly","https://www.googleapis.com/auth/drive","https://www.googleapis.com/auth/drive.appdata"],e.scopes[texthelp.RW4GC.enums.AccessType.VOICENOTES]=["https://www.googleapis.com/auth/drive.apps.readonly","https://www.googleapis.com/auth/drive","https://www.googleapis.com/auth/drive.appdata"],e.scopes[texthelp.RW4GC.enums.AccessType.DRIVEINSTALL]=["https://www.googleapis.com/auth/drive.file","https://www.googleapis.com/auth/drive.install"],e._interactive=!1,e}return r(t,e),i(t,[{key:"authenticate",value:function(e,t,A,n,l,o){this._interactive=e,void 0===o&&(o=!0),chrome.identity.getAuthToken({interactive:e,scopes:t},function(r){return void 0!==chrome.runtime.lastError,r=this.getDefaultValue(r,""),e&&0===r.length?(o=!1,this.onFuncResponse(null)):void A.bind(this)(r,e,t,A,n,l,o)}.bind(this))}},{key:"_handleErrors",value:function(e,t,A,n,l,o,r,i){return e.ok?(this._token=i,e.json()):401==e.status&&t?(t=!1,this._revokeCachedToken(i,A,n,l,o,r),null):(e.token=i,e.email="",e)}},{key:"_getID",value:function(e,t){var A=this;this.getLocalID(function(n){return n.length>0?(t(n),void(!A._authenticated&&e&&(A.authenticate(e,A.driveInstallScopes,function(){},{},{},!0),A._authenticated=!0))):void A.authenticate(e,A.idScopes.concat(A.driveInstallScopes),A.getAuthenticatedID,function(e){t(e)})})}},{key:"_onBarShown",value:function(){texthelp.RW4GC.IdentityManagerInstance.getId(!0,function(e){})}},{key:"id",get:function(){return this._id}},{key:"licenseType",get:function(){return"Google"}}]),t}(a.default);t.default=s},function(e,t,A){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var A=0;A<t.length;A++){var n=t[A];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,A,n){return A&&e(t.prototype,A),n&&e(t,n),t}}(),m=A(4),a=n(m),s=A(6),c=n(s),u=function(e){function t(){l(this,t);var e=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e._id="",e._name="",e.driveFolder=new c.default,e}return r(t,e),i(t,[{key:"getLocalID",value:function(e){var t=this;chrome.identity.getProfileUserInfo(function(A){return t._id.length>0?void e(t._id):A.email.length>0?(t._id=A.email,void e(A.email)):void e("")})}},{key:"getStoredLicense",value:function(e){e(null)}},{key:"getAuthenticatedID",value:function(e,t,A,n,l,o,r){var i=this,m="https://www.googleapis.com/oauth2/v2/userinfo?access_token="+e;try{fetch(m,{method:"get"}).then(function(m){return i._handleErrors(m,r,t,A,n,l,o,e)}).then(function(e){null!==e&&(i._id=e.email,l(i._id))})}catch(e){}}},{key:"writeCollectHighlightsDoc",value:function(e,t,A,n,l,o,r){var i=this,m=o,a="<!DOCTYPE html><html><head><style>";a+="p{padding-bottom:10px}.blue{background-color:#0ff}.pink{background-color:#f0f}.green{background-color:#adff2f}.yellow{background-color:#ff0}.boldText{font-weight:700}",a+="</style></head><body>";var s=0;for(s=0;s<m.highlights.length;s++)"#FFFF00"==m.highlights[s].color&&(a+='<p><span class="yellow">'),"#ADFF2F"==m.highlights[s].color&&(a+='<p><span class="green">'),"#00FFFF"==m.highlights[s].color&&(a+='<p><span class="blue">'),"#FF00FF"==m.highlights[s].color&&(a+='<p><span class="pink">'),a+=m.highlights[s].text+"</span></p>";a+='<br><p><span class="boldText"><a href="'+m.url,a+='">'+m.title+"</a></span></p>",a+='<p><span class="user">'+this._name+"<br>"+this._id+"</span></p>",a+="</body></html>";var c='--rw4g\nContent-Type: application/json; charset=UTF-8\n\n{"title": "'+m.docTitle+'", "description": "Read&Write for Google Chrome™"}\n--rw4g\nContent-Type: text/html\n\n'+a+"\n--rw4g--\n",u="https://www.googleapis.com/upload/drive/v2/files?uploadType=multipart&convert=true";fetch(u,{headers:{"Content-Type":'multipart/related; boundary="rw4g"',Authorization:"Bearer "+e},method:"POST",body:c}).then(function(m){return i._handleErrors(m,r,t,A,n,l,o,e)}).then(function(e){l(e.alternateLink)}).catch(function(e){console.log(e)})}},{key:"writeVocabResponse",value:function(e,t,A,n,l,o,r){var i=this,m=o.vocab.words,a=o.translations,s="<!DOCTYPE html><html><head><style>";s+='p {padding-top: 10px;}\r\nh1,th {font-family: "Open Sans", sans-serif; font-size: 1em;}\r\ntable {width: 100%;}\r\n.oddrow {background-color: #99ccff;}\r\n.evenrow {background-color: #ffffff;}\r\nh1 {text-align:center;}\r\n.VocabWord {font-family: "Open Sans", sans-serif; width:17%;}\r\n.VocabMeaning {font-family: "Open Sans", sans-serif; width:35%;}\r\n.VocabSymbol {font-family: "Open Sans", sans-serif; width:16%;}\r\n.VocabNotes {font-family: "Open Sans", sans-serif; width:32%;}\r\nth,td {font-family: "Open Sans", sans-serif; padding:5px;}\r\n.wordContainer,.BoldText {font-weight:bold; font-family: "Open Sans", sans-serif;}',s+="</style></head><body>",s+='<h1 class="vocabTitle">'+a.title+'</h1><table id="vocabTable">',s+="<tr>",s+='  <th class="VocabWord">'+a.heading+"</th>",s+='  <th class="VocabMeaning">'+a.meaning+"</th>",s+='  <th class="VocabSymbol">'+a.symbol+"</th>",s+='  <th class="VocabNotes">'+a.notes+"</th>",s+="</tr>";for(var c=0;c<m.length;c++){s+='<tr class="'+oddOrEven(c+1)+'row">',s+='   <td class="wordContainer">'+m[c].word+"</td>",s+='   <td class="meaningContainer">';for(var u=0;u<m[c].inflections.length;u++)for(var p=0;p<m[c].inflections[u].definitions.length;p++)s+=m[c].inflections[u].definitions[p].definition+"<br><br>";s+="   </td>",s+='   <td class="picContainer">';for(var u=0;u<m[c].inflections.length;u++)for(var p=0;p<m[c].inflections[u].symbols.length;p++)s+='<img src="'+m[c].inflections[u].symbols[p]+'" /><br />';s+="   </td>",s+='   <td class="notesContainer">&nbsp;</td>',s+="</tr>"}s+="</body></html>";var X='--rw4g\nContent-Type: application/json; charset=UTF-8\n\n{"title": "'+a.docTitle+'", "description": "Read&Write for Google Chrome™"}\n--rw4g\nContent-Type: text/html\n\n'+s+"\n--rw4g--\n",h="https://www.googleapis.com/upload/drive/v2/files?uploadType=multipart&convert=true";fetch(h,{headers:{"Content-Type":'multipart/related; boundary="rw4g"',Authorization:"Bearer "+e},method:"POST",body:X}).then(function(m){return i._handleErrors(m,r,t,A,n,l,o,e)}).then(function(e){l(e.alternateLink)}).catch(function(e){console.log(e)})}},{key:"writeVocabHTMLResponse",value:function(e,t,A,n,l,o,r){var i=o.vocab.words,m=o.translations,a="<!DOCTYPE html><html><head><style>";a+='p {padding-top: 10px;}\r\nh1,th {font-family: "Open Sans", sans-serif; font-size: 1em;}\r\ntable {width: 100%;}\r\n.oddrow {background-color: #99ccff;}\r\n.evenrow {background-color: #ffffff;}\r\nh1 {text-align:center;}\r\n.VocabWord {font-family: "Open Sans", sans-serif; width:17%;}\r\n.VocabMeaning {font-family: "Open Sans", sans-serif; width:35%;}\r\n.VocabSymbol {font-family: "Open Sans", sans-serif; width:16%;}\r\n.VocabNotes {font-family: "Open Sans", sans-serif; width:32%;}\r\nth,td {font-family: "Open Sans", sans-serif; padding:5px;}\r\n.wordContainer,.BoldText {font-weight:bold; font-family: "Open Sans", sans-serif;}',a+="</style></head><body>",a+='<h1 class="vocabTitle">'+m.title+'</h1><table id="vocabTable">',a+="<tr>",a+='  <th class="VocabWord">'+m.heading+"</th>",a+='  <th class="VocabMeaning">'+m.meaning+"</th>",a+='  <th class="VocabSymbol">'+m.symbol+"</th>",a+='  <th class="VocabNotes">'+m.notes+"</th>",a+="</tr>";for(var s=0;s<i.length;s++){a+='<tr class="'+oddOrEven(s+1)+'row">',a+='   <td class="wordContainer">'+i[s].word+"</td>",a+='   <td class="meaningContainer">',a+=i[s].definition,a+="   </td>",a+='   <td class="picContainer">';for(var c=0;c<i[s].symbols.length;c++)a+='<img src="'+i[s].symbols[c]+'" /><br />';a+="   </td>",a+='   <td class="notesContainer">&nbsp;</td>',a+="</tr>"}a+="</body></html>";var u='--rw4g\nContent-Type: application/json; charset=UTF-8\n\n{"title": "'+m.docTitle+'", "description": "Read&Write for Google Chrome™"}\n--rw4g\nContent-Type: text/html\n\n'+a+"\n--rw4g--\n",p="https://www.googleapis.com/upload/drive/v2/files?uploadType=multipart&convert=true";fetch(p,{headers:{"Content-Type":'multipart/related; boundary="rw4g"',Authorization:"Bearer "+e},method:"POST",body:u}).then(function(e){return e.json()}).then(function(e){l(e.alternateLink)}).catch(function(e){console.log(e)})}},{key:"getVoiceNoteToken",value:function(e,t,A,n,l,o,r){var i=this,m="https://www.googleapis.com/drive/v2/files";try{fetch(m,{method:"get",headers:{Authorization:"Bearer "+e}}).then(function(m){return i._handleErrors(m,r,t,A,n,l,o,e)}).then(function(e){l(i._token)})}catch(e){}}},{key:"idScopes",get:function(){return this.scopes[texthelp.RW4GC.enums.AccessType.IDENTITY]}},{key:"collectHighlightsScopes",get:function(){return this.scopes[texthelp.RW4GC.enums.AccessType.HIGHLIGHTS]}},{key:"vocabScopes",get:function(){return this.scopes[texthelp.RW4GC.enums.AccessType.VOCAB]}},{key:"voiceNoteScopes",get:function(){return this.scopes[texthelp.RW4GC.enums.AccessType.VOICENOTES]}},{key:"driveInstallScopes",get:function(){return this.scopes[texthelp.RW4GC.enums.AccessType.DRIVEINSTALL]}}]),t}(a.default);t.default=u},function(e,t,A){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var A=0;A<t.length;A++){var n=t[A];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,A,n){return A&&e(t.prototype,A),n&&e(t,n),t}}(),m=A(5),a=n(m),s=function(e){function t(){l(this,t);var e=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.details={},e.details.license=null,e.details.id=null,e}return r(t,e),i(t,[{key:"_doTexthelpLicenseCheck",value:function(e,t,A){var n={user:e,loginType:"google",product:"rw4gc"};this.licenseType==texthelp.RW4GC.enums.AccountType.MICROSOFTSHAREPOINT&&(n.loginType="microsoft"),void 0!==A&&(n.authCode=A),thAuth.licenseCheck(n,function(e,t){})}},{key:"_getLicense",value:function(e,t,A){var n=this;try{if(void 0==t&&(t=null),void 0==e)return void t({error:"No id to license"});if(null==e)return void t({error:"No id to license"});if(0==e.length)return void t({error:"No id to license"});void 0==t&&(t=null),this.onLicenseResponse=t;var l={user:e,loginType:"google",product:"rw4gc"};this.licenseType==texthelp.RW4GC.enums.AccountType.MICROSOFTSHAREPOINT&&(l.loginType="microsoft"),void 0!==A&&(l.authCode=A);try{thAuth.licenseCheck(l,function(t,A){A.lType=n.licenseType,A.interactive=n._interactive,A.Email=e;var l=new Date;A.stamp=1e4*l.getFullYear()+100*l.getMonth()+l.getDate(),n.details.license=A,n.details.id=e,n.onLicenseResponse(A)})}catch(e){}}catch(e){}}},{key:"_copyOldLicenseToNew",value:function(e,t){var A=t;A.daysleft=e.DaysLeft,A.expiry=e.Expiry.split("T")[0];for(var n=e.Features,l=0;l<n.length;l++)"Dictionary"==n[l].FeatureName?A.features.Dictionary=n[l].Enabled:"PictureDictionary"==n[l].FeatureName?A.features["Picture Dictionary"]=n[l].Enabled:"Speech"==n[l].FeatureName?(A.features.Play=n[l].Enabled,A.features["Hover Speech"]=n[l].Enabled,A.features.Pause=n[l].Enabled,A.features.Stop=n[l].Enabled):"FactFinder"==n[l].FeatureName?A.features["Web Search"]=n[l].Enabled:"Translator"==n[l].FeatureName?A.features.Translator=n[l].Enabled:"StudySkills"==n[l].FeatureName?A.features.Highlights=n[l].Enabled:"Vocab"==n[l].FeatureName?A.features["Vocabulary List"]=n[l].Enabled:"Simplify"==n[l].FeatureName?A.features["Simplify Page"]=n[l].Enabled:"Prediction"==n[l].FeatureName?A.features.Prediction=n[l].Enabled:"Prediction-PredictAhead"==n[l].FeatureName?A.features["Predict Ahead"]=n[l].Enabled:"SSR"==n[l].FeatureName?A.features["Screenshot Reader"]=n[l].Enabled:"SpeechInput"==n[l].FeatureName?A.features["Talk&Type"]=n[l].Enabled:"VoiceNotes"==n[l].FeatureName?A.features["Voice Note"]=n[l].Enabled:"SpeechMaker"==n[l].FeatureName?A.features["Audio Maker"]=n[l].Enabled:"ScreenMasking"==n[l].FeatureName?A.features["Screen Masking"]=n[l].Enabled:"PracticeReadingAloud"==n[l].FeatureName&&(A.features["Practice Reading Aloud"]=n[l].Enabled);return A}},{key:"writeVocabDocument",value:function(e,t,A,n,l,o,r){var i=this,m="https://rwgoogle-webservices-6.texthelp.com/v1.11.0/vocab?json=";"fr"!=o.locale&&"pt"!=o.locale&&"es"!=o.locale&&"nl"!=o.locale||(m="https://rwgoogle-webservices-6.texthelp.com/v1.11.0/vocabHTML?json=");for(var a='{"t":"5","i":"f","g":"t","u":"'+o.user+'","e":"n4T7Y2AjS4","b":[',s=0;s<o.words.length;s++)a+='"'+o.words[s].trim()+'"',s<o.words.length-1&&(a+=", ");a+='],"l":"'+o.locale+'"}',m+=encodeURIComponent(a),fetch(m,{method:"POST"}).then(function(m){return i._handleErrors(m,r,t,A,n,l,o,e)}).then(function(m){return o.vocab=m,void 0!==m.service?void i.writeVocabHTMLResponse(e,t,A,n,l,o,r):void i.writeVocabResponse(e,t,A,n,l,o,r)}).catch(function(e){console.log(e)})}}]),t}(a.default);t.default=s},function(e,t){"use strict";function A(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var A=0;A<t.length;A++){var n=t[A];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,A,n){return A&&e(t.prototype,A),n&&e(t,n),t}}(),l=function(){function e(){A(this,e),this._authenticated=!1}return n(e,[{key:"getDefaultValue",value:function(e,t){return void 0===e?t:null===e?t:0===e.length?t:e}},{key:"_getID",value:function(e,t){this.authenticate(e,this.idScopes,this.getAuthenticatedID,function(e){t(e)})}},{key:"_collectHighlights",value:function(e,t){this.authenticate(!0,this.collectHighlightsScopes,this.writeCollectHighlightsDoc,function(e){t(e)},e)}},{key:"_vocab",value:function(e,t){this.authenticate(!0,this.vocabScopes,this.writeVocabDocument,function(e){t(e)},e)}},{key:"_getVoiceNoteOAuthToken",value:function(e,t){this.authenticate(!0,this.voiceNoteScopes,this.getVoiceNoteToken,function(e){t(e)},{})}},{key:"_revokeCachedToken",value:function(e,t,A,n,l,o){var r=this;chrome.identity.removeCachedAuthToken({token:e},function(){r.authenticate(t,A,n,l,o,!1)})}},{key:"_onBarShown",value:function(){}}]),e}();t.default=l},function(e,t){"use strict";function A(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var A=0;A<t.length;A++){var n=t[A];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,A,n){return A&&e(t.prototype,A),n&&e(t,n),t}}(),l=function(){function e(){A(this,e)}return n(e,[{key:"getStoredLicense",value:function(e){}},{key:"getDriveFileListFromFolder",value:function(e,t,A){var n="https://www.googleapis.com/drive/v3/files?q=name%3D'"+t+"'&spaces="+e;texthelp.RW4GC.promiseTimeout(5e3,fetch(n,{method:"get",headers:new Headers({Authorization:"Bearer "+A})})).then(function(e){var t=e.headers.get("content-type");if(t&&t.includes("application/json"))return e.json();throw new TypeError("Oops, we haven't got JSON!")}).then(function(e){console.log(e)}).catch(function(e){console.log(e)})}}]),e}();t.default=l},function(e,t,A){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var A=0;A<t.length;A++){var n=t[A];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,A,n){return A&&e(t.prototype,A),n&&e(t,n),t}}(),r=A(2),i=n(r),m=A(8),a=n(m),s=function(){function e(t){l(this,e);try{t==texthelp.RW4GC.enums.AccountType.GOOGLE?this._authenticator=new i.default:t==texthelp.RW4GC.enums.AccountType.MICROSOFTSHAREPOINT?this._authenticator=new a.default:this._authenticator={}}catch(e){console.log(e),this._authenticator={}}}return o(e,[{key:"authenticator",get:function(){return this._authenticator}}]),e}();t.default=s},function(e,t,A){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var A=0;A<t.length;A++){var n=t[A];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,A,n){return A&&e(t.prototype,A),n&&e(t,n),t}}(),m=A(9),a=n(m),s=function(e){function t(){l(this,t);var e=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.scopes={},e.scopes[texthelp.RW4GC.enums.AccessType.IDENTITY]=[],e.scopes[texthelp.RW4GC.enums.AccessType.HIGHLIGHTS]=[],e.scopes[texthelp.RW4GC.enums.AccessType.VOCAB]=[],e.scopes[texthelp.RW4GC.enums.AccessType.VOICENOTES]=[],e._interactive=!1,e}return r(t,e),i(t,[{key:"authenticate",value:function(e,t,A,n,l,o){var r=this;this._interactive=e,void 0===o&&(o=!0);var i="1a406439-3b21-4c7b-b654-8885aadbdc81",m=chrome.identity.getRedirectURL("provider_cb"),a="https://graph.microsoft.com/",s={interactive:e,url:"https://login.windows.net/common/oauth2/authorize?client_id="+i+"&response_type=token&resource="+a+"&redirect_uri="+m+"&scope=email"};chrome.identity.launchWebAuthFlow(s,function(i){if(void 0!==chrome.runtime.lastError,void 0==i)return o=!1,n(null);var m=i.split("access_token=");if(m.length<2)return o=!1,n(null);var a=m[1].split("&")[0];A.bind(r)(a,e,t,A,n,l,o)})}},{key:"_handleErrors",value:function(e,t,A,n,l,o,r,i){return e.ok?(this._token=i,e.json()):401==e.status&&t?(t=!1,this._revokeCachedToken(i,A,n,l,o,r),null):(e.token=i,e.email="",e)}},{key:"authenticateDirectory",value:function(e,t,A,n,l,o){var r="1a406439-3b21-4c7b-b654-8885aadbdc81",i=chrome.identity.getRedirectURL("provider_cb");({interactive:e,url:"https://login.windows.net/common/oauth2/authorize?client_id="+r+"&response_type=token&resource="+GRAPHRESOURCE+"&redirect_uri="+i+"&scope=email"})}},{key:"getRemoteAccessToken",value:function(e,t,A,n,l,o,r,i){var m=this,a="https://rwedge.texthelp.com/thOffice365Service.asmx/generateAccessToken",s=JSON.stringify({code:e,account_type:t,resource:A,redirect_uri:n,client_id:l,session_state:o,scope:r});fetch(a,{headers:{"Content-Type":"application/json"},method:"POST",body:s}).then(function(e){return e.json()}).then(function(e){m._directoryAccessToken=e.d,i(m._directoryAccessToken)}).catch(function(e){console.log(e)})}},{key:"id",get:function(){return this._id}},{key:"licenseType",get:function(){return"MicrosoftSharepoint"}}]),t}(a.default);t.default=s},function(e,t,A){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var A=0;A<t.length;A++){var n=t[A];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,A,n){return A&&e(t.prototype,A),n&&e(t,n),t}}(),m=A(4),a=n(m),s=function(e){function t(){l(this,t);var e=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e._id="",e._name="",e.o365AccessCode,e.o365DiscoveryAccessToken,e.o365DiscoveryRefreshToken,e.o365FilesAccessToken,e.o365FilesRefreshToken,e.o365ServiceEndpointURI,e.o365ServiceResourceId,e.o365Session,e.documentOpened=!1,e.blankDocument="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",
e}return r(t,e),i(t,[{key:"getLocalID",value:function(e){e("")}},{key:"getStoredLicense",value:function(e){e(null)}},{key:"getAuthenticatedID",value:function(e,t,A,n,l,o,r){var i=this,m="https://graph.microsoft.com/v1.0/me";try{fetch(m,{method:"get",headers:{Authorization:"Bearer "+e}}).then(function(m){return i._handleErrors(m,r,t,A,n,l,o,e)}).then(function(e){null!==e&&(i._id=e.mail,l(i._id))})}catch(e){}}},{key:"convertImgToBase64URLP",value:function(e){return new Promise(function(t,A){var n=new Image;n.crossOrigin="Anonymous",n.onload=function(e){var A,n=document.createElement("CANVAS"),l=n.getContext("2d");n.height=e.target.height,n.width=e.target.width,l.drawImage(e.target,0,0),A=n.toDataURL("image/png");var o=[];o.push(A.slice(22)),n=null,t(o)}.bind(this),n.onerror=function(){A(e)}.bind(this),n.src=e})}},{key:"getODforBusinessURI",value:function(e,t){var A="https://api.office.com/discovery/v2.0/me/services";texthelp.RW4GC.promiseTimeout(5e3,fetch(A,{headers:{Authorization:"Bearer "+e},method:"get"}).then(function(e){return e.json()}.bind(this)).then(function(e){if(void 0!=e.value)for(var A=0;A<e.value.length;A++)void 0!==e.value[A].serviceApiVersion&&"v2.0"==e.value[A].serviceApiVersion&&(t(e.value[A]),A=e.value.length)}.bind(this)).catch(function(e){console.log(e)}))}},{key:"getAccessTokenForMS",value:function(e,t,A,n,l,o,r,i,m,a,s,c,u,p){var X="http://localhost:60771/thOffice365Service.asmx/generateAccessToken",h=JSON.stringify({code:e,account_type:u,resource:c,redirect_uri:s,client_id:a});texthelp.RW4GC.promiseTimeout(5e3,fetch(X,{headers:{"Content-Type":"application/json"},method:"POST",body:h}).then(function(e){return e.json()}.bind(this)).then(function(e){this._directoryAccessToken=e.d,null!=p&&p(e.d,t,A,n,l,o,r,i,m,a,s)}.bind(this)).catch(function(e){console.log(e)}))}},{key:"redeemRefreshTokenForCallToOneDrive",value:function(e,t,A,n,l){var o="http://localhost:60771/thOffice365Service.asmx/redeemRefreshTokenForCallToOneDrive",r=JSON.stringify({client_id:e,redirect_uri:t,refresh_token:A,resource:n});texthelp.RW4GC.promiseTimeout(5e3,fetch(o,{headers:{"Content-Type":"application/json"},method:"POST",body:r}).then(function(e){return e.json()}.bind(this)).then(function(e){l(JSON.parse(e.d))}.bind(this)).catch(function(e){console.log(e)}))}},{key:"redeemAuthCodeForTokens",value:function(e,t,A,n,l){var o="http://localhost:60771/thOffice365Service.asmx/redeemAuthCodeForTokens",r=JSON.stringify({client_id:e,redirect_uri:t,code:A,resource:n});texthelp.RW4GC.promiseTimeout(5e3,fetch(o,{headers:{"Content-Type":"application/json"},method:"POST",body:r}).then(function(e){return e.json()}.bind(this)).then(function(e){l(JSON.parse(e.d))}.bind(this)).catch(function(e){console.log(e)}))}},{key:"uploadFileToOneDrive",value:function(e,t,A){var n="https://graph.microsoft.com/v1.0/me/drive/root";texthelp.RW4GC.promiseTimeout(5e3,fetch(n,{headers:{Authorization:"Bearer "+A},method:"GET"}).then(function(e){return e.json()}.bind(this)).then(function(e){callback(JSON.parse(e.d))}.bind(this)).catch(function(e){console.log(e)}))}},{key:"upload0365SharepointDocument",value:function(e,t,A,n,l,o,r,i){var m="https://graph.microsoft.com/v1.0/me/drive/root/children/"+n+".docx/content";texthelp.RW4GC.promiseTimeout(5e3,fetch(m,{headers:{"Content-type":"application/octet-stream",Authorization:"Bearer "+e},method:"PUT",body:l}).then(function(e){return e.json()}.bind(this)).then(function(e){null!=e.webUrl&&window.open(e.webUrl,"_thNewDocument")}.bind(this)).catch(function(e){console.log(e)}))}},{key:"upload0365SharepointDocument2",value:function(e,t,A,n,l,o,r,i){var m=!1;this.authenticateDirectory(t,A,o,function(e){this.o365DiscoveryAccessToken=e;var t=new XMLHttpRequest;t.open("GET","https://api.office.com/discovery/me/services",!0),t.setRequestHeader("Authorization","Bearer "+this.o365DiscoveryAccessToken),t.setRequestHeader("Accept","application/json;odata=verbose"),t.onreadystatechange=function(e){var t="";if(4==e.target.readyState&&200==e.target.status&&(t=e.target.getResponseHeader("Content-Type"),"application/json"==t.substr(0,16))){var A=JSON.parse(e.target.response);this.o365ServiceEndpointURI=A.d.results[0].ServiceEndpointUri,this.o365ServiceResourceId=A.d.results[0].ServiceResourceId;var o="0c83ac77-768d-478d-ab44-b3ff4c8b38dc",r=chrome.identity.getRedirectURL("provider_cb"),i="";this.getRemoteAccessToken(this.o365AccessCode,"2",this.o365ServiceResourceId,r,o,this.o365Session,i,function(e){this.o365FilesAccessToken=e;var t=new XMLHttpRequest;t.open("PUT",this.o365ServiceEndpointURI+"/v1.0/files/root/children/"+n+".docx/content?nameConflict=overwrite"),t.setRequestHeader("Authorization","Bearer "+this.o365FilesAccessToken),t.setRequestHeader("Accept","application/json"),t.setRequestHeader("Content-Type","application/octet-stream"),t.onreadystatechange=function(e){if(201===e.target.status&&3===e.target.readyState&&"Created"===e.target.statusText&&!m){m=!0;var t=JSON.stringify(e.target.response),A=t.indexOf("eTag"),n=t.indexOf("{",A),l=t.indexOf("}",n)+1,o=t.substring(n,l),r=this.o365ServiceEndpointURI,i=r.substring(0,r.indexOf("_api")),a=i+"_layouts/15/WopiFrame.aspx?sourcedoc="+o+"&action=edit";window.open(a)}}.bind(this),t.send(l)}.bind(this))}}.bind(this),t.send()},r,i)}},{key:"writeCollectHighlightsDoc",value:function(e,t,A,n,l,o,r){var i=1,m=new openXml.OpenXmlPackage(this.blankDocument),a=m.mainDocumentPart().getXDocument().root.element(openXml.W.body);if(1===i){var s=0;for(s=0;s<o.highlights.length;++s){var c;"yellow"===o.highlights[s].color||"#FFFF00"===o.highlights[s].color?c="yellow":"magenta"===o.highlights[s].color||"#FF00FF"===o.highlights[s].color?c="magenta":"green"===o.highlights[s].color||"#ADFF2F"===o.highlights[s].color?c="green":"blue"!==o.highlights[s].color&&"#00FFFF"!==o.highlights[s].color||(c="cyan");var u=new Ltxml.XElement(openXml.W.p,new Ltxml.XElement(openXml.W.r,new Ltxml.XElement(openXml.W.rPr,new Ltxml.XElement(openXml.W.rFonts,new Ltxml.XAttribute(openXml.W.cs,"Arial")),new Ltxml.XElement(openXml.W.color,new Ltxml.XAttribute(openXml.W.val,"000000")),new Ltxml.XElement(openXml.W.sz,new Ltxml.XAttribute(openXml.W.val,"24")),new Ltxml.XElement(openXml.W.highlight,new Ltxml.XAttribute(openXml.W.val,c))),new Ltxml.XElement(openXml.W.t,o.highlights[s].text))),p=a.elements(openXml.W.p).lastOrDefault();null!==p&&p.addAfterSelf(u)}}else{for(var s=0;s<yellowHighlights.length;++s){var u=new Ltxml.XElement(openXml.W.p,new Ltxml.XElement(openXml.W.r,new Ltxml.XElement(openXml.W.rPr,new Ltxml.XElement(openXml.W.rFonts,new Ltxml.XAttribute(openXml.W.cs,"Arial")),new Ltxml.XElement(openXml.W.color,new Ltxml.XAttribute(openXml.W.val,"000000")),new Ltxml.XElement(openXml.W.sz,new Ltxml.XAttribute(openXml.W.val,"24")),new Ltxml.XElement(openXml.W.highlight,new Ltxml.XAttribute(openXml.W.val,"yellow"))),new Ltxml.XElement(openXml.W.t,yellowHighlights[s])));p=a.elements(openXml.W.p).lastOrDefault(),null!==p&&p.addAfterSelf(u)}for(var s=0;s<cyanHighlights.length;++s){var u=new Ltxml.XElement(openXml.W.p,new Ltxml.XElement(openXml.W.r,new Ltxml.XElement(openXml.W.rPr,new Ltxml.XElement(openXml.W.rFonts,new Ltxml.XAttribute(openXml.W.cs,"Arial")),new Ltxml.XElement(openXml.W.color,new Ltxml.XAttribute(openXml.W.val,"000000")),new Ltxml.XElement(openXml.W.sz,new Ltxml.XAttribute(openXml.W.val,"24")),new Ltxml.XElement(openXml.W.highlight,new Ltxml.XAttribute(openXml.W.val,"cyan"))),new Ltxml.XElement(openXml.W.t,cyanHighlights[s])));p=a.elements(openXml.W.p).lastOrDefault(),null!==p&&p.addAfterSelf(u)}for(var s=0;s<greenHighlights.length;++s){var u=new Ltxml.XElement(openXml.W.p,new Ltxml.XElement(openXml.W.r,new Ltxml.XElement(openXml.W.rPr,new Ltxml.XElement(openXml.W.rFonts,new Ltxml.XAttribute(openXml.W.cs,"Arial")),new Ltxml.XElement(openXml.W.color,new Ltxml.XAttribute(openXml.W.val,"000000")),new Ltxml.XElement(openXml.W.sz,new Ltxml.XAttribute(openXml.W.val,"24")),new Ltxml.XElement(openXml.W.highlight,new Ltxml.XAttribute(openXml.W.val,"green"))),new Ltxml.XElement(openXml.W.t,greenHighlights[s])));p=a.elements(openXml.W.p).lastOrDefault(),null!==p&&p.addAfterSelf(u)}for(var s=0;s<magentaHighlights.length;++s){var u=new Ltxml.XElement(openXml.W.p,new Ltxml.XElement(openXml.W.r,new Ltxml.XElement(openXml.W.rPr,new Ltxml.XElement(openXml.W.rFonts,new Ltxml.XAttribute(openXml.W.cs,"Arial")),new Ltxml.XElement(openXml.W.color,new Ltxml.XAttribute(openXml.W.val,"000000")),new Ltxml.XElement(openXml.W.sz,new Ltxml.XAttribute(openXml.W.val,"24")),new Ltxml.XElement(openXml.W.highlight,new Ltxml.XAttribute(openXml.W.val,"magenta"))),new Ltxml.XElement(openXml.W.t,greenHighlights[s])));p=a.elements(openXml.W.p).lastOrDefault(),null!==p&&p.addAfterSelf(u)}}var X=new Ltxml.XElement(openXml.W.p,new Ltxml.XElement(openXml.W.pPr,new Ltxml.XElement(openXml.W.rFonts,new Ltxml.XAttribute(openXml.W.ascii,"Arial Bold"),new Ltxml.XAttribute(openXml.W.hAnsi,"Arial Bold")),new Ltxml.XElement(openXml.W.sz,new Ltxml.XAttribute(openXml.W.val,"24"))),new Ltxml.XElement(openXml.W.r,new Ltxml.XElement(openXml.W.rPr,new Ltxml.XElement(openXml.W.rFonts,new Ltxml.XAttribute(openXml.W.ascii,"Arial Bold"),new Ltxml.XAttribute(openXml.W.hAnsi,"Arial Bold")),new Ltxml.XElement(openXml.W.sz,new Ltxml.XAttribute(openXml.W.val,"24"))),new Ltxml.XElement(openXml.W.t,o.title),new Ltxml.XElement(openXml.W.br)),new Ltxml.XElement(openXml.W.r,new Ltxml.XElement(openXml.W.rPr,new Ltxml.XElement(openXml.W.rFonts,new Ltxml.XAttribute(openXml.W.ascii,"Arial Bold"),new Ltxml.XAttribute(openXml.W.hAnsi,"Arial Bold")),new Ltxml.XElement(openXml.W.sz,new Ltxml.XAttribute(openXml.W.val,"24"))),new Ltxml.XElement(openXml.W.t,this._email),new Ltxml.XElement(openXml.W.br)),new Ltxml.XElement(openXml.W.r,new Ltxml.XElement(openXml.W.rPr,new Ltxml.XElement(openXml.W.rFonts,new Ltxml.XAttribute(openXml.W.ascii,"Arial Bold"),new Ltxml.XAttribute(openXml.W.hAnsi,"Arial Bold")),new Ltxml.XElement(openXml.W.sz,new Ltxml.XAttribute(openXml.W.val,"24"))),new Ltxml.XElement(openXml.W.t,o.url)));p=a.elements(openXml.W.p).lastOrDefault(),null!==p&&p.addAfterSelf(X);var h,d=(m.saveToBase64(),m.saveToBlob()),w=new FileReader;w.onload=function(l){h=l.target.result;for(var i="",m=new Uint8Array(h),a=m.byteLength,s=0;s<a;s++)i+=String.fromCharCode(m[s]);for(var c=o.docTitle+" "+(new Date).getTime(),u=window.atob(window.btoa(i)),a=u.length,m=new Uint8Array(a),s=0;s<a;s++)m[s]=u.charCodeAt(s);var p=m.buffer;this.upload0365SharepointDocument(e,t,A,c,p,n,o,r)}.bind(this),w.readAsArrayBuffer(d)}},{key:"writeVocabResponse",value:function(e,t,A,n,l,o,r){this.imageProcessed=!0,this.base64ImagesArray=[];var i,m=[],a=o.vocab.words,s={};s.words=[],s.translations=o.translations,s.locale=o.locale,s.user=o.user,s.sendResponse=o.sendResponse;for(var c=s.translations.docTitle+(new Date).getTime(),u=0;u<a.length;u++){var p={};p.word=a[u].word,p.definitions=[],p.symbols=[];var X=a[u].inflections;if(X.length>0)for(var h=0;h<X.length;h++){for(var d=0;d<X[h].definitions.length;d++)p.definitions.push(X[h].definitions[d].definition);for(i=X[h].symbols,d=0;d<i.length;d++)p.symbols.push(i[d]),m.push(i[d])}s.words.push(p)}var w=m.map(this.convertImgToBase64URLP);Promise.all(w).then(function(i){this.createvocabdoc(c,a,s,i,e,t,A,n,l,o,r)}.bind(this)).catch(function(e){console.log("Error fetching some images: "+e)}.bind(this))}},{key:"writeVocabHTMLResponse",value:function(e,t,A,n,l,o,r){this.imageProcessed=!0,this.base64ImagesArray=[];var i,m=[],a=o.vocab.words,s={};s.words=[],s.translations=o.translations,s.locale=o.locale,s.user=o.user,s.sendResponse=o.sendResponse;for(var c=s.translations.docTitle+(new Date).getTime(),u=0;u<a.length;u++){var p={};p.word=a[u].word,p.definitions=[],p.symbols=[],p.definitions.push(a[u].definitionText),i=a[u].symbols;for(var X=0;X<i.length;X++)p.symbols.push(i[X]),m.push(i[X]);s.words.push(p)}var h=m.map(this.convertImgToBase64URLP);Promise.all(h).then(function(i){this.createvocabdoc(c,a,s,i,e,t,A,n,l,o,r)}.bind(this)).catch(function(e){console.log("Error fetching some images: "+e)}.bind(this))}},{key:"createvocabdoc",value:function(e,t,A,n,l,o,r,i,m,a,s){for(var c=0,u=new openXml.OpenXmlPackage(this.blankDocument),p=(u.mainDocumentPart().getXDocument().root.element(openXml.W.body),new Ltxml.XElement(openXml.W.p,new Ltxml.XElement(openXml.W.pPr,new Ltxml.XElement(openXml.W.pStyle,new Ltxml.XAttribute(openXml.W.val,"Title")),new Ltxml.XElement(openXml.W.jc,new Ltxml.XAttribute(openXml.W.val,"center"))),new Ltxml.XElement(openXml.W.r,new Ltxml.XElement(openXml.W.t,A.translations.title)))),X=new Ltxml.XElement(openXml.W.p,new Ltxml.XElement(openXml.W.pPr,new Ltxml.XElement(openXml.W.pStyle,new Ltxml.XAttribute(openXml.W.val,"Heading1"))),new Ltxml.XElement(openXml.W.r,new Ltxml.XElement(openXml.W.t,""))),h=[],d=0;d<n.length;d++){var w=n[d][0],f="rId"+(u.mainDocumentPart().getRelationships().length+1),b=new Ltxml.XElement(openXml.W.drawing,new Ltxml.XElement(openXml.WP.inline,new Ltxml.XElement(openXml.WP.extent,new Ltxml.XAttribute(openXml.NoNamespace.cx,"457200"),new Ltxml.XAttribute(openXml.NoNamespace.cy,"457200")),new Ltxml.XElement(openXml.WP.docPr,new Ltxml.XAttribute(openXml.NoNamespace.id,d),new Ltxml.XAttribute(openXml.NoNamespace.name,"Pic"+d),new Ltxml.XAttribute(openXml.NoNamespace.descr,"thlogo.png")),new Ltxml.XElement(openXml.A.graphic,new Ltxml.XElement(openXml.A.graphicData,new Ltxml.XAttribute(openXml.NoNamespace.uri,"http://schemas.openxmlformats.org/drawingml/2006/picture"),new Ltxml.XElement(openXml.Pic._pic,new Ltxml.XElement(openXml.Pic.nvPicPr,new Ltxml.XElement(openXml.Pic.cNvPr,new Ltxml.XAttribute(openXml.NoNamespace.id,d),new Ltxml.XAttribute(openXml.NoNamespace.name,"thlogo.png")),new Ltxml.XElement(openXml.Pic.cNvPicPr)),new Ltxml.XElement(openXml.Pic.blipFill,new Ltxml.XElement(openXml.A.blip,new Ltxml.XAttribute(openXml.R.embed,f)),new Ltxml.XElement(openXml.A.stretch,new Ltxml.XElement(openXml.A.fillRect))),new Ltxml.XElement(openXml.Pic.spPr,new Ltxml.XElement(openXml.A.xfrm,new Ltxml.XElement(openXml.A.ext,new Ltxml.XAttribute(openXml.NoNamespace.cx,"457200"),new Ltxml.XAttribute(openXml.NoNamespace.cy,"457200"))),new Ltxml.XElement(openXml.A.prstGeom,new Ltxml.XAttribute(openXml.NoNamespace.prst,"rect")))))))),x="/word/media/image"+d+".png",L="media/image"+d+".png";u.addPart(x,openXml.contentTypes.png,"base64",w),u.mainDocumentPart().addRelationship(f,openXml.relationshipTypes.image,L,"Internal"),h.push(b)}var v=new Ltxml.XElement(openXml.W.tblPr,new Ltxml.XElement(openXml.W.tblStyle,new Ltxml.XAttribute(openXml.W.val,"TableGrid")),new Ltxml.XElement(openXml.W.tblW,new Ltxml.XAttribute(openXml.W._w,0),new Ltxml.XAttribute(openXml.W.type,"dxa")),new Ltxml.XElement(openXml.W.tblLook,new Ltxml.XAttribute(openXml.W.val,"04A0"),new Ltxml.XAttribute(openXml.W.firstRow,1),new Ltxml.XAttribute(openXml.W.lastRow,0),new Ltxml.XAttribute(openXml.W.firstColumn,1),new Ltxml.XAttribute(openXml.W.lastColumn,0),new Ltxml.XAttribute(openXml.W.noHBand,0),new Ltxml.XAttribute(openXml.W.noVBand,1))),g=new Ltxml.XElement(openXml.W.tblGrid,new Ltxml.XElement(openXml.W.gridCol,new Ltxml.XAttribute(openXml.W._w,1326)),new Ltxml.XElement(openXml.W.gridCol,new Ltxml.XAttribute(openXml.W._w,5355)),new Ltxml.XElement(openXml.W.gridCol,new Ltxml.XAttribute(openXml.W._w,1575)),new Ltxml.XElement(openXml.W.gridCol,new Ltxml.XAttribute(openXml.W._w,1200))),W=[],E="E7E6E6",y=new Ltxml.XElement(openXml.W.tc,new Ltxml.XElement(openXml.W.tcPr,new Ltxml.XElement(openXml.W.tcW,new Ltxml.XAttribute(openXml.W._w,1326),new Ltxml.XAttribute(openXml.W.type,"dxa")),new Ltxml.XElement(openXml.W.shd,new Ltxml.XAttribute(openXml.W.val,"clear"),new Ltxml.XAttribute(openXml.W.color,"auto"),new Ltxml.XAttribute(openXml.W.fill,E))),new Ltxml.XElement(openXml.W.p,new Ltxml.XElement(openXml.W.pPr,new Ltxml.XElement(openXml.W.spacing,new Ltxml.XAttribute(openXml.W.before,80),new Ltxml.XAttribute(openXml.W.after,80)),0===k?new Ltxml.XElement(openXml.W.jc,new Ltxml.XAttribute(openXml.W.val,"center")):new Ltxml.XElement(openXml.W.jc,new Ltxml.XAttribute(openXml.W.val,"center")),new Ltxml.XElement(openXml.W.rPr,new Ltxml.XElement(openXml.W.rFonts,new Ltxml.XAttribute(openXml.W.ascii,"Trebuchet MS"),new Ltxml.XAttribute(openXml.W.hAnsi,"Trebuchet MS")),new Ltxml.XElement(openXml.W.sz,new Ltxml.XAttribute(openXml.W.val,"32")),0===k?new Ltxml.XElement(openXml.W.b):null)),new Ltxml.XElement(openXml.W.r,new Ltxml.XElement(openXml.W.rPr,new Ltxml.XElement(openXml.W.rFonts,new Ltxml.XAttribute(openXml.W.ascii,"Trebuchet MS"),new Ltxml.XAttribute(openXml.W.hAnsi,"Trebuchet MS")),new Ltxml.XElement(openXml.W.sz,new Ltxml.XAttribute(openXml.W.val,"32")),0===k?new Ltxml.XElement(openXml.W.b):null),new Ltxml.XElement(openXml.W.t,A.translations.heading)))),T=new Ltxml.XElement(openXml.W.tc,new Ltxml.XElement(openXml.W.tcPr,new Ltxml.XElement(openXml.W.tcW,new Ltxml.XAttribute(openXml.W._w,5355),new Ltxml.XAttribute(openXml.W.type,"dxa")),new Ltxml.XElement(openXml.W.shd,new Ltxml.XAttribute(openXml.W.val,"clear"),new Ltxml.XAttribute(openXml.W.color,"auto"),new Ltxml.XAttribute(openXml.W.fill,E))),new Ltxml.XElement(openXml.W.p,new Ltxml.XElement(openXml.W.pPr,new Ltxml.XElement(openXml.W.spacing,new Ltxml.XAttribute(openXml.W.before,80),new Ltxml.XAttribute(openXml.W.after,80)),0===k?new Ltxml.XElement(openXml.W.jc,new Ltxml.XAttribute(openXml.W.val,"center")):new Ltxml.XElement(openXml.W.jc,new Ltxml.XAttribute(openXml.W.val,"center")),new Ltxml.XElement(openXml.W.rPr,new Ltxml.XElement(openXml.W.rFonts,new Ltxml.XAttribute(openXml.W.ascii,"Trebuchet MS"),new Ltxml.XAttribute(openXml.W.hAnsi,"Trebuchet MS")),new Ltxml.XElement(openXml.W.sz,new Ltxml.XAttribute(openXml.W.val,"32")),0===k?new Ltxml.XElement(openXml.W.b):null)),new Ltxml.XElement(openXml.W.r,new Ltxml.XElement(openXml.W.rPr,new Ltxml.XElement(openXml.W.rFonts,new Ltxml.XAttribute(openXml.W.ascii,"Trebuchet MS"),new Ltxml.XAttribute(openXml.W.hAnsi,"Trebuchet MS")),new Ltxml.XElement(openXml.W.sz,new Ltxml.XAttribute(openXml.W.val,"32")),0===k?new Ltxml.XElement(openXml.W.b):null),new Ltxml.XElement(openXml.W.t,A.translations.meaning)))),S=new Ltxml.XElement(openXml.W.tc,new Ltxml.XElement(openXml.W.tcPr,new Ltxml.XElement(openXml.W.tcW,new Ltxml.XAttribute(openXml.W._w,1575),new Ltxml.XAttribute(openXml.W.type,"dxa")),new Ltxml.XElement(openXml.W.shd,new Ltxml.XAttribute(openXml.W.val,"clear"),new Ltxml.XAttribute(openXml.W.color,"auto"),new Ltxml.XAttribute(openXml.W.fill,E))),new Ltxml.XElement(openXml.W.p,new Ltxml.XElement(openXml.W.pPr,new Ltxml.XElement(openXml.W.spacing,new Ltxml.XAttribute(openXml.W.before,80),new Ltxml.XAttribute(openXml.W.after,80)),0===k?new Ltxml.XElement(openXml.W.jc,new Ltxml.XAttribute(openXml.W.val,"center")):new Ltxml.XElement(openXml.W.jc,new Ltxml.XAttribute(openXml.W.val,"center")),new Ltxml.XElement(openXml.W.rPr,new Ltxml.XElement(openXml.W.rFonts,new Ltxml.XAttribute(openXml.W.ascii,"Trebuchet MS"),new Ltxml.XAttribute(openXml.W.hAnsi,"Trebuchet MS")),new Ltxml.XElement(openXml.W.sz,new Ltxml.XAttribute(openXml.W.val,"32")),0===k?new Ltxml.XElement(openXml.W.b):null)),new Ltxml.XElement(openXml.W.r,new Ltxml.XElement(openXml.W.rPr,new Ltxml.XElement(openXml.W.rFonts,new Ltxml.XAttribute(openXml.W.ascii,"Trebuchet MS"),new Ltxml.XAttribute(openXml.W.hAnsi,"Trebuchet MS")),new Ltxml.XElement(openXml.W.sz,new Ltxml.XAttribute(openXml.W.val,"32")),0===k?new Ltxml.XElement(openXml.W.b):null),new Ltxml.XElement(openXml.W.t,A.translations.symbol)))),C=new Ltxml.XElement(openXml.W.tc,new Ltxml.XElement(openXml.W.tcPr,new Ltxml.XElement(openXml.W.tcW,new Ltxml.XAttribute(openXml.W._w,1200),new Ltxml.XAttribute(openXml.W.type,"dxa")),new Ltxml.XElement(openXml.W.shd,new Ltxml.XAttribute(openXml.W.val,"clear"),new Ltxml.XAttribute(openXml.W.color,"auto"),new Ltxml.XAttribute(openXml.W.fill,E))),new Ltxml.XElement(openXml.W.p,new Ltxml.XElement(openXml.W.pPr,new Ltxml.XElement(openXml.W.spacing,new Ltxml.XAttribute(openXml.W.before,80),new Ltxml.XAttribute(openXml.W.after,80)),0===k?new Ltxml.XElement(openXml.W.jc,new Ltxml.XAttribute(openXml.W.val,"center")):new Ltxml.XElement(openXml.W.jc,new Ltxml.XAttribute(openXml.W.val,"center")),new Ltxml.XElement(openXml.W.rPr,new Ltxml.XElement(openXml.W.rFonts,new Ltxml.XAttribute(openXml.W.ascii,"Trebuchet MS"),new Ltxml.XAttribute(openXml.W.hAnsi,"Trebuchet MS")),new Ltxml.XElement(openXml.W.sz,new Ltxml.XAttribute(openXml.W.val,"32")),0===k?new Ltxml.XElement(openXml.W.b):null)),new Ltxml.XElement(openXml.W.r,new Ltxml.XElement(openXml.W.rPr,new Ltxml.XElement(openXml.W.rFonts,new Ltxml.XAttribute(openXml.W.ascii,"Trebuchet MS"),new Ltxml.XAttribute(openXml.W.hAnsi,"Trebuchet MS")),new Ltxml.XElement(openXml.W.sz,new Ltxml.XAttribute(openXml.W.val,"32")),0===k?new Ltxml.XElement(openXml.W.b):null),new Ltxml.XElement(openXml.W.t,A.translations.notes)))),P=new Ltxml.XElement(openXml.W.tr,y,T,S,C);W.push(P);for(var k=0;k<A.words.length;k++){var O=k%2===0,R="99CDFF",y=new Ltxml.XElement(openXml.W.tc,new Ltxml.XElement(openXml.W.tcPr,new Ltxml.XElement(openXml.W.tcW,new Ltxml.XAttribute(openXml.W._w,1326),new Ltxml.XAttribute(openXml.W.type,"dxa")),O?new Ltxml.XElement(openXml.W.shd,new Ltxml.XAttribute(openXml.W.val,"clear"),new Ltxml.XAttribute(openXml.W.color,"auto"),new Ltxml.XAttribute(openXml.W.fill,R)):null),new Ltxml.XElement(openXml.W.p,new Ltxml.XElement(openXml.W.pPr,new Ltxml.XElement(openXml.W.spacing,new Ltxml.XAttribute(openXml.W.before,80),new Ltxml.XAttribute(openXml.W.after,80)),0===k?new Ltxml.XElement(openXml.W.jc,new Ltxml.XAttribute(openXml.W.val,"center")):new Ltxml.XElement(openXml.W.jc,new Ltxml.XAttribute(openXml.W.val,"center")),new Ltxml.XElement(openXml.W.rPr,new Ltxml.XElement(openXml.W.rFonts,new Ltxml.XAttribute(openXml.W.ascii,"Trebuchet MS"),new Ltxml.XAttribute(openXml.W.hAnsi,"Trebuchet MS")),new Ltxml.XElement(openXml.W.sz,new Ltxml.XAttribute(openXml.W.val,"24")),0===k?new Ltxml.XElement(openXml.W.b):null)),new Ltxml.XElement(openXml.W.r,new Ltxml.XElement(openXml.W.rPr,new Ltxml.XElement(openXml.W.rFonts,new Ltxml.XAttribute(openXml.W.ascii,"Trebuchet MS"),new Ltxml.XAttribute(openXml.W.hAnsi,"Trebuchet MS")),new Ltxml.XElement(openXml.W.sz,new Ltxml.XAttribute(openXml.W.val,"24")),0===k?new Ltxml.XElement(openXml.W.b):null),new Ltxml.XElement(openXml.W.t,t[k].word)))),F=A.words[k].definitions,N="";if(F.length>0)for(var I=0;I<F.length;I++)N=(N+F[I]).trim(),I<F.length-1&&(N+="\n\n");var T=new Ltxml.XElement(openXml.W.tc,new Ltxml.XElement(openXml.W.tcPr,new Ltxml.XElement(openXml.W.tcW,new Ltxml.XAttribute(openXml.W._w,5355),new Ltxml.XAttribute(openXml.W.type,"dxa")),O?new Ltxml.XElement(openXml.W.shd,new Ltxml.XAttribute(openXml.W.val,"clear"),new Ltxml.XAttribute(openXml.W.color,"auto"),new Ltxml.XAttribute(openXml.W.fill,R)):null),new Ltxml.XElement(openXml.W.p,new Ltxml.XElement(openXml.W.pPr,new Ltxml.XElement(openXml.W.spacing,new Ltxml.XAttribute(openXml.W.before,80),new Ltxml.XAttribute(openXml.W.after,80)),0===k?new Ltxml.XElement(openXml.W.jc,new Ltxml.XAttribute(openXml.W.val,"center")):new Ltxml.XElement(openXml.W.jc,new Ltxml.XAttribute(openXml.W.val,"center")),new Ltxml.XElement(openXml.W.rPr,new Ltxml.XElement(openXml.W.rFonts,new Ltxml.XAttribute(openXml.W.ascii,"Trebuchet MS"),new Ltxml.XAttribute(openXml.W.hAnsi,"Trebuchet MS")),new Ltxml.XElement(openXml.W.sz,new Ltxml.XAttribute(openXml.W.val,"24")),0===k?new Ltxml.XElement(openXml.W.b):null)),new Ltxml.XElement(openXml.W.r,new Ltxml.XElement(openXml.W.rPr,new Ltxml.XElement(openXml.W.rFonts,new Ltxml.XAttribute(openXml.W.ascii,"Trebuchet MS"),new Ltxml.XAttribute(openXml.W.hAnsi,"Trebuchet MS")),new Ltxml.XElement(openXml.W.sz,new Ltxml.XAttribute(openXml.W.val,"24")),0===k?new Ltxml.XElement(openXml.W.b):null),new Ltxml.XElement(openXml.W.t,N)))),S=new Ltxml.XElement(openXml.W.tc,new Ltxml.XElement(openXml.W.tcPr,new Ltxml.XElement(openXml.W.tcW,new Ltxml.XAttribute(openXml.W._w,1575),new Ltxml.XAttribute(openXml.W.type,"dxa")),O?new Ltxml.XElement(openXml.W.shd,new Ltxml.XAttribute(openXml.W.val,"clear"),new Ltxml.XAttribute(openXml.W.color,"auto"),new Ltxml.XAttribute(openXml.W.fill,R)):null)),B=A.words[k].symbols;t[k].inflections;if(B.length>0){for(var M=c;M<B.length+c;M++){var j=new Ltxml.XElement(openXml.W.p,new Ltxml.XElement(openXml.W.pPr,new Ltxml.XElement(openXml.W.spacing,new Ltxml.XAttribute(openXml.W.before,80),new Ltxml.XAttribute(openXml.W.after,80)),0===k?new Ltxml.XElement(openXml.W.jc,new Ltxml.XAttribute(openXml.W.val,"center")):new Ltxml.XElement(openXml.W.jc,new Ltxml.XAttribute(openXml.W.val,"center")),new Ltxml.XElement(openXml.W.rPr,new Ltxml.XElement(openXml.W.rFonts,new Ltxml.XAttribute(openXml.W.ascii,"Trebuchet MS"),new Ltxml.XAttribute(openXml.W.hAnsi,"Trebuchet MS")),0===k?new Ltxml.XElement(openXml.W.b):null)),new Ltxml.XElement(openXml.W.r,h[M]));S.add(j)}c=parseInt(c)+parseInt(B.length)}else{var j=new Ltxml.XElement(openXml.W.p,new Ltxml.XElement(openXml.W.pPr,new Ltxml.XElement(openXml.W.spacing,new Ltxml.XAttribute(openXml.W.before,80),new Ltxml.XAttribute(openXml.W.after,80)),new Ltxml.XElement(openXml.W.rPr,new Ltxml.XElement(openXml.W.rFonts,new Ltxml.XAttribute(openXml.W.ascii,"Trebuchet MS"),new Ltxml.XAttribute(openXml.W.hAnsi,"Trebuchet MS")),0===k?new Ltxml.XElement(openXml.W.b):null)),new Ltxml.XElement(openXml.W.r,"No Symbols"));S.add(j)}var C=new Ltxml.XElement(openXml.W.tc,new Ltxml.XElement(openXml.W.tcPr,new Ltxml.XElement(openXml.W.tcW,new Ltxml.XAttribute(openXml.W._w,1200),new Ltxml.XAttribute(openXml.W.type,"dxa")),O?new Ltxml.XElement(openXml.W.shd,new Ltxml.XAttribute(openXml.W.val,"clear"),new Ltxml.XAttribute(openXml.W.color,"auto"),new Ltxml.XAttribute(openXml.W.fill,R)):null),new Ltxml.XElement(openXml.W.p,new Ltxml.XElement(openXml.W.pPr,new Ltxml.XElement(openXml.W.spacing,new Ltxml.XAttribute(openXml.W.before,80),new Ltxml.XAttribute(openXml.W.after,80)),0===k?new Ltxml.XElement(openXml.W.jc,new Ltxml.XAttribute(openXml.W.val,"center")):new Ltxml.XElement(openXml.W.jc,new Ltxml.XAttribute(openXml.W.val,"center")),new Ltxml.XElement(openXml.W.rPr,new Ltxml.XElement(openXml.W.rFonts,new Ltxml.XAttribute(openXml.W.ascii,"Trebuchet MS"),new Ltxml.XAttribute(openXml.W.hAnsi,"Trebuchet MS")),new Ltxml.XElement(openXml.W.sz,new Ltxml.XAttribute(openXml.W.val,"32")),0===k?new Ltxml.XElement(openXml.W.b):null)),new Ltxml.XElement(openXml.W.r,new Ltxml.XElement(openXml.W.rPr,new Ltxml.XElement(openXml.W.rFonts,new Ltxml.XAttribute(openXml.W.ascii,"Trebuchet MS"),new Ltxml.XAttribute(openXml.W.hAnsi,"Trebuchet MS")),new Ltxml.XElement(openXml.W.sz,new Ltxml.XAttribute(openXml.W.val,"32")),0===k?new Ltxml.XElement(openXml.W.b):null),new Ltxml.XElement(openXml.W.t,"")))),P=new Ltxml.XElement(openXml.W.tr,y,T,S,C);W.push(P)}var D=new Ltxml.XElement(openXml.W.tbl,v,g,W);this.createAndUploadVocab("",u,p,X,D,e,l,o,r,i,m,a,s)}},{key:"createAndUploadVocab",value:function(e,t,A,n,l,o,r,i,m,a,s,c,u){var p=document.createElement("CANVAS"),X=(p.getContext("2d"),new Image),h=A,d=n,w=l,f=t;X.crossOrigin="Anonymous";var b=new Ltxml.XElement(openXml.W.document,new Ltxml.XElement(openXml.W.body,h,d,w)),x=f.mainDocumentPart().getXDocument();x.root.replaceWith(b);var L,v=(f.saveToBase64(),f.saveToFlatOpc(),f.saveToBlob()),g=new FileReader;g.onload=function(e){L=e.target.result;var t=new FormData;t.append("file",v,"VocabularyList.docx");for(var A="",n=new Uint8Array(L),l=n.byteLength,s=0;s<l;s++)A+=String.fromCharCode(n[s]);for(var p=window.atob(window.btoa(A)),l=p.length,n=new Uint8Array(l),s=0;s<l;s++)n[s]=p.charCodeAt(s);var X=n.buffer;this.upload0365SharepointDocument(r,i,m,o,X,a,c,u)}.bind(this),g.readAsArrayBuffer(v)}},{key:"getVoiceNoteToken",value:function(e,t,A,n,l,o,r){}},{key:"idScopes",get:function(){return this.scopes[texthelp.RW4GC.enums.AccessType.IDENTITY]}},{key:"collectHighlightsScopes",get:function(){return this.scopes[texthelp.RW4GC.enums.AccessType.HIGHLIGHTS]}},{key:"vocabScopes",get:function(){return this.scopes[texthelp.RW4GC.enums.AccessType.VOCAB]}},{key:"voiceNoteScopes",get:function(){return this.scopes[texthelp.RW4GC.enums.AccessType.VOICENOTES]}}]),t}(a.default);t.default=s}]);