function rwGoogleTextParse(){this.isHTML=!1,this.rootText="",this.Lefttext="",this.Leftwords="",this.MultiLineText=!1,this.MultiLineCollection="",this.ExpectLines=0,this.RightText="",this.Rightwords="",this.CurrentWordBeginIndex=0,this.CurrentWordEndIndex=0,this.CurrentWord="",this.CursorPosition=0,this.CursorLinePosition=0,this.currentChar="",this.LastCharWord="",this.ActiveLine=-1,this.CurrentPosition=0,this.NextChar="",this.Selection=void 0,this.setCaretPosition=function(e,t){if(null!=e)if(e.createTextRange){var o=e.createTextRange();o.move("character",t),o.select()}else e.selectionStart?(e.focus(),e.setSelectionRange(t,t)):e.focus()},this.getCaretPosition=function(e){var t=0;if(void 0!==window.getSelection){var o=window.getSelection().getRangeAt(0),r=o.cloneRange();r.selectNodeContents(e),r.setEnd(o.endContainer,o.endOffset),t=r.toString().length}else if(void 0!==document.selection&&"Control"!=document.selection.type){var i=document.selection.createRange(),n=document.body.createTextRange();n.moveToElementText(e),n.setEndPoint("EndToEnd",i),t=n.text.length}return t},this.InsertText=function(e,t){if("DIV"==e.tagName){e.focus();var o=document.getElementById("rwPredictionPosition");this.setCaretPositionDiv(currentContextControlID),this.setSelectionRange(e,o.value,o.value),this.currentChar=this.getCurrentCharacter(),this.replaceSelectedText(t)}else this.CurrentPosition=e.selectionStart,this.setSelectionRange(e,this.CurrentPosition,this.CurrentPosition),this.currentChar=this.getCurrentCharacter(),this.setSelectionRange(e,this.CurrentPosition,this.CurrentPosition),this.replaceSelectedText(t),this.setSelectionRange(e,this.CurrentPosition,this.CurrentPosition),this.setCaretPosition(e,this.CurrentPosition);return!1},this.setSelection=function(){window.getSelection&&(this.Selection=window.getSelection()).modify},this.parseText=function(e,t,o){"DIV"==o.tagName||(this.CurrentPosition=o.selectionStart),this.setSelectionRange(o,this.CurrentPosition,this.CurrentPosition),this.currentChar=this.getCurrentCharacter();var r=!1;switch(this.currentChar.charCodeAt(0)){case 46:case 33:case 63:this.Lefttext="",r=!0}if(!r){this.setSelectionRange(o,this.CurrentPosition,this.CurrentPosition);13==this.getPreviousCharacter().charCodeAt(0)?this.Lefttext="":(this.setSelectionRange(o,this.CurrentPosition,this.CurrentPosition),this.Lefttext=this.GetSentence())}this.setSelectionRange(o,this.CurrentPosition,this.CurrentPosition),this.NextChar=this.getNextCharacter(),this.setSelectionRange(o,this.CurrentPosition,this.CurrentPosition),32==this.currentChar.charCodeAt(0)||160==this.currentChar.charCodeAt(0)?this.CurrentWord=" ":this.CurrentWord=this.getWord(),this.setSelectionRange(o,this.CurrentPosition,this.CurrentPosition)},this.GetSentence=function(){var e,t="";if(window.getSelection&&(e=window.getSelection()).modify){var o=e.getRangeAt(0);e.collapseToStart(),32==this.currentChar.charCodeAt(0)||this.currentChar.charCodeAt(0),e.modify("extend","backward","sentenceboundary"),t=e.toString(),e.removeAllRanges(),e.addRange(o)}else if((e=document.selection)&&"Control"!=e.type){var r=e.createRange();r.collapse(!0),r.expand("sentence"),t=r.text}return t},this.getCurrentCharacter=function(){var e,t="";if(window.getSelection&&(e=window.getSelection()).modify){var o=e.getRangeAt(0);e.collapseToStart(),e.modify("move","backward","character"),e.modify("extend","forward","character"),t=e.toString(),e.removeAllRanges(),e.addRange(o)}else if((e=document.selection)&&"Control"!=e.type){var r=e.createRange();r.collapse(!0),r.expand("word"),t=r.text}return t},this.getPreviousCharacter=function(){var e,t="";if(window.getSelection&&(e=window.getSelection()).modify){var o=e.getRangeAt(0);e.collapseToStart(),e.modify("move","backward","character"),e.modify("move","backward","character"),e.modify("extend","forward","character"),t=e.toString(),e.removeAllRanges(),e.addRange(o)}else if((e=document.selection)&&"Control"!=e.type){var r=e.createRange();r.collapse(!0),r.expand("word"),t=r.text}return t},this.getNextCharacter=function(){var e,t="";if(window.getSelection&&(e=window.getSelection()).modify){var o=e.getRangeAt(0);e.collapseToStart(),e.modify("move","forward","character"),e.modify("extend","forward","character"),t=e.toString(),e.removeAllRanges(),e.addRange(o)}else if((e=document.selection)&&"Control"!=e.type){var r=e.createRange();r.collapse(!0),r.expand("word"),t=r.text}return t},this.getNewPosition=function(){var e,t="";if(window.getSelection&&(e=window.getSelection()).modify){var o=e.getRangeAt(0);e.collapseToStart(),e.modify("move","forward","word"),t=e.toString(),e.removeAllRanges(),e.addRange(o)}else if((e=document.selection)&&"Control"!=e.type){var r=e.createRange();r.collapse(!0),r.expand("word"),t=r.text}return t},this.MoveToEnd=function(){var e,t="";if(window.getSelection&&(e=window.getSelection()).modify){var o=e.getRangeAt(0);e.collapseToStart(),e.modify("move","forward","word"),e.removeAllRanges(),e.addRange(o)}else if((e=document.selection)&&"Control"!=e.type){var r=e.createRange();r.collapse(!0),r.expand("word"),t=r.text}return t},this.getWord=function(){var e,t="";if(window.getSelection&&(e=window.getSelection()).modify){var o=e.getRangeAt(0);e.collapseToStart(),e.modify("move","backward","word"),e.modify("extend","forward","word"),t=e.toString(),e.removeAllRanges(),e.addRange(o)}else if((e=document.selection)&&"Control"!=e.type){var r=e.createRange();r.collapse(!0),r.expand("word"),t=r.text}return t},this.setSelectionRange=function(e,t,o){if(e.setSelectionRange)e.focus(),e.setSelectionRange(t,o);else if(e.createTextRange){var r=e.createTextRange();r.collapse(!0),r.moveEnd("character",o),r.moveStart("character",t),r.select()}else e.focus()},this.setCaretPositionDiv=function(e,t){var o=window.getSelection();o.collapseToStart();var r=document.getElementById("rwPredictionPosition"),n=r.value;void 0!=t&&(n=t);var a=e;a.focus();var c=a.firstChild,s=0,d=n,l=!1;for(i=0;i<a.childNodes.length;i++)s+=a.childNodes[i].nodeValue.length,n<=s&&0==l?(c=a.childNodes[i],l=!0):d-=a.childNodes[i].nodeValue.length;var h=document.createRange();h.setStart(c,d),h.setEnd(c,d),o=window.getSelection(),o.removeAllRanges(),o.addRange(h)},this.replaceSelectedText=function(e){var t,o;e+=" ";var r=0;if(window.getSelection){t=window.getSelection();var i=document.activeElement;if("TEXTAREA"==i.nodeName||"INPUT"==i.nodeName&&"text"==i.type.toLowerCase()){if(this.CurrentPosition>0)switch(this.currentChar.charCodeAt(0)){case 46:case 33:case 63:e=" "+e;case 32:case 160:break;case 38:t.collapseToStart(),t.modify("move","backward","character"),t.modify("move","backward","character"),t.modify("extend","forward","character");var n=t.toString();" "==n?(t.modify("move","forward","character"),t.modify("extend","forward","character")):(t.modify("move","backward","word"),t.modify("extend","forward","word"));break;case 45:t.collapseToStart(),t.modify("move","backward","word"),t.modify("extend","forward","word"),t.modify("extend","forward","word");break;default:t.collapseToStart(),t.modify("move","backward","word"),t.modify("move","backward","character"),t.modify("extend","forward","character");var n=t.toString();if("-"==n?(t.modify("extend","backward","character"),t.modify("move","forward","character"),t.modify("move","backward","word"),t.modify("extend","forward","word"),t.modify("extend","forward","word")):32==n.charCodeAt(0)&&t.modify("move","forward","character"),t.modify("extend","forward","word"),n=t.toString(),"-"==n.substr(n.length-1,1)&&t.modify("extend","forward","word"),n=t.toString(),-1!=navigator.appVersion.indexOf("Win")){" "==n.substr(n.length-1,1)&&(t.modify("extend","backward","character"),e=e.trim(),r++),n=t.toString();var a=/^[0-9a-zA-Z]+$/;n.substr(n.length-1,1).match(a)||(t.modify("extend","backward","character"),e=e.trim(),r++)}}var c=i.value,s=i.selectionStart,d=i.selectionEnd;if(-1!=navigator.appVersion.indexOf("Win"));else switch(c.slice(d).substr(0,1)){case" ":e=e.trim(),r++;break;case";":case":":case"!":case".":e=e.trim(),r++,r++}i.value=c.slice(0,s)+e+c.slice(d),this.CurrentPosition=s+e.length+r}else{var t=window.getSelection();if(this.setCaretPositionDiv(i),32==this.currentChar.charCodeAt(0)||160==this.currentChar.charCodeAt(0));else{t.modify("move","backward","word"),t.modify("move","backward","character"),t.modify("extend","forward","character");var n=t.toString();"-"==n?(t.modify("extend","backward","character"),t.modify("move","forward","character"),t.modify("move","backward","word"),t.modify("extend","forward","word"),t.modify("extend","forward","word")):32==n.charCodeAt(0)&&t.modify("move","forward","character"),t.modify("extend","forward","word")}t.rangeCount?(o=t.getRangeAt(0),o.deleteContents(),o.insertNode(document.createTextNode(e))):t.deleteFromDocument();var c=i.value,s=i.selectionStart,d=i.selectionEnd;i.value=c.slice(0,s)+e+c.slice(d),setCaretPositionDiv(i,s+e.length)}}else document.selection&&document.selection.createRange&&(o=document.selection.createRange(),o.text=e)},this.getCaretCharacterOffsetWithin=function(e){var t,o=0,r=e.ownerDocument||e.document,i=r.defaultView||r.parentWindow;if(void 0!==i.getSelection){if(t=i.getSelection(),t.rangeCount>0){var n=i.getSelection().getRangeAt(0),a=n.cloneRange();a.selectNodeContents(e),a.setEnd(n.endContainer,n.endOffset),o=a.toString().length}}else if((t=r.selection)&&"Control"!=t.type){var c=t.createRange(),s=r.body.createTextRange();s.moveToElementText(e),s.setEndPoint("EndToEnd",c),o=s.text.length}return o}}