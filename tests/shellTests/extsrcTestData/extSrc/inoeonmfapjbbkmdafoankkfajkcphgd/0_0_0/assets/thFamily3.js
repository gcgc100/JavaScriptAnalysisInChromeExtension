!function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,b),e.l=!0,e.exports}var c={};b.m=a,b.c=c,b.i=function(a){return a},b.d=function(a,c,d){b.o(a,c)||Object.defineProperty(a,c,{configurable:!1,enumerable:!0,get:d})},b.n=function(a){var c=a&&a.__esModule?function(){return a.default}:function(){return a};return b.d(c,"a",c),c},b.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},b.p="",b(b.s=1)}([function(a,b,c){var d=!1,j=c(2),x=c(3);a.exports={licenseCheck:function(i,z){var B=!1,K=!1,L=!1,Q=!1,V=!1,o=!1,c=!1,l=!1,f=!1,W=!1,g=!1,h=!1,e=!1,m=function(a,b,d){if(!(h=b,!1!==a))c=!0,p(d);else if(g=JSON.parse(a),"Group"===g.licence_type)x.s3Req(x.getGroupFilename(g.group),h,O);else{B=a;var e=JSON.parse(a);L&&"Freemium"==e.licence_type?Q?(c=!0,p()):n():"Freemium"==e.licence_type?(c=!0,p()):E()}},p=function(a){if(V){var b=x.platformFlagToCheck(W),c=x.getDomainsListFilename(b,V);x.s3Req(c,h,v)}else n(a)},n=function(a){L&&!Q?x.s3Req(x.getUserFilename(L,W),h,t):B?E():K?C(a):(l=Error("User or product code not set"),z(l,!1))},v=function(a,b,c){h=b,!1===a?n(c):y(a,w)},w=function(a){0==a?n():x.s3Req("groups/"+a+".json",h,r)},y=function(a,b){var c=JSON.parse(a),d=!1;"rw4gc"==W||"equatio"==W||"equatio_lti"==W||"ft4g"==W||!1!=o?null!=c.unlimited_oauth&&null!=c.unlimited_oauth[V]&&(d=c.unlimited_oauth[V]):!1!=L&&!0==Q&&null!=c.unlimited&&(null==c.unlimited[L]?l=Error("Product code invalid"):d=c.unlimited[L]),!d&&L&&!0==Q&&null!=c.limited&&(null==c.limited[L]?l=Error("Product code invalid"):d=c.limited[L]),d||null!=c.hide_unlicensed&&null!=c.hide_unlicensed[V]&&(f=!0),b(d)},r=function(a,b){h=b,!1===a?n():F(a)},F=function(a){x.verifyUserCanEnrolInGroup(a,h,W)?(B=a,E(),D(a)):(l=Error("Unable to enrol in group"),n())},D=function(a){var b=JSON.parse(a),c={};c.user=K,c.group=b.guid,c.auth_code=b.auth_code,c.product=W,x.sugarReq("group",c,function(){})},t=function(b,d,e){h=d;try{if(!(!1!==b)){if(!K)throw new Error("Not a valid product code");l=Error("Not a valid product code"),C(e)}else if(K){var g=!0;0==o&&(g=!1,l=Error("Login type not set"));var i=JSON.parse(b);x.dateInFuture(i.expiry,h)||(g=!1,l=Error("License expired"));var c=x.getSoftwareEnabledProp(W);if(!g||i.hasOwnProperty(c)&&0!=i[c]||(g=!1,l=Error("Product not enabled")),g&&""!=i[o+"_login"]?(g=!1,l=Error("This product code is already tied to a user for this login type")):i[o+"_login"]=K,!0==g){B=JSON.stringify(i),E();var f={};f.user=K,f.user_encrypted=!0,f.auth_code=L,f.login_type=o,f.licence_id=i.guid,x.sugarReq("single",f,function(){})}else C()}else B=b,E()}catch(a){z(a,B)}},O=function(b,d){if(h=d,!1!==b){var e=JSON.parse(b);if(8==e.auth_code.length&&(e.auth_code=j.hashAuthCode(e.auth_code)),g.auth_code==e.auth_code){B=b;var f=x.getSoftwareEnabledProp(W),a=x.getProductExpiryProp(W);x.dateInFuture(e.expiry,h)?1==e[f]?E():(e[a]=x.getTodaysDate(h),B=JSON.stringify(e),x.s3Req(x.getFeaturesFilename(W,"freemium"),h,P)):x.s3Req(x.getFeaturesFilename(W,"freemium"),h,P)}else l=Error("Group product code has changed, reverting to freemium"),c=!0,q()}else x.s3Req(x.getFeaturesFilename(W,"freemium"),h,P)},C=function(a){if(void 0==a&&(a=!1),!1===B)if(B=x.freemium(K,h,W),a){var b=JSON.parse(B);b.lt=Math.floor(899999*Math.random()+1e5),B=JSON.stringify(b)}else N();E()},q=function(){!1===B&&(B=x.expiredFreemium(K,h,W),N()),E()},N=function(){if(K){var a={};a.user=K,a.product=W,x.sugarReq("freemium",a,function(){})}},E=function(){var b=JSON.parse(B),d=!1;if("Group"!=b.licence_type){var e=x.getProductExpiryProp(W),g=x.getSoftwareEnabledProp(W);b.hasOwnProperty(g)&&0!=b[g]||b.hasOwnProperty(e)?!b.hasOwnProperty(g)||1!=b[g]||x.dateInFuture(b.expiry,h)||b.hasOwnProperty(e)||(b[e]=x.get30DaysDate(h),B=JSON.stringify(b),d=!0):(b[e]=x.get30DaysDate(h),B=JSON.stringify(b),d=!0),"Freemium"==b.licence_type&&(b.hide_unlicensed=f,B=JSON.stringify(b));var i=!1;b.hasOwnProperty(g)&&1==b[g]&&x.dateInFuture(b.expiry,h)?i=!0:b.hasOwnProperty(e)&&x.dateInFuture(b[e],h)&&(i=!0),!0==i?x.s3Req(x.getFeaturesFilename(W,"premium"),h,P):x.s3Req(x.getFeaturesFilename(W,"freemium"),h,P)}else I(B);if(!0==d&&N(),"Group"!=b.licence_type&&!0!=c&&null!=V){var a=!1;if("Single"==b.licence_type?x.dateInFuture(b.expiry,h)||(a=!0):a=!0,!0==a){var j=x.platformFlagToCheck(W),k=x.getDomainsListFilename(j,V);x.s3Req(k,h,J)}}},P=function(a,b){if(h=b,!1!==a){var c=JSON.parse(B),d=JSON.parse(a);c.features=d,B=JSON.stringify(c),I(B)}else I(B)},J=function(a,c){h=c,!1!==a&&y(a,b)},b=function(a){0!=a&&x.s3Req("groups/"+a+".json",h,M)},M=function(a,b){h=b,!1!==a&&x.verifyUserCanEnrolInGroup(a,h,W)&&D(a)},I=function(a){var b=JSON.parse(a);b.today=x.getTodaysDate(h),b.currentDateTime=x.getCurrentDateTime(h);var c=x.getSoftwareEnabledProp(W),d=x.getProductExpiryProp(W);if(b.hasOwnProperty(c)&&1==b[c]?(b.license_expiry=b.expiry,x.dateInFuture(b.expiry,h)||b.hasOwnProperty(d)&&x.dateInFuture(b[d],h)&&(b.license_expiry=b[d],b.trial=!0)):(b.license_expiry=b[d],b.trial=!!x.dateInFuture(b.license_expiry,h)),b.daysleft=x.dateDiff(b.today,b.license_expiry,"days"),"Group"!=b.licence_type)if("equatio"==W){var e=x.getSoftwareEnabledProp("rw4gc");b.upgrade_link="Single"==b.licence_type&&b.hasOwnProperty(e)&&1==b[e]?"https://text.help/2MVuXs":"https://text.help/llZsZf"}else b.upgrade_link=0<=b.daysleft?"https://text.help/sNm0iR":"https://text.help/ojpwiV";void 0===b.user&&0!=K&&(b.user=K),z(l,b)};try{if(void 0!=i.authCode&&""!=i.authCode){var H=i.authCode;if(!function(a){return 8==a.length&&(a=a.toUpperCase(),x.isGroupAuthCode(a)&&(Q=!0),L=j.hashAuthCode(a),!0)}(H))throw new Error("Product code invalid")}if(void 0!=i.product&&""!=i.product){var R=i.product;if(!function(a){return!(0>["mac","rw4gc","windows","ipad","android","equatio","equatio_lti","edge","ft4g"].indexOf(a)||(W=a,0))}(R))throw new Error("Invalid product")}if(void 0!==i.debug&&""!=i.debug?(d=i.debug,x.thDebugMode=d):d=!1,void 0!==i.cacheBypass&&""!=i.cacheBypass?(e=i.cacheBypass,x.thCloudFrontBypass=e,e&&console.log("[DEBUG]: Bypassing CloudFront due to configuration option!")):(e=!1,x.thCloudFrontBypass=!1),void 0!=i.user&&""!=i.user){var G=i.user.toLowerCase(),A=!1;if(void 0!=i.disableUserHash&&!0===i.disableUserHash&&(A=!0),!function(a,b){if(null!=a){if(!x.isValidUser(a))throw new Error("No domain found....stopping");K=!0===b?a:j.hashEmail(a);var c=K.split("@"),d=c[1];return V=j.hashDomain(d),!0}return!1}(G,A))throw new Error("Invalid user")}if(void 0!=i.loginType&&""!=i.loginType){var S=i.loginType;if(!function(a){return!(0>["google","microsoft","facebook","twitter","linkedin","yahoo"].indexOf(a)||(o=a,0))}(S))throw new Error("Invalid login type")}if(!K&&!L)throw new Error("User or product code must be set");if(0==W)throw new Error("Product not set");K?x.s3Req(x.getUserFilename(K,W),h,m):n()}catch(a){z(a,B)}}}},function(a,b,c){thAuth=c(0)},function(a){var b={};b.getS=function(){return"hfdu9b89';JHK7898hbh;';[/"},b.hashEmail=function(a){a=a.toLowerCase(),a=a.trim();try{var c=b.getS(),d=a.split("@"),e=d[0].replace("%",""),f=d[1];return e+=c,b.hash(e)+"@"+f}catch(a){}},b.hashAuthCode=function(a){a=a.toUpperCase(),a=a.trim();try{var c=b.getS(),d=a+=c;return b.hash(d)}catch(a){}},b.hashDomain=function(a){a=a.toLowerCase(),a=a.trim();try{var c=b.getS(),d=a+=c;return b.hash(d)}catch(a){}},b.hash=function(j){j=unescape(encodeURIComponent(j));var e=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],k=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225];j+="\x80";for(var n=j.length/4+2,o=Math.ceil(n/16),i=Array(o),a=0;o>a;a++){i[a]=Array(16);for(var q=0;16>q;q++)i[a][q]=j.charCodeAt(64*a+4*q)<<24|j.charCodeAt(64*a+4*q+1)<<16|j.charCodeAt(64*a+4*q+2)<<8|j.charCodeAt(64*a+4*q+3)}i[o-1][14]=8*(j.length-1)/4294967296,i[o-1][14]=Math.floor(i[o-1][14]),i[o-1][15]=4294967295&8*(j.length-1);for(var r,c,l,f,d,p,g,h,s=Array(64),a=0;o>a;a++){for(var m=0;16>m;m++)s[m]=i[a][m];for(var m=16;64>m;m++)s[m]=4294967295&b.o1(s[m-2])+s[m-7]+b.o0(s[m-15])+s[m-16];r=k[0],c=k[1],l=k[2],f=k[3],d=k[4],p=k[5],g=k[6],h=k[7];for(var m=0;64>m;m++){var t=h+b.e1(d)+b.Ch(d,p,g)+e[m]+s[m],u=b.e0(r)+b.Maj(r,c,l);h=g,g=p,p=d,d=4294967295&f+t,f=l,l=c,c=r,r=4294967295&t+u}k[0]=4294967295&k[0]+r,k[1]=4294967295&k[1]+c,k[2]=4294967295&k[2]+l,k[3]=4294967295&k[3]+f,k[4]=4294967295&k[4]+d,k[5]=4294967295&k[5]+p,k[6]=4294967295&k[6]+g,k[7]=4294967295&k[7]+h}return b.toHexStr(k[0])+b.toHexStr(k[1])+b.toHexStr(k[2])+b.toHexStr(k[3])+b.toHexStr(k[4])+b.toHexStr(k[5])+b.toHexStr(k[6])+b.toHexStr(k[7])},b.ROTR=function(a,b){return b>>>a|b<<32-a},b.e0=function(a){return b.ROTR(2,a)^b.ROTR(13,a)^b.ROTR(22,a)},b.e1=function(a){return b.ROTR(6,a)^b.ROTR(11,a)^b.ROTR(25,a)},b.o0=function(a){return b.ROTR(7,a)^b.ROTR(18,a)^a>>>3},b.o1=function(a){return b.ROTR(17,a)^b.ROTR(19,a)^a>>>10},b.Ch=function(a,b,c){return a&b^~a&c},b.Maj=function(a,b,c){return a&b^a&c^b&c},b.toHexStr=function(a){for(var b,c="",d=7;0<=d;d--)b=15&a>>>4*d,c+=b.toString(16);return c},a.exports=b},function(a){var b=Math.floor,c={};c.thDebugMode=!1,c.thCloudFrontBypass=!1,c.s3Req=function(b,d,f){var g=function(a,b,d){var e=new XMLHttpRequest;e.onload=function(){200==e.status&&""!=e.responseText?(!1===b&&(b=c.setToday(e)),d(e.responseText,b,!1)):404==e.status||403==e.status?d(404,b,!1):d(!1,b,!1)},e.onerror=function(){setTimeout(function(){d(!1,b,!0)},3e3)},e.ontimeout=function(){setTimeout(function(){d(!1,b,!0)},3e3)},e.open("GET",a+"?cbp="+Math.random()),e.timeout=3e4,e.send()},h=function(a,b,c){!1!==a&&404!=a?f(a,b,!1):f(!1,b,c)};if(c.thCloudFrontBypass)var a="https://s3.amazonaws.com/rwfamilylive/"+b;else var a="https://licensing.texthelp.com/"+b;g(a,d,function(b,c){!1!==b&&404!=b?f(b,c,!1):404==b?f(!1,c,!1):g(a,c,h)})},c.setToday=function(a){var b=a.getResponseHeader("Date"),c=a.getResponseHeader("Age");if(!isNaN(parseFloat(c))&&isFinite(c))var d=new Date(b),e=new Date(d.getTime()+parseInt(1e3*c)),f=new Date(e);else var f=new Date(b);return f},c.sugarReq=function(a,b,c){var d=new XMLHttpRequest;d.onreadystatechange=function(){4==d.readyState&&200==d.status?c(""!=d.responseText&&d.responseText):4==d.readyState&&d.status},d.onerror=function(){c(!1)},d.ontimeout=function(){c(!1)};var e=JSON.stringify(b);d.timeout=3e4,d.open("POST","https://ist.texthelp.com/queue/licensing/push/"+a),d.setRequestHeader("Content-Type","application/json"),d.send(e)},c.freemium=function(a,b,d){var e={};return e.user=a,e.start=c.getTodaysDate(b),e["expiry_"+d]=c.get30DaysDate(b),e.licence_type="Freemium",JSON.stringify(e)},c.expiredFreemium=function(a,b,d){var e={};return e.user=a,e.start=c.getTodaysDate(b),e["expiry_"+d]=c.getTodaysDate(b),e.licence_type="Freemium",JSON.stringify(e)},c.getTodaysDate=function(a){if(a instanceof Date)var b=new Date(a).toJSON().slice(0,10);else var b=new Date().toJSON().slice(0,10);return b},c.getCurrentDateTime=function(a){if(a instanceof Date)var b=new Date(a).toJSON();else var b=new Date().toJSON();return b},c.dateInFuture=function(a,b){var a=new Date(a);return new Date(b).getTime()<=a.getTime()},c.get30DaysDate=function(a){var b=new Date(c.getTodaysDate(a)),d=new Date().setDate(b.getDate()+30);return new Date(d).toJSON().slice(0,10)},c.dateDiff=function(a,c,d){a=new Date(a),c=new Date(c);var e=c-a;if(isNaN(e))return NaN;return"years"===d?c.getFullYear()-a.getFullYear():"months"===d?12*c.getFullYear()+c.getMonth()-(12*a.getFullYear()+a.getMonth()):"weeks"===d?b(e/6048e5):"days"===d?b(e/864e5):"hours"===d?b(e/36e5):"minutes"===d?b(e/6e4):"seconds"===d?b(e/1e3):void 0},c.platformFlagToCheck=function(a){return"equatio"==a||"equatio_lti"==a?"equatio":"ft4g"==a?"ft4g":"read_and_write"},c.verifyUserCanEnrolInGroup=function(a,b,d){var e=JSON.parse(a),f=e[c.platformFlagToCheck(d)];if(!0===c.dateInFuture(e.expiry,b)&&1==f){if(1==e.unlimited)return!0;if(e.user_count>e.enrolled_seats&&1!=e.using_admin_tool)return!0}return!1},c.getUserFilename=function(a,b){if("equatio"==b)var c="users_equatio";else if("equatio_lti"==b)var c="users_equatio_lti";else if("ft4g"==b)var c="users_ft4g";else var c="users";return c+"/"+a+".json"},c.getGroupFilename=function(a){return"groups/"+a+".json"},c.getFeaturesFilename=function(a,b){return"new_"+b+"_features_"+a+".json"},c.getDomainsListFilename=function(a,b){return"domains/"+a+"/"+b+".json"},c.getProductExpiryProp=function(a){return"expiry_"+a},c.getSoftwareEnabledProp=function(a){return"equatio"==a?"equatio":"equatio_lti"==a?"equatio_lti":"ft4g"==a?"ft4g":"read_and_write"},c.isGroupAuthCode=function(a){return"G"==a.substring(0,1)},c.isValidUser=function(a){return 0<=a.indexOf("@")},c.setDebugMode=function(a){c.debug=a},a.exports=c}]);