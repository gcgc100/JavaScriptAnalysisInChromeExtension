(function(e,t){'object'==typeof exports&&'object'==typeof module?module.exports=t():'function'==typeof define&&define.amd?define([],t):'object'==typeof exports?exports.texthelpcheckit=t():e.texthelpcheckit=t()})('undefined'==typeof self?this:self,function(){return function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e['default']}:function(){return e};return t.d(n,'a',n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p='',t(t.s=5)}([,,,,,function(e,t,n){'use strict';var r=n(6),i=function(e){return e&&e.__esModule?e:{default:e}}(r);window.texthelp=window.texthelp||{},window.texthelp.CheckitLib=window.texthelp.CheckitLib||{},window.texthelp.CheckitLib.gDocs=window.texthelp.CheckitLib.gDocs||{},window.texthelp.CheckitLib.GDocsManager=i.default},function(e,t,n){'use strict';function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var i=n(7),a=r(i),s=n(8),l=r(s),o=n(9),d=r(o);t.default=class{constructor(){this.m_googleOverlaysRuleID=-1,this.m_docsKeyboard=new d.default,this.m_docsParser=new a.default,this.m_mutationObserverDict={},this.m_grammarModel={},this.m_grammarChanges={},this.m_lastGrammarCheck={},this.m_grammarTimerChange=null,this.m_delayedMouseOverTimer=null,this.m_charsRemovedPos=[],this.m_itemsToIgnore={},this.m_itemsToIgnore.ignoredWords=[],this.m_itemsToIgnore.ignoredRules=[],this.m_bulletPointOffset=0,this.m_currentPagesInView=[],this.m_scrolling=!1,this.m_scrollTimer=null,this.m_checkitOn=!1,this._productString='',this.m_clickedWordAnchors=!0,this.m_observerConfig={attributes:!0,childList:!0,characterData:!0,subtree:!0},this.CONTROLCHARS={},this.CONTROLCHARS.ALL=/[\u200B-\u200D\uFEFF]/g,this.CONTROLCHARS.SELECTABLE=/[\u200B-\u200D\uFEFF]/g,this.CONTROLCHARS.NOTSELECTABLE=/[\u25CF]/g,Object.freeze(this.CONTROLCHARS),this._regex_characters_to_remove_start=/^[\$\uFFE5\^\+=`~<>{}\[\]|\u3000-\u303F!-#%-\x2A,-/:;\x3F@\x5B-\x5D_\x7B}\u00A1\u00A7\u00AB\u00B6\u00B7\u00BB\u00BF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061E\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u0AF0\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166D\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E3B\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]+/g,this._regex_characters_to_remove_end=/[\$\uFFE5\^\+=`~<>{}\[\]|\u3000-\u303F!-#%-\x2A,-/:;\x3F@\x5B-\x5D_\x7B}\u00A1\u00A7\u00AB\u00B6\u00B7\u00BB\u00BF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061E\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u0AF0\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166D\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E3B\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]+$/g,this._watchForPageChanges=!0}onStartScrolling(){this.m_scrolling=!0,this._clearAllMutationObservers()}onStopScrolling(){this.m_scrolling=!1,this._addMutationsObserversToVisiblePages()}checkItOn(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:!0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:!0,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:'';if(this.m_checkitOn=!0,this._productString=n,0<n.length){var r=this.clearOtherProductHighlights(n);this.m_docsParser.setDocProductHash(r)}this.m_clickedWordAnchors=t,this._watchForPageChanges=e,null==this._unsub&&void 0!==texthelp.CheckitLib.PubSub&&(this._unsub=texthelp.CheckitLib.PubSub.sub(this._onPubSubEvent.bind(this))),this.m_docsParser.checkItOn(),this.m_docsParser.startTrackingPageVisiblity(this._onPageViewable.bind(this));var i=document.querySelector('.kix-appview-editor');i.addEventListener('scroll',this._onScroll.bind(this)),document.addEventListener('mouseup',this._onMouseUp.bind(this)),document.addEventListener('mousedown',this._onMouseDown.bind(this))}clearOtherProductHighlights(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:'';if(!(1>e.length)){var t=this._toHash(e).toString(),n=this.m_docsParser.getDocProductHash();return t!==n&&(this.clearCachingOnAllPages(),this.clearAllHighlights()),t}}checkItOff(){this.m_checkitOn=!1,this.m_docsParser.checkItOff(),this.m_docsParser.stopTrackingPageVisiblity(),this._clearAllMutationObservers(),this._clearAllPagesInView();var e=document.querySelector('.kix-appview-editor');e.removeEventListener('scroll',this._onScroll.bind(this)),document.removeEventListener('mouseup',this._onMouseUp.bind(this)),document.removeEventListener('mousedown',this._onMouseDown.bind(this)),null==this._unsub||(this._unsub(),this._unsub=null)}getAllDocumentText(){return this.m_docsParser.getAllDocumentText()}changeToSuggestion(e,t){var n=t.checkIt,r=n.closest('.kix-page');if(null!=r){var i=this.m_docsParser.getPageId(r);void 0!==this.m_mutationObserverDict[i]&&this.m_mutationObserverDict[i].disconnect();var a=new RegExp(this.CONTROLCHARS.ALL,'g'),s=this._getTextContentFromElement(n.closest('.kix-lineview')).substring(0,t.lineOffset).split(a).length-1;n.parentElement.removeChild(n),void 0==this.m_lastGrammarCheck[i]&&(this.m_lastGrammarCheck[i]=[]),this.m_lastGrammarCheck[i].length=0,r.querySelectorAll('.th-checkit-overlay-meta').forEach(function(t){this.m_lastGrammarCheck[i].push(JSON.parse(t.getAttribute('th-checkit-meta')))}.bind(this)),this.m_docsKeyboard.caretToStartOfLine(),this.m_docsKeyboard.caretMoveRight(t.lineOffset-s),this.m_docsKeyboard.caretMoveRight(t.length,!0),this.m_docsKeyboard.type=e;var l=this._toHash(r.textContent).toString();this.m_docsParser.setPageHash(i,l);this._recalculateGrammarPositions(r,i);this._updateCheckitErrorsOnPage(this.m_lastGrammarCheck[i].slice(0),r),this.m_docsParser.showTexthelpGrammarErrors(),this._updateGrammarDueToChange(r,i),void 0!==this.m_mutationObserverDict[i]&&this.m_mutationObserverDict[i].observe(r,this.m_observerConfig)}}onCheckItPanelClosed(){this.clearAllHighlights()}getRectOfCurrentCheckItError(){return null==this.m_currentCheckit?void 0:this.m_currentCheckit.getBoundingClientRect()}setItemsToIgnore(e,t){this.m_itemsToIgnore.ignoredWords=e,this.m_itemsToIgnore.ignoredRules=t}setIgnoreGrammarRule(e){0>this.m_itemsToIgnore.ignoredRules.indexOf(e)&&this.m_itemsToIgnore.ignoredRules.push(e)}ignoreCurrentGrammarMistake(){var e=document.querySelector('.th-checkit-overlay-container.th-highlight');if(null!=e){var t=e.querySelector('.th-checkit-overlay-meta');if(null!=t){var n=t.getAttribute('th-checkit-meta');if(null!=n){var r=JSON.parse(n);r.context='',r.sentence='',r.thId='',r.lineOffset='';var i=JSON.stringify(r);return 0>this.m_itemsToIgnore.ignoredRules.indexOf(i)&&(this.m_itemsToIgnore.ignoredRules.push(i),e.classList.add('th-checkit-ignore')),r}}}}ignoreAllSpellingMistake(){var e=document.querySelector('.th-checkit-overlay-container.th-highlight');if(null!=e){var t=e.querySelector('.th-checkit-overlay-meta');if(null!=t){var n=t.getAttribute('th-checkit-meta');if(null!=n){var r=JSON.parse(n);if(null!=r.word){var i=this.trimPuncOffStartAndEndOfString(r.word);return this._updateDomWithIgnoredWord(i),i}}}}}getDocumentScale(){var e=document.querySelector('.kix-zoomdocumentplugin-inner'),t=1;return 0<e.style.transform.length&&(t=parseFloat(e.style.transform.substr(6,e.style.transform.length-7))),t}_updateDomWithIgnoredWord(e){var t=[].slice.call(document.querySelectorAll('.th-checkit-word-'+this._toHash(e).toString()));t.forEach((e)=>{e.classList.add('th-checkit-ignore')})}clearAllHighlights(){var e=Array.prototype.slice.call(document.querySelectorAll('.th-highlight'));e.forEach(function(e){e.classList.remove('th-highlight')})}trimPuncOffStartAndEndOfString(e){return e.replace(this._regex_characters_to_remove_start,'').replace(this._regex_characters_to_remove_end,'')}clearCachingOnAllPages(){var e=document.querySelectorAll('.kix-page[thpiddh_]');e.forEach((e)=>{e.setAttribute('thpiddh_','')})}reCheckPages(){for(var e in this.clearCachingOnAllPages(),this.m_currentPagesInView)if(this.m_currentPagesInView.hasOwnProperty(e)){var t=this.m_currentPagesInView[e],n=this.m_docsParser.getPageHash(t.pageElem);this._doCheckit(t.pageElem,t.pageId,n)}}_onScroll(){this.m_scrolling||this.onStartScrolling(),null!==this.m_scrollTimer&&clearTimeout(this.m_scrollTimer),this.m_scrollTimer=setTimeout(this.onStopScrolling.bind(this),150)}_onMouseDown(e){try{if(0!==e.button)return void(void 0!==texthelp.CheckitLib.PubSub&&texthelp.CheckitLib.PubSub.pub('TPSCloseCheckit',null));clearTimeout(this.m_delayedMouseOverTimer);var t=this._getElemsWithClassFromPoint('th-checkit-overlay-error',e.x,e.y);if(1>t.length)return;texthelp.CheckitLib.PubSub!==void 0&&texthelp.CheckitLib.PubSub.pub('TPSMouseDownCheckit',t[0])}catch(e){console.log(e)}}_onMouseUp(e){try{if(!this.m_checkitOn)return;if(clearTimeout(this.m_delayedMouseOverTimer),null==e.target.closest('.th-checkit-overlay-container')&&null==e.target.closest('.checkit-panel')&&null==e.target.closest('.gdwr-modal-dialog')&&void 0!==texthelp.CheckitLib.PubSub&&texthelp.CheckitLib.PubSub.pub('TPSCloseCheckit',e),!this.m_clickedWordAnchors)return;var t={x:e.x,y:e.y},n=null,r=this._getElemsWithClassFromPoint('th-checkit-overlay-clickedon',t.x,t.y);if(0==r.length){if(r=this._getElemsWithClassFromPoint('kix-wordhtmlgenerator-word-node',t.x,t.y),0==r.length)return;if(0==r[0].length)return;var i=r[0].innerHTML,a=r[0].closest('.kix-lineview'),s=this._getTextContentFromElement(r[0]).replace(/\u000A/g,' ').split(' '),l=r[0].closest('.kix-wordhtmlgenerator-word-node'),o=0;if(null!==a){var d=Array.prototype.slice.call(a.querySelectorAll('.kix-wordhtmlgenerator-word-node'));d.some((e)=>e==l||void(o+=this._getTextContentFromElement(e).length))}var h='',g=0,c=0;s.forEach((e)=>{if(0==e.length)g++;else{var t=c+o;if(0<g){var n=Array(g+1).join(' ');h+='<th-space-clickon-checkit th-linePos="'+t+'">'+n+'</th-space-clickon-checkit>',c+=n.length,t+=n.length}h+='<th-word-clickon-checkit th-linePos="'+t+'">'+e+'</th-word-clickon-checkit>',c+=e.length,t+=e.length,g=1}}),h=h.substring(0,h.length-1),r[0].innerHTML=h;var f=document.elementsFromPoint(t.x,t.y);if(f=f.filter((e)=>'TH-WORD-CLICKON-CHECKIT'==e.nodeName||'TH-SPACE-CLICKON-CHECKIT'==e.nodeName),0<f.length){if(0==f.length)return;var m=parseInt(f[0].getAttribute('th-linepos')),u=f[0].innerText.trim().length,_=f[0].innerText.trim();0==u&&(u=f[0].innerText.length,_=f[0].innerText);var p=m+u,b=f[0].closest('.kix-lineview');r[0].innerHTML=i;var P=this._setSelectionRange(b,m,p),v=[],E={};E.word=_,E.lineOffset=m,E.length=p-m,E.thId=this._uuidv4();var x='th-checkit-overlay-clickedon-anchor';0<this._productString.length&&(x+=' th-checkit-overlay-container--'+this._productString),v.push(P),n=this._addRectangleOverlaysToDom(v,b,'th-checkit-overlay-container th-checkit-overlay-clickedon',x,'',2,null,E),n.setAttribute('th-text',_)}}else n=r[0];var C={};C.anchor=n.firstChild,C.text=n.getAttribute('th-text'),void 0!==texthelp.CheckitLib.PubSub&&texthelp.CheckitLib.PubSub.pub('TPSOnClicked',C)}catch(e){console.log(e)}}_onPubSubEvent(e,t){try{this['_on'+e]!==void 0&&this['_on'+e](t)}catch(e){console.log(e)}}_onTPSOnCheckit(e){if(null!=e||null!=this._lastRepsonse){null==e?e=this._lastRepsonse:this._lastRepsonse=e,e.payload.matches=e.payload.matches.filter((e)=>'WHITESPACE_RULE'!==e.rule.id),this._augmentMatchResultsWithSpecialCharsOffsets(e.payload.matches,e.textDetails);var t={};t.prevMatches=[],t.matches=[],t.nextMatches=[],t.metaData={},t.metaData.prevParaOffsetInPage=e.metaData.prevParaOffsetInPage,t.metaData.nextParaEndInPage=e.metaData.nextParaEndInPage,0<e.metaData.next&&(t.metaData.nextLength=e.textDetails.textContent.length-e.metaData.next),e.payload.matches.map((n)=>{n.offset<=e.metaData.prev&&0<e.metaData.prev?t.prevMatches.push(n):n.offset>e.metaData.next&&0<e.metaData.next?(n.offset-=e.metaData.next,n.rangeOffset-=e.metaData.next,t.nextMatches.push(n)):(n.offset-=e.metaData.prev,n.rangeOffset-=e.metaData.prev,t.matches.push(n))});var n=this.m_docsParser.getPageFromId(e.id);this.m_docsParser.removeTexthelpGrammarErrors(n),this.m_docsParser.setPageHash(e.id,e.hash),this._addPageToGrammarModel(n,e.id),this._onCheckIt(t,n)}}_getScreenCordinates(e){for(var t={x:e.offsetLeft,y:e.offsetTop};e.offsetParent&&(t.x+=e.offsetParent.offsetLeft,t.y+=e.offsetParent.offsetTop,e!=document.getElementsByTagName('body')[0]);)e=e.offsetParent;return t}_onPageMutation(e){try{var t=null,n='',r=!1;if(e.forEach(function(e){if('childList'==e.type&&e.target.classList.contains('kix-lineview-content')){null!==this.m_grammarTimerChange&&(clearTimeout(this.m_grammarTimerChange),this.m_grammarTimerChange=null),t=e.target.closest('.kix-page'),n=this.m_docsParser.getPageId(t),r=!0;var i=[],a=e.target.closest('.kix-lineview');if(1<e.removedNodes.length&&1<e.addedNodes.length){var s=this._getTextContentFromElement(e.removedNodes[1]),o=this._getTextContentFromElement(e.addedNodes[1]),d=l.default.diff(s,o),h='';this.m_bulletPointOffset=0,d.forEach(function(e){if(-1==e[0]){var t=h.length,n=h.length+1,r=this._setSelectionRange(a,t,n);i=i.concat(Array.prototype.slice.call(r.getClientRects(),0))}else if(1==e[0]){var s=h.length,l=h.length+e[1].length,o=this._setSelectionRange(a,s,l);i=i.concat(Array.prototype.slice.call(o.getClientRects(),0)),h+=e[1]}else h+=e[1]}.bind(this))}var g=a.querySelectorAll('.th-checkit-overlay-container');g.forEach(function(e){var t=e.getBoundingClientRect();i.forEach(function(r){if(this._intersectRect(t,r)){var i=e.firstElementChild.getAttribute('th-checkit-meta');this.m_lastGrammarCheck[n]=this.m_lastGrammarCheck[n].filter(function(e){return null!==i&&null!==e&&e.thId!==JSON.parse(i).thId}.bind(this)),null!==e&&null!==e.parentElement&&e.parentElement.removeChild(e)}}.bind(this))}.bind(this))}}.bind(this)),!r)return;var i=document.querySelector('#checkit-panel-wrapper');null!==i&&i.parentElement.removeChild(i),n=this.m_docsParser.getPageId(t);this._recalculateGrammarPositions(t,n);this.m_docsParser.removeTexthelpGrammarErrors(t),this._updateCheckitErrorsOnPage(this.m_lastGrammarCheck[n].slice(0),t),this.m_docsParser.showTexthelpGrammarErrors(),this._addPageToGrammarModel(t,n),this.m_grammarTimerChange=setTimeout(function(){this._updateGrammarDueToChange(t,n)}.bind(this),1e3)}catch(e){console.log(e)}}_intersectRect(e,t){return!(t.left>e.right||t.right<e.left||t.top>e.bottom||t.bottom<e.top)}_updateGrammarDueToChange(e,t){var n=this._toHash(e.textContent).toString();this._doCheckit(e,t,n)}_clearAllMutationObservers(){if(this._watchForPageChanges)for(var e in this.m_mutationObserverDict)this.m_mutationObserverDict.hasOwnProperty(e)&&(this.m_mutationObserverDict[e].disconnect(),delete this.m_mutationObserverDict[e])}_clearAllPagesInView(){for(var e in this.m_currentPagesInView)this.m_currentPagesInView.hasOwnProperty(e)&&delete this.m_currentPagesInView[e]}_addMutationsObserversToVisiblePages(){if(this._watchForPageChanges)for(var e in this.m_currentPagesInView)if(this.m_currentPagesInView.hasOwnProperty(e)){var t=this.m_currentPagesInView[e];this._addMutationObserverToPage(t.pageElem,t.pageId,!0)}}_doesPageNeedToBeReChecked(e){var t=this._toHash(e.textContent).toString(),n=this.m_docsParser.getPageHash(pageElem);return t!=n}_addMutationObserverToPage(e,t){var n=this.m_docsParser.getPageHash(e);if(!this._watchForPageChanges)return void this._doCheckit(e,t,n);if(null==this.m_mutationObserverDict[t]||void 0==this.m_mutationObserverDict[t]){var r=new MutationObserver(this._onPageMutation.bind(this));r.observe(e,this.m_observerConfig),this.m_mutationObserverDict[t]=r}var i=this._toHash(e.textContent).toString();i!=n&&(this.m_docsParser.removeTexthelpGrammarErrors(e),this._doCheckit(e,t,i),!this._watchForPageChanges)}_doCheckit(e,t,n){try{var r=this._getStringWithoutSpecialCharsFromElement(e),i=this._getPrevPageLastParaDetails(e),a=this._getNextPageFirstParaDetails(e),s=JSON.parse(JSON.stringify(r)),l=0,o=0,d=-1;null!==i&&i!==void 0&&(l+=i.textContent.length,s.charsRemovedPos=s.charsRemovedPos.map((e)=>e+=l),s.charsRemovedAndNotSelectablePos=s.charsRemovedAndNotSelectablePos.map((e)=>e+=l),s.charsRemovedPos=i.charsRemovedPos.concat(s.charsRemovedPos),s.charsRemovedAndNotSelectablePos=i.charsRemovedAndNotSelectablePos.concat(s.charsRemovedAndNotSelectablePos),s.textContent=i.textContent.substr(0,i.textContent.length-1)+' '+s.textContent,s.textWithoutSpecialChars=i.textWithoutSpecialChars.substr(0,i.textWithoutSpecialChars.length-1)+' '+s.textWithoutSpecialChars,o=i.prevParaPageOffset);var h=0;null!==a&&a!==void 0&&(h=l+s.textContent.length,a.charsRemovedPos.map((e)=>s.charsRemovedPos.push(e+h)),a.charsRemovedAndNotSelectablePos.map((e)=>s.charsRemovedAndNotSelectablePos.push(e+h)),s.textContent=s.textContent.substr(0,s.textContent.length-1)+' '+a.textContent,s.textWithoutSpecialChars=s.textWithoutSpecialChars.substr(0,s.textWithoutSpecialChars.length-1)+' '+a.textWithoutSpecialChars,d=a.nextParaPageOffset);var g={prevParaOffsetInPage:o,nextParaEndInPage:d,next:h,prev:l},c=[];c.push(s),c.push(t),c.push(n),c.push(g),texthelp.CheckitLib.PubSub!==void 0&&texthelp.CheckitLib.PubSub.pub('TPSDoCheckit',c)}catch(e){console.log(e)}}_removeMutationObserverFromPage(e){this._watchForPageChanges&&(null===this.m_mutationObserverDict[e]||this.m_mutationObserverDict[e]===void 0||(this.m_mutationObserverDict[e].disconnect(),delete this.m_mutationObserverDict[e]))}_onPageViewable(e,t){if(t){var n=this.m_docsParser.setPageId(e.target,this._uuidv4());if(0==n.length)return;if(this.m_currentPagesInView.push({pageId:n,pageElem:e.target}),!this.m_scrolling)return void this._addMutationObserverToPage(e.target,n)}else{var r=this.m_docsParser.getPageId(e.target);if(0==r.length)return;this.m_currentPagesInView=this.m_currentPagesInView.filter((e)=>e.pageId!==r),this.m_scrolling||this._removeMutationObserverFromPage(r)}}_getStringSpecialChars(e){var t=e.split(this.CONTROLCHARS.ALL),n=e.replace(this.CONTROLCHARS.ALL,''),r=[],i=0;t.forEach(function(e){i+=e.length,r.push(i)}.bind(this));return{textWithoutSpecialChars:n,charsRemovedPos:r}}_getStringWithoutSpecialCharsFromElement(e){var t=this._getTextContentFromElement(e),n=t.split(this.CONTROLCHARS.ALL),r=t.replace(this.CONTROLCHARS.ALL,''),i=l.default.diff(r,t),a=[],s=0;i.forEach(function(e){0>e[0]&&a.push(s),s+=e[1].length}.bind(this));var o=[],d=0;n.forEach(function(e){d+=e.length,o.push(d)}.bind(this)),o.pop();var h={};return h.textWithoutSpecialChars=r,h.charsRemovedPos=o,h.charsRemovedAndNotSelectablePos=a,h.textContent=t,h}_augmentMatchResultsWithSpecialCharsOffsets(e,t){var n=0,r=0;e.forEach(function(e){if(1>t.charsRemovedPos.length)e.rangeOffset=e.offset+n;else if(t.charsRemovedPos[t.charsRemovedPos.length-1]<e.offset)e.rangeOffset=e.offset+t.charsRemovedPos.length;else for(var a=r;a<t.charsRemovedPos.length;a++)if(e.offset>t.charsRemovedPos[a]&&(r++,n++),e.offset<=t.charsRemovedPos[a]){e.rangeOffset=e.offset+n,a=t.charsRemovedPos.length;break}}.bind(this))}_addPageToGrammarModel(e,t){this.m_grammarModel[t]=this._getTextContentFromElement(e)}_onCheckIt(e,t){try{if(null==t)return;var n=this.m_docsParser.getPageId(t);if(this.m_lastGrammarCheck[n]=JSON.parse(JSON.stringify(e.matches)),this._updateCheckitErrorsOnPage(this.m_lastGrammarCheck[n].slice(0),t),null!==t.previousElementSibling&&0<e.metaData.prevParaOffsetInPage){var r=this.m_docsParser.getPageId(t.previousElementSibling);void 0!==this.m_lastGrammarCheck[r]&&(this.m_lastGrammarCheck[r]=this.m_lastGrammarCheck[r].filter((t)=>!(t.offset>=e.metaData.prevParaOffsetInPage)),e.prevMatches.map((t)=>{t.offset+=e.metaData.prevParaOffsetInPage,t.rangeOffset+=e.metaData.prevParaOffsetInPage}),this.m_lastGrammarCheck[r]=this.m_lastGrammarCheck[r].concat(e.prevMatches),this.m_docsParser.removeTexthelpGrammarErrors(t.previousElementSibling),this._updateCheckitErrorsOnPage(this.m_lastGrammarCheck[r].slice(0),t.previousElementSibling))}if(null!==t.nextElementSibling&&-1<e.metaData.nextParaEndInPage){var i=this.m_docsParser.getPageId(t.nextElementSibling);void 0!==this.m_lastGrammarCheck[i]&&(this.m_lastGrammarCheck[i]=this.m_lastGrammarCheck[i].filter((t)=>!(t.offset<e.metaData.nextParaEndInPage)),this.m_lastGrammarCheck[i]=e.nextMatches.concat(this.m_lastGrammarCheck[i]),this.m_docsParser.removeTexthelpGrammarErrors(t.nextElementSibling),this._updateCheckitErrorsOnPage(this.m_lastGrammarCheck[i].slice(0),t.nextElementSibling))}}catch(e){console.log(e)}}_updateCheckitErrorsOnPage(e,t){try{var n=this.m_docsParser.getLineElemsOnPage(t),r=0,i=-1,a=document.createRange();this.m_bulletPointOffset=0;for(var s=0;s<n.length&&!(0==e.length);s++)for(r=i+1,i=r+this._getTextContentFromElement(n[s]).length-1;e[0].rangeOffset<=i;){var l=e[0].word,o=e[0],d=[];o.context='',o.sentence='',o.thId='',o.lineOffset='';var h=JSON.stringify(o);if(void 0==l&&(l=''),0>this.m_itemsToIgnore.ignoredRules.indexOf(h)){var g=this._getNumOfHiddenChars(n[s],e[0]),c=this._getTextContentFromElement(n[s]),f=n[s].textContent.length-c.length,m=e[0].rangeOffset-r+f,u=e[0].rangeOffset-r+e[0].length+g+f,_=u,p=null;u>c.length&&(u=c.length),p=this._setSelectionRange(n[s],m,u),d.push(p),e[0].lineOffset=e[0].rangeOffset-r,e[0].thId=this._uuidv4();var b='';-1<['TYPOS','TYPOGRAPHY','NONSTANDARD_PHRASES'].indexOf(e[0].rule.category.id)?b=' th-cat-misspelling':-1<['GRAMMAR','COLLOCATIONS','SEMANTICS','CONFUSED_WORDS'].indexOf(e[0].rule.category.id)?b=' th-cat-grammar':-1<['PUNCTUATION'].indexOf(e[0].rule.category.id)?b=' th-cat-punctuation':-1<['REDUNDANCY','STYLE','PLAIN_ENGLISH'].indexOf(e[0].rule.category.id)&&(b=' th-cat-style');var P='th-checkit-overlay-container th-checkit-overlay-meta th-checkit-overlay-error';-1<this.m_itemsToIgnore.ignoredWords.indexOf(this.trimPuncOffStartAndEndOfString(l))&&(P='th-checkit-overlay-container th-checkit-overlay-meta th-checkit-overlay-error th-checkit-ignore'),P+=b;var v='th-checkit-overlay-underline';0<this._productString.length&&(v+=' th-checkit-overlay-container--'+this._productString),this._addRectangleOverlaysToDom(d,n[s],P,v,'<div class="th-checkit-overlay-meta"></div>',2,e[0])}if(e.shift(),0==e.length)break}}catch(e){console.log(e)}}_getElemsWithClassFromPoint(e,t,n){var r=document.elementsFromPoint(t,n);return r=r.filter((t)=>t.classList.contains(e)),0<r.length?r:[]}_getNumOfHiddenChars(e,t){for(var n=this._getTextContentFromElement(e),r=this._getStringWithoutSpecialCharsFromElement(e),a=t.offset+t.length,s=0,l=0;l<r.charsRemovedPos.length;l++)r.charsRemovedPos[l]>t.offset&&(r.charsRemovedPos[l]<t.offset+t.length?s++:l=r.charsRemovedPos.length);return s}_reversScaleRectangle(e,t){return 1==e?t:(t.x=parseFloat(t.x*(1/e)).toFixed(5),t.y=parseFloat(t.y*(1/e)).toFixed(5),t.width=parseFloat(t.width*(1/e)).toFixed(5),t.height=parseFloat(t.height*(1/e)).toFixed(5),t)}_addRectangleOverlaysToDom(e,t,n,r,a,s){var l=6<arguments.length&&arguments[6]!==void 0?arguments[6]:null,o=7<arguments.length&&arguments[7]!==void 0?arguments[7]:null,d=this.getDocumentScale(),h=null;h=this._reversScaleRectangle(d,t.getBoundingClientRect());for(var g,c=null,f=0;f<e.length;f++){g=e[f].getClientRects();for(var m=0;m<g.length;m++){var i=this._reversScaleRectangle(d,g[m]),u=i.x-h.x,_=i.y-h.y,p=i.x+i.width-i.x,b='style="top: '+(_-s)+'px; left: '+(u-s)+'px; width: '+(p+2*s)+'px; height: '+(i.height+s)+'px;"',P=document.createElement('span');P.innerHTML='<div class="'+n+' kix-htmloverlay docs-ui-unprintable" '+b+('>'+a+'<div class="'+r+'"></div></div>');var v=JSON.stringify(o);P.firstChild.firstChild!==void 0&&null!==l?P.firstChild.firstChild.setAttribute('th-checkit-meta',JSON.stringify(l)):P.firstChild.firstChild!==void 0&&null!==o&&P.firstChild.firstChild.setAttribute('th-checkit-meta',v),P.firstChild.style.opacity='1',null!==l&&(l.word===void 0?l.rule!==void 0&&l.rule.id!==void 0&&P.firstChild.classList.add('th-checkit-word-'+this._toHash(l.rule.id).toString()):P.firstChild.classList.add('th-checkit-word-'+this._toHash(this.trimPuncOffStartAndEndOfString(l.word)).toString())),null==c&&(c=P.firstChild),t.appendChild(P.firstChild)}}return c}_recalculateGrammarPositions(e,t){if(null!=e){for(var n=/[\u200B-\u200D\uFEFF]/g,r=this.m_grammarModel[t],a=this._getTextContentFromElement(e),s=l.default.diff(r,a),o=[],d=0,h=0,g=0,c=0,f=!1,m=0;m<s.length;m++){switch(s[m][0]){case 1:h+=s[m][1].length,d+=s[m][1].length,c+=s[m][1].replace(n,'').length,g+=s[m][1].replace(n,'').length,0<s[m][1].trim().length&&(f=!0);break;case-1:h-=s[m][1].length,d-=s[m][1].length,c-=s[m][1].replace(n,'').length,g-=s[m][1].replace(n,'').length,0<s[m][1].trim().length&&(f=!0);break;default:h+=s[m][1].length,c+=s[m][1].replace(n,'').length;}s[m][2]=h,s[m][3]=d,s[m][4]=c,s[m][5]=g}var i=0;for(m=0;m<s.length;m++){var u=this.m_lastGrammarCheck[t][i];if(void 0==u)break;for(;u.rangeOffset<=s[m][2];)if(u.rangeOffset+=s[m][3],u.offset+=s[m][5],i++,o.push(u),u=this.m_lastGrammarCheck[t][i],i>=this.m_lastGrammarCheck[t].length){m=s.length;break}}return this.m_lastGrammarCheck[t]=o,f}}_uuidv4(){return'10000000-1000-4000-8000-100000000000'.replace(/[018]/g,(e)=>(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16))}_toHash(e){return e.split('').reduce(function(e,t){return e=(e<<5)-e+t.charCodeAt(0),e&e},0)}_getTextNodesIn(e){var t=[];if(3==e.nodeType)t.push(e);else for(var n=e.childNodes,r=0,i=n.length;r<i;++r)t.push.apply(t,this._getTextNodesIn(n[r]));return t}_setSelectionRange(e,t,n){var r=document.createRange();r.selectNodeContents(e);for(var a,s,l=this._getTextNodesIn(e),o=!1,d=0,h=0;s=l[h++];){if(a=d+s.length,!o&&t>=d&&(t<a||t==a&&h<=l.length)&&(r.setStart(s,t-d+this.m_bulletPointOffset),o=!0),o&&n<=a){r.setEnd(s,n-d+this.m_bulletPointOffset);break}d=a}return r}_getTextContentFromElement(e){if(null==e)return'';var t=[];e.classList.contains('kix-wordhtmlgenerator-word-node')?t.push(e):(t=Array.prototype.slice.call(e.querySelectorAll('.kix-lineview-text-block')),t=t.filter((e)=>{var t=e.querySelector('.kix-wordhtmlgenerator-word-node');return null!=t}));var n='';return t.forEach(function(e){null!==e.querySelector('.kix-embeddedobject-view')||(e.previousElementSibling&&null!==e.previousElementSibling.querySelector('.kix-wordhtmlgenerator-word-node')&&(n+=' '),n+=e.textContent,'\xA0'==n.slice(-1)&&null!==e.closest('.kix-lineview')&&null==e.closest('.kix-lineview').nextSibling&&(n=n.substr(0,n.length-1)+'\n'))}.bind(this)),n}_getPrevPageLastParaDetails(e){if(null==e.previousElementSibling)return null;var t=e.previousElementSibling.querySelector('.kix-paragraphrenderer:last-child');if(null==t)return null;if(0==t.textContent.trim().length)return null;var n=e.querySelector('.kix-paragraphrenderer:first-child');if(null==n)return null;if(t.offsetTop+t.offsetHeight>t.parentElement.offsetHeight-5&&n.offsetTop==n.parentElement.offsetTop){var r=this._getStringWithoutSpecialCharsFromElement(t);return r.prevParaPageOffset=e.previousElementSibling.textContent.length-t.textContent.length,r}return null}_getNextPageFirstParaDetails(e){if(null==e.nextElementSibling)return null;var t=e.nextElementSibling.querySelector('.kix-paragraphrenderer:first-child');if(null==t)return null;if(0==t.textContent.trim().length)return null;var n=e.querySelector('.kix-paragraphrenderer:last-child');if(null==n)return null;if(t.offsetTop==t.parentElement.offsetTop&&n.offsetTop+n.offsetHeight>n.parentElement.offsetHeight-5){var r=this._getStringWithoutSpecialCharsFromElement(t);return r.nextParaPageOffset=t.textContent.length,r}}_fireClickEventInMiddleOfDocElement(e){var t=e.getBoundingClientRect(),n=e.closest('.kix-appview-editor'),r=e.closest('.kix-page'),i=this._getScreenCordinates(e),a=new MouseEvent('mousedown',{bubbles:!0,cancelable:!0,clientX:i.x-n.scrollLeft+t.width/2,clientY:i.y-n.scrollTop+t.height/2,view:window});r.dispatchEvent(a),a=new MouseEvent('mouseup',{bubbles:!0,cancelable:!0,clientX:i.x-n.scrollLeft+t.width/2,clientY:i.y-n.scrollTop+t.height/2,view:window}),r.dispatchEvent(a)}}},function(e,t){'use strict';Object.defineProperty(t,'__esModule',{value:!0});t.default=class{constructor(){this.m_pageIntersectionObserver=null,this.m_observedPages=[],this.m_googleOverlaysRuleID=-1,this.m_newPageObserver=null;var e=document.createElement('style');e.appendChild(document.createTextNode('')),document.head.appendChild(e),this.m_sheet=e.sheet}_get_arr1_not_arr2(e,t){return e.filter((e)=>!t.includes(e))}_onPageAddedToDocument(){var e=Array.prototype.slice.call(document.querySelectorAll('.kix-page')),t=this._get_arr1_not_arr2(e,this.m_observedPages);t.forEach((e)=>{this.m_pageIntersectionObserver.observe(e),this.m_observedPages.push(e)});var n=this._get_arr1_not_arr2(this.m_observedPages,e);n.forEach((e)=>{this.m_pageIntersectionObserver.unobserve(e),this.m_observedPages=this.m_observedPages.filter((t)=>t!==e)})}checkItOn(){try{if(this.m_googleOverlaysRuleID=this.m_sheet.insertRule('.kix-spelling-error-overlay-container.kix-htmloverlay.docs-ui-unprintable {display: none;}',0),this.showTexthelpGrammarErrors(),null==this.m_newPageObserver){var e=document.querySelector('.kix-paginateddocumentplugin-background');null!==e&&(this.m_newPageObserver=new MutationObserver(this._onPageAddedToDocument.bind(this)),this.m_newPageObserver.observe(e,{attributes:!0}))}}catch(e){}}checkItOff(){null!==this.m_googleOverlaysRuleID&&-1!==this.m_googleOverlaysRuleID&&(this.m_sheet.deleteRule(this.m_googleOverlaysRuleID),this.m_googleOverlaysRuleID=-1),this.hideTexthelpGrammarErrors(),null!==this.m_newPageObserver&&(this.m_newPageObserver.disconnect(),this.m_newPageObserver=null)}getAllDocumentText(){var e=0<arguments.length&&arguments[0]!==void 0?arguments[0]:2e3,t=[];return fetch(window.location.href.toString(),{method:'GET',credentials:'same-origin'}).then(function(e){return e.text()}.bind(this)).then(function(n){var r=document.createElement('div');r.id='th-page-reloaded',r.style.display='none',r.innerHTML=n;var i=Array.prototype.slice.call(r.querySelectorAll('script')),a=i.filter((e)=>'DOCS_modelChunk = ['==e.innerHTML.substr(0,19));return a.forEach(function(n){var r=n.innerHTML.replace('DOCS_modelChunk = ',''),i=r.lastIndexOf('}]; ');r=r.substr(0,i+2);var a=JSON.parse(r);t=t.concat(this._textContentToWordChucks(a[0].s.replace(/[\x1C]/g,' ').replace(/[\x12\x10\x11]/g,''),e))}.bind(this)),t}.bind(this))}startTrackingPageVisiblity(e){if(null===this.m_pageIntersectionObserver){var t=document.querySelector('.kix-appview-editor');this.m_pageIntersectionObserver=new IntersectionObserver((t)=>{t.forEach((t)=>0<t.intersectionRatio?void e(t,!0):void e(t,!1))},{root:t});var n=Array.prototype.slice.call(document.querySelectorAll('.kix-page'));n.forEach((e)=>{this.m_pageIntersectionObserver.observe(e),this.m_observedPages.push(e)})}}stopTrackingPageVisiblity(){if(null!=this.m_pageIntersectionObserver){var e=Array.prototype.slice.call(document.querySelectorAll('.kix-page'));e.forEach((e)=>{this.m_pageIntersectionObserver.unobserve(e)}),this.m_observedPages.length=0,this.m_pageIntersectionObserver=null}}getPageFromId(e){return document.querySelector('.kix-page[thpidd_="'+e+'"]')}setPageId(e,t){if(null==e)return'';var n=e.getAttribute('thpidd_');return null==n?(e.setAttribute('thpidd_',t),t):n}getPageId(e){if(null==e)return'';var t=e.getAttribute('thpidd_');return null==t?'':t}setDocProductHash(e){var t=document.querySelector('.kix-paginateddocumentplugin-background');return null==t?null:void t.setAttribute('thdpdh_',e)}getDocProductHash(){var e=document.querySelector('.kix-paginateddocumentplugin-background');if(null==e)return null;var t=e.getAttribute('thdpdh_');return null==t?'':t}setPageHash(e,t){var n=document.querySelector('.kix-page[thpidd_="'+e+'"]');return null==n?null:(n.setAttribute('thpiddh_',t),n)}getPageHash(e){if(null==e)return'';var t=e.getAttribute('thpiddh_');return null==t?'':t}getLineElemsOnPage(e){return e.querySelectorAll('.kix-lineview')}showTexthelpGrammarErrors(){document.querySelectorAll('.th-checkit-overlay-container').forEach(function(t){t.style.display=''})}hideTexthelpGrammarErrors(){document.querySelectorAll('.th-checkit-overlay-container').forEach(function(t){t.style.display='none'})}removeTexthelpGrammarErrors(e){null==e||e.querySelectorAll('.th-checkit-overlay-container').forEach(function(t){t.remove()})}_textContentToWordChucks(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:2e3,n=[],r=e.split(/(\s+)/),i=r.map(function(n,e){return 0==e%t&&r.slice(e,e+t)}).filter(function(t){return t});return i.forEach((e)=>{n.push(e.join(''))}),n}}},function(e,t){'use strict';Object.defineProperty(t,'__esModule',{value:!0});t.default=class{static diff(e,t){function n(){this.Diff_Timeout=1,this.Diff_EditCost=4,this.Match_Threshold=.5,this.Match_Distance=1E3,this.Patch_DeleteThreshold=.5,this.Patch_Margin=4,this.Match_MaxBits=32}var r=Math.max,i=Math.floor,s=Math.min,l=String.fromCharCode,o=Math.ceil,_=-1,P=1,u=0;n.prototype.diff_main=function(t,n,r,i){if('undefined'==typeof i&&(i=0>=this.Diff_Timeout?Number.MAX_VALUE:new Date().getTime()+1E3*this.Diff_Timeout),null==t||null==n)throw Error('Null input. (diff_main)');if(t==n)return t?[[u,t]]:[];'undefined'==typeof r&&(r=!0);var a=r,e=this.diff_commonPrefix(t,n);r=t.substring(0,e),t=t.substring(e),n=n.substring(e),e=this.diff_commonSuffix(t,n);var s=t.substring(t.length-e);return t=t.substring(0,t.length-e),n=n.substring(0,n.length-e),t=this.diff_compute_(t,n,a,i),r&&t.unshift([u,r]),s&&t.push([u,s]),this.diff_cleanupMerge(t),t},n.prototype.diff_compute_=function(t,n,r,i){if(!t)return[[P,n]];if(!n)return[[_,t]];var s=t.length>n.length?t:n,e=t.length>n.length?n:t,l=s.indexOf(e);return-1==l?1==e.length?[[_,t],[P,n]]:(s=this.diff_halfMatch_(t,n))?(n=s[1],e=s[3],t=s[4],s=this.diff_main(s[0],s[2],r,i),r=this.diff_main(n,e,r,i),s.concat([[u,t]],r)):r&&100<t.length&&100<n.length?this.diff_lineMode_(t,n,i):this.diff_bisect_(t,n,i):(r=[[P,s.substring(0,l)],[u,e],[P,s.substring(l+e.length)]],t.length>n.length&&(r[0][0]=r[2][0]=_),r)},n.prototype.diff_lineMode_=function(t,n,r){var i=this.diff_linesToChars_(t,n);t=i.chars1,n=i.chars2,i=i.lineArray,t=this.diff_main(t,n,!1,r),this.diff_charsToLines_(t,i),this.diff_cleanupSemantic(t),t.push([u,'']);for(var a=i=n=0,e='',s='';n<t.length;){switch(t[n][0]){case P:a++,s+=t[n][1];break;case _:i++,e+=t[n][1];break;case u:if(1<=i&&1<=a){for(t.splice(n-i-a,i+a),n=n-i-a,i=this.diff_main(e,s,!1,r),a=i.length-1;0<=a;a--)t.splice(n,0,i[a]);n+=i.length}i=a=0,s=e='';}n++}return t.pop(),t},n.prototype.diff_bisect_=function(i,a,s){for(var c=i.length,d=a.length,e=o((c+d)/2),f=2*e,g=Array(f),h=Array(f),l=0;l<f;l++)g[l]=-1,h[l]=-1;g[e+1]=0,h[e+1]=0,l=c-d;for(var b=0!=l%2,E=0,p=0,x=0,C=0,O=0;O<e&&!(new Date().getTime()>s);O++){for(var S=-O+E;S<=O-p;S+=2){for(var v=e+S,n=S==-O||S!=O&&g[v-1]<g[v+1]?g[v+1]:g[v-1]+1,r=n-S;n<c&&r<d&&i.charAt(n)==a.charAt(r);)n++,r++;if(g[v]=n,n>c)p+=2;else if(r>d)E+=2;else if(b&&(v=e+l-S,0<=v&&v<f&&-1!=h[v])){var y=c-h[v];if(n>=y)return this.diff_bisectSplit_(i,a,n,r,s)}}for(S=-O+x;S<=O-C;S+=2){for(v=e+S,y=S==-O||S!=O&&h[v-1]<h[v+1]?h[v+1]:h[v-1]+1,n=y-S;y<c&&n<d&&i.charAt(c-y-1)==a.charAt(d-n-1);)y++,n++;if(h[v]=y,y>c)C+=2;else if(n>d)x+=2;else if(!b&&(v=e+l-S,0<=v&&v<f&&-1!=g[v]&&(n=g[v],r=e+n-v,y=c-y,n>=y)))return this.diff_bisectSplit_(i,a,n,r,s)}}return[[_,i],[P,a]]},n.prototype.diff_bisectSplit_=function(t,n,r,i,a){var e=t.substring(0,r),s=n.substring(0,i);return t=t.substring(r),n=n.substring(i),e=this.diff_main(e,s,!1,a),a=this.diff_main(t,n,!1,a),e.concat(a)},n.prototype.diff_linesToChars_=function(t,n){function r(e){for(var t='',n=0,r=-1,a=i.length;r<e.length-1;){r=e.indexOf('\n',n),-1==r&&(r=e.length-1);var o=e.substring(n,r+1);n=r+1,(s.hasOwnProperty?s.hasOwnProperty(o):void 0!==s[o])?t+=l(s[o]):(t+=l(a),s[o]=a,i[a++]=o)}return t}var i=[],s={};i[0]='';var e=r(t),a=r(n);return{chars1:e,chars2:a,lineArray:i}},n.prototype.diff_charsToLines_=function(t,n){for(var r=0;r<t.length;r++){for(var i=t[r][1],a=[],e=0;e<i.length;e++)a[e]=n[i.charCodeAt(e)];t[r][1]=a.join('')}},n.prototype.diff_commonPrefix=function(t,n){if(!t||!n||t.charAt(0)!=n.charAt(0))return 0;for(var r=0,l=s(t.length,n.length),o=l,e=0;r<o;)t.substring(e,o)==n.substring(e,o)?e=r=o:l=o,o=i((l-r)/2+r);return o},n.prototype.diff_commonSuffix=function(t,n){if(!t||!n||t.charAt(t.length-1)!=n.charAt(n.length-1))return 0;for(var r=0,l=s(t.length,n.length),o=l,e=0;r<o;)t.substring(t.length-o,t.length-e)==n.substring(n.length-o,n.length-e)?e=r=o:l=o,o=i((l-r)/2+r);return o},n.prototype.diff_commonOverlap_=function(t,n){var r=t.length,i=n.length;if(0==r||0==i)return 0;if(r>i?t=t.substring(r-i):r<i&&(n=n.substring(0,r)),r=s(r,i),t==n)return r;i=0;for(var a,l=1;;){if(a=t.substring(r-l),a=n.indexOf(a),-1==a)return i;l+=a,(0==a||t.substring(r-l)==n.substring(0,l))&&(i=l,l++)}},n.prototype.diff_halfMatch_=function(t,n){function r(t,n,r){for(var a,s,o,l,h=t.substring(r,r+i(t.length/4)),f=-1,e='';-1!=(f=n.indexOf(h,f+1));){var g=d.diff_commonPrefix(t.substring(r),n.substring(f)),m=d.diff_commonSuffix(t.substring(0,r),n.substring(0,f));e.length<m+g&&(e=n.substring(f-m,f)+n.substring(f,f+g),a=t.substring(0,r-m),s=t.substring(r+g),o=n.substring(0,f-m),l=n.substring(f+g))}return 2*e.length>=t.length?[a,s,o,l,e]:null}if(0>=this.Diff_Timeout)return null;var a=t.length>n.length?t:n,s=t.length>n.length?n:t;if(4>a.length||2*s.length<a.length)return null;var d=this,e=r(a,s,o(a.length/4));if(a=r(a,s,o(a.length/2)),e||a)e=a?e?e[4].length>a[4].length?e:a:a:e;else return null;if(t.length>n.length){a=e[0],s=e[1];var g=e[2],h=e[3]}else g=e[0],h=e[1],a=e[2],s=e[3];return[a,s,g,h,e[4]]},n.prototype.diff_cleanupSemantic=function(t){for(var n=!1,i=[],a=0,s=null,e=0,o=0,d=0,h=0,l=0;e<t.length;)t[e][0]==u?(i[a++]=e,o=h,d=l,l=h=0,s=t[e][1]):(t[e][0]==P?h+=t[e][1].length:l+=t[e][1].length,s&&s.length<=r(o,d)&&s.length<=r(h,l)&&(t.splice(i[a-1],0,[_,s]),t[i[a-1]+1][0]=P,a--,a--,e=0<a?i[a-1]:-1,l=h=d=o=0,s=null,n=!0)),e++;for(n&&this.diff_cleanupMerge(t),this.diff_cleanupSemanticLossless(t),e=1;e<t.length;)t[e-1][0]==_&&t[e][0]==P&&(n=t[e-1][1],i=t[e][1],a=this.diff_commonOverlap_(n,i),s=this.diff_commonOverlap_(i,n),a>=s?(a>=n.length/2||a>=i.length/2)&&(t.splice(e,0,[u,i.substring(0,a)]),t[e-1][1]=n.substring(0,n.length-a),t[e+1][1]=i.substring(a),e++):(s>=n.length/2||s>=i.length/2)&&(t.splice(e,0,[u,n.substring(0,s)]),t[e-1][0]=P,t[e-1][1]=i.substring(0,i.length-s),t[e+1][0]=_,t[e+1][1]=n.substring(s),e++),e++),e++},n.prototype.diff_cleanupSemanticLossless=function(t){function r(t,r){if(!t||!r)return 6;var i=t.charAt(t.length-1),s=r.charAt(0),o=i.match(n.nonAlphaNumericRegex_),e=s.match(n.nonAlphaNumericRegex_),d=o&&i.match(n.whitespaceRegex_),c=e&&s.match(n.whitespaceRegex_);i=d&&i.match(n.linebreakRegex_),s=c&&s.match(n.linebreakRegex_);var h=i&&t.match(n.blanklineEndRegex_),f=s&&r.match(n.blanklineStartRegex_);return h||f?5:i||s?4:o&&!d&&c?3:d||c?2:o||e?1:0}for(var i=1;i<t.length-1;){if(t[i-1][0]==u&&t[i+1][0]==u){var a=t[i-1][1],s=t[i][1],e=t[i+1][1],o=this.diff_commonSuffix(a,s);if(o){var d=s.substring(s.length-o);a=a.substring(0,a.length-o),s=d+s.substring(0,s.length-o),e=d+e}o=a,d=s;for(var h=e,l=r(a,s)+r(s,e);s.charAt(0)===e.charAt(0);){a+=s.charAt(0),s=s.substring(1)+e.charAt(0),e=e.substring(1);var g=r(a,s)+r(s,e);g>=l&&(l=g,o=a,d=s,h=e)}t[i-1][1]!=o&&(o?t[i-1][1]=o:(t.splice(i-1,1),i--),t[i][1]=d,h?t[i+1][1]=h:(t.splice(i+1,1),i--))}i++}},n.nonAlphaNumericRegex_=/[^a-zA-Z0-9]/,n.whitespaceRegex_=/\s/,n.linebreakRegex_=/[\r\n]/,n.blanklineEndRegex_=/\n\r?\n$/,n.blanklineStartRegex_=/^\r?\n\r?\n/,n.prototype.diff_cleanupEfficiency=function(t){for(var n=!1,r=[],i=0,a=null,e=0,s=!1,o=!1,d=!1,l=!1;e<t.length;)t[e][0]==u?(t[e][1].length<this.Diff_EditCost&&(d||l)?(r[i++]=e,s=d,o=l,a=t[e][1]):(i=0,a=null),d=l=!1):(t[e][0]==_?l=!0:d=!0,a&&(s&&o&&d&&l||a.length<this.Diff_EditCost/2&&3==s+o+d+l)&&(t.splice(r[i-1],0,[_,a]),t[r[i-1]+1][0]=P,i--,a=null,s&&o?(d=l=!0,i=0):(i--,e=0<i?r[i-1]:-1,d=l=!1),n=!0)),e++;n&&this.diff_cleanupMerge(t)},n.prototype.diff_cleanupMerge=function(t){t.push([u,'']);for(var n,r=0,i=0,a=0,s='',e='';r<t.length;)switch(t[r][0]){case P:a++,e+=t[r][1],r++;break;case _:i++,s+=t[r][1],r++;break;case u:1<i+a?(0!=i&&0!=a&&(n=this.diff_commonPrefix(e,s),0!==n&&(0<r-i-a&&t[r-i-a-1][0]==u?t[r-i-a-1][1]+=e.substring(0,n):(t.splice(0,0,[u,e.substring(0,n)]),r++),e=e.substring(n),s=s.substring(n)),n=this.diff_commonSuffix(e,s),0!==n&&(t[r][1]=e.substring(e.length-n)+t[r][1],e=e.substring(0,e.length-n),s=s.substring(0,s.length-n))),0==i?t.splice(r-a,i+a,[P,e]):0==a?t.splice(r-i,i+a,[_,s]):t.splice(r-i-a,i+a,[_,s],[P,e]),r=r-i-a+(i?1:0)+(a?1:0)+1):0!=r&&t[r-1][0]==u?(t[r-1][1]+=t[r][1],t.splice(r,1)):r++,i=a=0,e=s='';}for(''===t[t.length-1][1]&&t.pop(),i=!1,r=1;r<t.length-1;)t[r-1][0]==u&&t[r+1][0]==u&&(t[r][1].substring(t[r][1].length-t[r-1][1].length)==t[r-1][1]?(t[r][1]=t[r-1][1]+t[r][1].substring(0,t[r][1].length-t[r-1][1].length),t[r+1][1]=t[r-1][1]+t[r+1][1],t.splice(r-1,1),i=!0):t[r][1].substring(0,t[r+1][1].length)==t[r+1][1]&&(t[r-1][1]+=t[r+1][1],t[r][1]=t[r][1].substring(t[r+1][1].length)+t[r+1][1],t.splice(r+1,1),i=!0)),r++;i&&this.diff_cleanupMerge(t)},n.prototype.diff_xIndex=function(t,n){var r,i=0,a=0,s=0,e=0;for(r=0;r<t.length&&(t[r][0]!==P&&(i+=t[r][1].length),t[r][0]!==_&&(a+=t[r][1].length),!(i>n));r++)s=i,e=a;return t.length!=r&&t[r][0]===_?e:e+(n-s)},n.prototype.diff_prettyHtml=function(t){for(var n=[],r=/&/g,i=/</g,a=/>/g,e=/\n/g,s=0;s<t.length;s++){var o=t[s][0],d=t[s][1].replace(r,'&amp;').replace(i,'&lt;').replace(a,'&gt;').replace(e,'&para;<br>');o===P?n[s]='<ins style="background:#e6ffe6;">'+d+'</ins>':o===_?n[s]='<del style="background:#ffe6e6;">'+d+'</del>':o===u?n[s]='<span>'+d+'</span>':void 0}return n.join('')},n.prototype.diff_text1=function(e){for(var t=[],n=0;n<e.length;n++)e[n][0]!==P&&(t[n]=e[n][1]);return t.join('')},n.prototype.diff_text2=function(e){for(var t=[],n=0;n<e.length;n++)e[n][0]!==_&&(t[n]=e[n][1]);return t.join('')},n.prototype.diff_levenshtein=function(t){for(var n,i=0,a=0,s=0,l=0;l<t.length;l++)switch(n=t[l][1],t[l][0]){case P:a+=n.length;break;case _:s+=n.length;break;case u:i+=r(a,s),s=a=0;}return i+=r(a,s)},n.prototype.diff_toDelta=function(e){for(var t=[],n=0;n<e.length;n++)switch(e[n][0]){case P:t[n]='+'+encodeURI(e[n][1]);break;case _:t[n]='-'+e[n][1].length;break;case u:t[n]='='+e[n][1].length;}return t.join('\t').replace(/%20/g,' ')},n.prototype.diff_fromDelta=function(t,n){for(var r,i=[],a=0,s=0,e=n.split(/\t/g),o=0;o<e.length;o++)switch(r=e[o].substring(1),e[o].charAt(0)){case'+':try{i[a++]=[P,decodeURI(r)]}catch(e){throw Error('Illegal escape in diff_fromDelta: '+r)}break;case'-':case'=':var d=parseInt(r,10);if(isNaN(d)||0>d)throw Error('Invalid number in diff_fromDelta: '+r);r=t.substring(s,s+=d),i[a++]='='==e[o].charAt(0)?[u,r]:[_,r];break;default:if(e[o])throw Error('Invalid diff operation in diff_fromDelta: '+e[o]);}if(s!=t.length)throw Error('Delta length ('+s+') does not equal source text length ('+t.length+').');return i},n.prototype.match_main=function(e,t,n){if(null==e||null==t||null==n)throw Error('Null input. (match_main)');return n=r(0,s(n,e.length)),e==t?0:e.length?e.substring(n,n+t.length)==t?n:this.match_bitap_(e,t,n):-1},n.prototype.match_bitap_=function(n,o,u){function a(t,n){var r=t/o.length,e=Math.abs(u-n);return c.Match_Distance?r+e/c.Match_Distance:e?1:r}if(o.length>this.Match_MaxBits)throw Error('Pattern too long for this browser.');var d=this.match_alphabet_(o),c=this,e=this.Match_Threshold,g=n.indexOf(o,u);-1!=g&&(e=s(a(0,g),e),g=n.lastIndexOf(o,u+o.length),-1!=g&&(e=s(a(0,g),e)));var h=1<<o.length-1;g=-1;for(var l,f,m,_=o.length+n.length,p=0;p<o.length;p++){for(l=0,f=_;l<f;)a(p,u+f)<=e?l=f:_=f,f=i((_-l)/2+l);_=f,l=r(1,u-f+1);var b=s(u+f,n.length)+o.length;for(f=Array(b+2),f[b+1]=(1<<p)-1;b>=l;b--){var P=d[n.charAt(b-1)];if(f[b]=0===p?(1|f[b+1]<<1)&P:1|((1|f[b+1]<<1)&P|(m[b+1]|m[b])<<1)|m[b+1],f[b]&h&&(P=a(p,b-1),P<=e))if(e=P,g=b-1,g>u)l=r(1,2*u-g);else break}if(a(p+1,u)>e)break;m=f}return g},n.prototype.match_alphabet_=function(e){for(var t={},n=0;n<e.length;n++)t[e.charAt(n)]=0;for(n=0;n<e.length;n++)t[e.charAt(n)]|=1<<e.length-n-1;return t},n.prototype.patch_addContext_=function(e,t){if(0!=t.length){for(var n=t.substring(e.start2,e.start2+e.length1),r=0;t.indexOf(n)!=t.lastIndexOf(n)&&n.length<this.Match_MaxBits-this.Patch_Margin-this.Patch_Margin;)r+=this.Patch_Margin,n=t.substring(e.start2-r,e.start2+e.length1+r);r+=this.Patch_Margin,(n=t.substring(e.start2-r,e.start2))&&e.diffs.unshift([u,n]),(r=t.substring(e.start2+e.length1,e.start2+e.length1+r))&&e.diffs.push([u,r]),e.start1-=n.length,e.start2-=n.length,e.length1+=n.length+r.length,e.length2+=n.length+r.length}},n.prototype.patch_make=function(t,r,i){if('string'==typeof t&&'string'==typeof r&&'undefined'==typeof i){var s=t;r=this.diff_main(s,r,!0),2<r.length&&(this.diff_cleanupSemantic(r),this.diff_cleanupEfficiency(r))}else if(t&&'object'==typeof t&&'undefined'==typeof r&&'undefined'==typeof i)r=t,s=this.diff_text1(r);else if('string'==typeof t&&r&&'object'==typeof r&&'undefined'==typeof i)s=t;else if('string'==typeof t&&'string'==typeof r&&i&&'object'==typeof i)s=t,r=i;else throw Error('Unknown call format to patch_make.');if(0===r.length)return[];i=[],t=new n.patch_obj;for(var o=0,e=0,d=0,g=s,h=0;h<r.length;h++){var l=r[h][0],f=r[h][1];o||l===u||(t.start1=e,t.start2=d),l===P?(t.diffs[o++]=r[h],t.length2+=f.length,s=s.substring(0,d)+f+s.substring(d)):l===_?(t.length1+=f.length,t.diffs[o++]=r[h],s=s.substring(0,d)+s.substring(d+f.length)):l===u?f.length<=2*this.Patch_Margin&&o&&r.length!=h+1?(t.diffs[o++]=r[h],t.length1+=f.length,t.length2+=f.length):f.length>=2*this.Patch_Margin&&o&&(this.patch_addContext_(t,g),i.push(t),t=new n.patch_obj,o=0,g=s,e=d):void 0,l!==P&&(e+=f.length),l!==_&&(d+=f.length)}return o&&(this.patch_addContext_(t,g),i.push(t)),i},n.prototype.patch_deepCopy=function(t){for(var r=[],i=0;i<t.length;i++){var a=t[i],s=new n.patch_obj;s.diffs=[];for(var e=0;e<a.diffs.length;e++)s.diffs[e]=a.diffs[e].slice();s.start1=a.start1,s.start2=a.start2,s.length1=a.length1,s.length2=a.length2,r[i]=s}return r},n.prototype.patch_apply=function(t,n){if(0==t.length)return[n,[]];t=this.patch_deepCopy(t);var r=this.patch_addPadding(t);n=r+n+r,this.patch_splitMax(t);for(var i=0,a=[],e=0;e<t.length;e++){var s=t[e].start2+i,o=this.diff_text1(t[e].diffs),d=-1;if(o.length>this.Match_MaxBits){var l=this.match_main(n,o.substring(0,this.Match_MaxBits),s);-1!=l&&(d=this.match_main(n,o.substring(o.length-this.Match_MaxBits),s+o.length-this.Match_MaxBits),-1==d||l>=d)&&(l=-1)}else l=this.match_main(n,o,s);if(-1==l)a[e]=!1,i-=t[e].length2-t[e].length1;else if(a[e]=!0,i=l-s,s=-1==d?n.substring(l,l+o.length):n.substring(l,d+this.Match_MaxBits),o==s)n=n.substring(0,l)+this.diff_text2(t[e].diffs)+n.substring(l+o.length);else if(s=this.diff_main(o,s,!1),o.length>this.Match_MaxBits&&this.diff_levenshtein(s)/o.length>this.Patch_DeleteThreshold)a[e]=!1;else{this.diff_cleanupSemanticLossless(s),o=0;var h;for(d=0;d<t[e].diffs.length;d++){var g=t[e].diffs[d];g[0]!==u&&(h=this.diff_xIndex(s,o)),g[0]===P?n=n.substring(0,l+h)+g[1]+n.substring(l+h):g[0]===_&&(n=n.substring(0,l+h)+n.substring(l+this.diff_xIndex(s,o+g[1].length))),g[0]!==_&&(o+=g[1].length)}}}return n=n.substring(r.length,n.length-r.length),[n,a]},n.prototype.patch_addPadding=function(t){for(var n=this.Patch_Margin,r='',i=1;i<=n;i++)r+=l(i);for(i=0;i<t.length;i++)t[i].start1+=n,t[i].start2+=n;i=t[0];var a=i.diffs;if(0==a.length||a[0][0]!=u)a.unshift([u,r]),i.start1-=n,i.start2-=n,i.length1+=n,i.length2+=n;else if(n>a[0][1].length){var e=n-a[0][1].length;a[0][1]=r.substring(a[0][1].length)+a[0][1],i.start1-=e,i.start2-=e,i.length1+=e,i.length2+=e}return i=t[t.length-1],a=i.diffs,0==a.length||a[a.length-1][0]!=u?(a.push([u,r]),i.length1+=n,i.length2+=n):n>a[a.length-1][1].length&&(e=n-a[a.length-1][1].length,a[a.length-1][1]+=r.substring(0,e),i.length1+=e,i.length2+=e),r},n.prototype.patch_splitMax=function(t){for(var r=this.Match_MaxBits,i=0;i<t.length;i++)if(!(t[i].length1<=r)){var a=t[i];t.splice(i--,1);for(var s=a.start1,e=a.start2,o='';0!==a.diffs.length;){var d=new n.patch_obj,h=!0;for(d.start1=s-o.length,d.start2=e-o.length,''!=o&&(d.length1=d.length2=o.length,d.diffs.push([u,o]));0!==a.diffs.length&&d.length1<r-this.Patch_Margin;){o=a.diffs[0][0];var l=a.diffs[0][1];o===P?(d.length2+=l.length,e+=l.length,d.diffs.push(a.diffs.shift()),h=!1):o===_&&1==d.diffs.length&&d.diffs[0][0]==u&&l.length>2*r?(d.length1+=l.length,s+=l.length,h=!1,d.diffs.push([o,l]),a.diffs.shift()):(l=l.substring(0,r-d.length1-this.Patch_Margin),d.length1+=l.length,s+=l.length,o===u?(d.length2+=l.length,e+=l.length):h=!1,d.diffs.push([o,l]),l==a.diffs[0][1]?a.diffs.shift():a.diffs[0][1]=a.diffs[0][1].substring(l.length))}o=this.diff_text2(d.diffs),o=o.substring(o.length-this.Patch_Margin),l=this.diff_text1(a.diffs).substring(0,this.Patch_Margin),''!==l&&(d.length1+=l.length,d.length2+=l.length,0!==d.diffs.length&&d.diffs[d.diffs.length-1][0]===u?d.diffs[d.diffs.length-1][1]+=l:d.diffs.push([u,l])),h||t.splice(++i,0,d)}}},n.prototype.patch_toText=function(e){for(var t=[],n=0;n<e.length;n++)t[n]=e[n];return t.join('')},n.prototype.patch_fromText=function(t){var r=[];if(!t)return r;t=t.split('\n');for(var i,s=0,l=/^@@ -(\d+),?(\d*) \+(\d+),?(\d*) @@$/;s<t.length;){if(i=t[s].match(l),!i)throw Error('Invalid patch string: '+t[s]);var o=new n.patch_obj;for(r.push(o),o.start1=parseInt(i[1],10),''===i[2]?(o.start1--,o.length1=1):'0'==i[2]?o.length1=0:(o.start1--,o.length1=parseInt(i[2],10)),o.start2=parseInt(i[3],10),''===i[4]?(o.start2--,o.length2=1):'0'==i[4]?o.length2=0:(o.start2--,o.length2=parseInt(i[4],10)),s++;s<t.length;){i=t[s].charAt(0);try{var d=decodeURI(t[s].substring(1))}catch(e){throw Error('Illegal escape in patch_fromText: '+d)}if('-'==i)o.diffs.push([_,d]);else if('+'==i)o.diffs.push([P,d]);else if(' '==i)o.diffs.push([u,d]);else if('@'==i)break;else if(''!==i)throw Error('Invalid patch mode "'+i+'" in: '+d);s++}}return r},n.patch_obj=function(){this.diffs=[],this.start2=this.start1=null,this.length2=this.length1=0},n.patch_obj.prototype.toString=function(){for(var e,t=['@@ -'+(0===this.length1?this.start1+',0':1==this.length1?this.start1+1:this.start1+1+','+this.length1)+' +'+(0===this.length2?this.start2+',0':1==this.length2?this.start2+1:this.start2+1+','+this.length2)+' @@\n'],n=0;n<this.diffs.length;n++){switch(this.diffs[n][0]){case P:e='+';break;case _:e='-';break;case u:e=' ';}t[n+1]=e+encodeURI(this.diffs[n][1])+'\n'}return t.join('').replace(/%20/g,' ')},this.diff_match_patch=n,this.DIFF_DELETE=_,this.DIFF_INSERT=P,this.DIFF_EQUAL=u;var a=new n;a.Diff_Timeout=1,a.Diff_EditCost=4;var h=a.diff_main(e,t);return h}}},function(e,t,n){'use strict';Object.defineProperty(t,'__esModule',{value:!0});var r=n(10),i=n(11),a=n(12),s=function(e){return e&&e.__esModule?e:{default:e}}(a);class l{constructor(){this.m_OS=this._detectOS()}set type(e){e.split('').forEach((e)=>{s.default.getInstance().fireKeyEvent('keypress',e)})}_detectOS(){var e=i.OS.OTHER;return-1==window.navigator.userAgent.indexOf('CrOS')?-1==window.navigator.userAgent.indexOf('Windows')?-1!=window.navigator.userAgent.indexOf('Mac')&&(e=i.OS.MAC):e=i.OS.WINDOWS:e=i.OS.CHROMEOS,e}caretMoveLeft(){var e=0<arguments.length&&arguments[0]!==void 0?arguments[0]:1,t=1<arguments.length&&arguments[1]!==void 0&&arguments[1];s.default.getInstance().fireKeyEvent('keydown',r.KEYCODES.LEFT_ARROW,t,!1,!1,!1,e)}caretMoveRight(){var e=0<arguments.length&&arguments[0]!==void 0?arguments[0]:1,t=1<arguments.length&&arguments[1]!==void 0&&arguments[1];s.default.getInstance().fireKeyEvent('keydown',r.KEYCODES.RIGHT_ARROW,t,!1,!1,!1,e)}caretToStartOfWord(){var e=0<arguments.length&&arguments[0]!==void 0&&arguments[0];s.default.getInstance().fireKeyEvent('keydown',r.KEYCODES.LEFT_ARROW,e,!0)}caretToStartOfNextWord(){var e=0<arguments.length&&arguments[0]!==void 0&&arguments[0];s.default.getInstance().fireKeyEvent('keydown',r.KEYCODES.RIGHT_ARROW,e,!0)}caretToStartOfLine(){var e=0<arguments.length&&arguments[0]!==void 0&&arguments[0];return this.m_OS==i.OS.MAC?void s.default.getInstance().fireKeyEvent('keydown',r.KEYCODES.LEFT_ARROW,e,!1,!1,!0):void s.default.getInstance().fireKeyEvent('keydown',r.KEYCODES.HOME,e)}caretToEndOfLine(){var e=0<arguments.length&&arguments[0]!==void 0&&arguments[0];return this.m_OS==i.OS.MAC?void s.default.getInstance().fireKeyEvent('keydown',r.KEYCODES.RIGHT_ARROW,e,!1,!1,!0):void s.default.getInstance().fireKeyEvent('keydown',r.KEYCODES.END,e)}caretToStartOfDocument(){var e=0<arguments.length&&arguments[0]!==void 0&&arguments[0];return this.m_OS==i.OS.MAC?void s.default.getInstance().fireKeyEvent('keydown',r.KEYCODES.UP_ARROW,e,!1,!1,!0):void s.default.getInstance().fireKeyEvent('keydown',r.KEYCODES.HOME,e,!0)}caretToEndOfDocument(){var e=0<arguments.length&&arguments[0]!==void 0&&arguments[0];return this.m_OS==i.OS.MAC?void s.default.getInstance().fireKeyEvent('keydown',r.KEYCODES.DOWN_ARROW,e,!1,!1,!0):void s.default.getInstance().fireKeyEvent('keydown',r.KEYCODES.END,e,!0)}}t.default=l},function(e,t){'use strict';Object.defineProperty(t,'__esModule',{value:!0});t.KEYCODES={BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESCAPE:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT_ARROW:37,UP_ARROW:38,RIGHT_ARROW:39,DOWN_ARROW:40,INSERT:45,DELETE:46,KEY_0:48,KEY_1:49,KEY_2:50,KEY_3:51,KEY_4:52,KEY_5:53,KEY_6:54,KEY_7:55,KEY_8:56,KEY_9:57,KEY_A:65,KEY_B:66,KEY_C:67,KEY_D:68,KEY_E:69,KEY_F:70,KEY_G:71,KEY_H:72,KEY_I:73,KEY_J:74,KEY_K:75,KEY_L:76,KEY_M:77,KEY_N:78,KEY_O:79,KEY_P:80,KEY_Q:81,KEY_R:82,KEY_S:83,KEY_T:84,KEY_U:85,KEY_V:86,KEY_W:87,KEY_X:88,KEY_Y:89,KEY_Z:90,LEFT_META:91,RIGHT_META:92,SELECT:93,NUMPAD_0:96,NUMPAD_1:97,NUMPAD_2:98,NUMPAD_3:99,NUMPAD_4:100,NUMPAD_5:101,NUMPAD_6:102,NUMPAD_7:103,NUMPAD_8:104,NUMPAD_9:105,MULTIPLY:106,ADD:107,SUBTRACT:109,DECIMAL:110,DIVIDE:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUM_LOCK:144,SCROLL_LOCK:145,SEMICOLON:186,EQUALS:187,COMMA:188,DASH:189,PERIOD:190,FORWARD_SLASH:191,GRAVE_ACCENT:192,OPEN_BRACKET:219,BACK_SLASH:220,CLOSE_BRACKET:221,SINGLE_QUOTE:222};t.default=class{}},function(e,t){'use strict';Object.defineProperty(t,'__esModule',{value:!0});t.OS={CHROMEOS:4,WINDOWS:5,MAC:6,OTHER:7};t.default=class{}},function(e,t){'use strict';Object.defineProperty(t,'__esModule',{value:!0});var n=null;class r{constructor(){if(null!=n)return n;n=this;var e=document.querySelector('.docs-texteventtarget-iframe');return null==e?n:(this.m_textEventIFrameDoc=e.contentDocument,this.m_textEventIFrameWindow=e.contentWindow,this.m_editorWindow=document.querySelector('.kix-appview-editor'),this.m_eventHandlers=[],this.m_eventHandlers.keydown=this._getEventHandlers('keydown'),this.m_eventHandlers.keyup=this._getEventHandlers('keyup'),this.m_eventHandlers.keypress=this._getEventHandlers('keypress'),n)}static getInstance(){return new r}fireKeyEvent(e,t){var n=2<arguments.length&&arguments[2]!==void 0&&arguments[2],r=3<arguments.length&&arguments[3]!==void 0&&arguments[3],a=4<arguments.length&&arguments[4]!==void 0&&arguments[4],s=5<arguments.length&&arguments[5]!==void 0&&arguments[5],l=6<arguments.length&&arguments[6]!==void 0?arguments[6]:1;'string'==typeof t&&(t=t.charCodeAt(0));var o={altGraphKey:!1,altKey:a,bubbles:!0,cancelBubble:!1,cancelable:!0,charCode:t,clipboardData:void 0,ctrlKey:r,currentTarget:this.m_textEventIFrameDoc,defaultPrevented:!0,detail:0,eventPhase:0,keyCode:t,keyLocation:0,layerX:0,layerY:0,metaKey:s,pageX:0,pageY:0,returnValue:!0,shiftKey:n,srcElement:this.m_textEventIFrameDoc.body,target:this.m_textEventIFrameDoc.body,timeStamp:new Date().getTime(),type:e,view:this.m_textEventIFrameWindow,which:t},d=0;this.m_eventHandlers[e].forEach((e)=>{for(d=0;d<l;d++)e.eventHandler(o)})}_getEventHandlers(e,t){try{t==void 0&&(t=this.m_textEventIFrameDoc);var n=[],r=null;for(var a in t)if(a.match(/^closure/)&&'number'!=typeof t[a]){var s=t[a];if(!s)continue;if(!r)for(var l in s){var o=s[l];if(o&&o!=t)for(var d in o){var h=o[d];h&&void 0!=h.length&&h[0].src==t&&(r=l,n.concat(h))}}for(var g in s[r])if(g==e)for(var c=s[r][g],f=0;f<c.length;f++){if(!r&&c[f].src==t)for(var i in c[f])if(c[f][i].src==t){r=i;break}n.push({eventObject:c[f],eventHandler:c[f][r]})}}return n}catch(e){console.log(e)}}}t.default=r}])});