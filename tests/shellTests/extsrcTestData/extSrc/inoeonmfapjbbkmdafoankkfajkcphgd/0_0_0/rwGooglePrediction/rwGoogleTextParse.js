function rwGoogleTextParse(){this.isHTML=!1,this.rootText='',this.Lefttext='',this.Leftwords='',this.MultiLineText=!1,this.MultiLineCollection='',this.ExpectLines=0,this.RightText='',this.Rightwords='',this.CurrentWordBeginIndex=0,this.CurrentWordEndIndex=0,this.CurrentWord='',this.CursorPosition=0,this.CursorLinePosition=0,this.currentChar='',this.LastCharWord='',this.ActiveLine=-1,this.CurrentPosition=0,this.NextChar='',this.Selection=void 0,this.setCaretPosition=function(a,b){if(null!=a)if(a.createTextRange){var c=a.createTextRange();c.move('character',b),c.select()}else a.selectionStart?(a.focus(),a.setSelectionRange(b,b)):a.focus()},this.getCaretPosition=function(a){var b=0;if('undefined'!=typeof window.getSelection){var c=window.getSelection().getRangeAt(0),d=c.cloneRange();d.selectNodeContents(a),d.setEnd(c.endContainer,c.endOffset),b=d.toString().length}else if('undefined'!=typeof document.selection&&'Control'!=document.selection.type){var e=document.selection.createRange(),f=document.body.createTextRange();f.moveToElementText(a),f.setEndPoint('EndToEnd',e),b=f.text.length}return b},this.InsertText=function(a,b){if('DIV'==a.tagName){a.focus();var c=document.getElementById('rwPredictionPosition');this.setCaretPositionDiv(currentContextControlID),this.setSelectionRange(a,c.value,c.value),this.currentChar=this.getCurrentCharacter(),this.replaceSelectedText(b)}else this.CurrentPosition=a.selectionStart,this.setSelectionRange(a,this.CurrentPosition,this.CurrentPosition),this.currentChar=this.getCurrentCharacter(),this.setSelectionRange(a,this.CurrentPosition,this.CurrentPosition),this.replaceSelectedText(b),this.setSelectionRange(a,this.CurrentPosition,this.CurrentPosition),this.setCaretPosition(a,this.CurrentPosition);return!1},this.setSelection=function(){window.getSelection&&(this.Selection=window.getSelection()).modify},this.parseText=function(a,b,c){'DIV'==c.tagName||(this.CurrentPosition=c.selectionStart),this.setSelectionRange(c,this.CurrentPosition,this.CurrentPosition),this.currentChar=this.getCurrentCharacter();var d=!1;switch(this.currentChar.charCodeAt(0)){case 46:case 33:case 63:this.Lefttext='',d=!0;}if(!d){this.setSelectionRange(c,this.CurrentPosition,this.CurrentPosition);var e=this.getPreviousCharacter();13==e.charCodeAt(0)?this.Lefttext='':(this.setSelectionRange(c,this.CurrentPosition,this.CurrentPosition),this.Lefttext=this.GetSentence())}this.setSelectionRange(c,this.CurrentPosition,this.CurrentPosition),this.NextChar=this.getNextCharacter(),this.setSelectionRange(c,this.CurrentPosition,this.CurrentPosition),this.CurrentWord=32==this.currentChar.charCodeAt(0)||160==this.currentChar.charCodeAt(0)?' ':this.getWord(),this.setSelectionRange(c,this.CurrentPosition,this.CurrentPosition)},this.GetSentence=function(){var a,b='';if(window.getSelection&&(a=window.getSelection()).modify){var c=a.getRangeAt(0);a.collapseToStart(),32==this.currentChar.charCodeAt(0)||160==this.currentChar.charCodeAt(0)?a.modify('extend','backward','sentenceboundary'):a.modify('extend','backward','sentenceboundary'),b=a.toString(),a.removeAllRanges(),a.addRange(c)}else if((a=document.selection)&&'Control'!=a.type){var d=a.createRange();d.collapse(!0),d.expand('sentence'),b=d.text}return b},this.getCurrentCharacter=function(){var a,b='';if(window.getSelection&&(a=window.getSelection()).modify){var c=a.getRangeAt(0);a.collapseToStart(),a.modify('move','backward','character'),a.modify('extend','forward','character'),b=a.toString(),a.removeAllRanges(),a.addRange(c)}else if((a=document.selection)&&'Control'!=a.type){var d=a.createRange();d.collapse(!0),d.expand('word'),b=d.text}return b},this.getPreviousCharacter=function(){var a,b='';if(window.getSelection&&(a=window.getSelection()).modify){var c=a.getRangeAt(0);a.collapseToStart(),a.modify('move','backward','character'),a.modify('move','backward','character'),a.modify('extend','forward','character'),b=a.toString(),a.removeAllRanges(),a.addRange(c)}else if((a=document.selection)&&'Control'!=a.type){var d=a.createRange();d.collapse(!0),d.expand('word'),b=d.text}return b},this.getNextCharacter=function(){var a,b='';if(window.getSelection&&(a=window.getSelection()).modify){var c=a.getRangeAt(0);a.collapseToStart(),a.modify('move','forward','character'),a.modify('extend','forward','character'),b=a.toString(),a.removeAllRanges(),a.addRange(c)}else if((a=document.selection)&&'Control'!=a.type){var d=a.createRange();d.collapse(!0),d.expand('word'),b=d.text}return b},this.getNewPosition=function(){var a,b='';if(window.getSelection&&(a=window.getSelection()).modify){var c=a.getRangeAt(0);a.collapseToStart(),a.modify('move','forward','word'),b=a.toString(),a.removeAllRanges(),a.addRange(c)}else if((a=document.selection)&&'Control'!=a.type){var d=a.createRange();d.collapse(!0),d.expand('word'),b=d.text}return b},this.MoveToEnd=function(){var a,b='';if(window.getSelection&&(a=window.getSelection()).modify){var c=a.getRangeAt(0);a.collapseToStart(),a.modify('move','forward','word'),a.removeAllRanges(),a.addRange(c)}else if((a=document.selection)&&'Control'!=a.type){var d=a.createRange();d.collapse(!0),d.expand('word'),b=d.text}return b},this.getWord=function(){var a,b='';if(window.getSelection&&(a=window.getSelection()).modify){var c=a.getRangeAt(0);a.collapseToStart(),a.modify('move','backward','word'),a.modify('extend','forward','word'),b=a.toString(),a.removeAllRanges(),a.addRange(c)}else if((a=document.selection)&&'Control'!=a.type){var d=a.createRange();d.collapse(!0),d.expand('word'),b=d.text}return b},this.setSelectionRange=function(a,b,c){if(a.setSelectionRange)a.focus(),a.setSelectionRange(b,c);else if(a.createTextRange){var d=a.createTextRange();d.collapse(!0),d.moveEnd('character',c),d.moveStart('character',b),d.select()}else a.focus()},this.setCaretPositionDiv=function(a,b){var c=window.getSelection();c.collapseToStart();var d=document.getElementById('rwPredictionPosition'),e=d.value;b!=void 0&&(e=b);var f=a;f.focus();var g=f.firstChild,h=0,j=e,k=!1;for(i=0;i<f.childNodes.length;i++)h+=f.childNodes[i].nodeValue.length,e<=h&&!1==k?(g=f.childNodes[i],k=!0):j-=f.childNodes[i].nodeValue.length;var l=document.createRange();l.setStart(g,j),l.setEnd(g,j),c=window.getSelection(),c.removeAllRanges(),c.addRange(l)},this.replaceSelectedText=function(a){var b,c;a+=' ';var d=0;if(window.getSelection){b=window.getSelection();var e=document.activeElement;if('TEXTAREA'==e.nodeName||'INPUT'==e.nodeName&&'text'==e.type.toLowerCase()){if(0<this.CurrentPosition)switch(this.currentChar.charCodeAt(0)){case 46:case 33:case 63:a=' '+a;case 32:case 160:break;case 38:b.collapseToStart(),b.modify('move','backward','character'),b.modify('move','backward','character'),b.modify('extend','forward','character');var f=b.toString();' '==f?(b.modify('move','forward','character'),b.modify('extend','forward','character')):(b.modify('move','backward','word'),b.modify('extend','forward','word'));break;case 45:b.collapseToStart(),b.modify('move','backward','word'),b.modify('extend','forward','word'),b.modify('extend','forward','word');break;default:b.collapseToStart(),b.modify('move','backward','word'),b.modify('move','backward','character'),b.modify('extend','forward','character');var f=b.toString();if('-'==f?(b.modify('extend','backward','character'),b.modify('move','forward','character'),b.modify('move','backward','word'),b.modify('extend','forward','word'),b.modify('extend','forward','word')):32==f.charCodeAt(0)&&b.modify('move','forward','character'),b.modify('extend','forward','word'),f=b.toString(),'-'==f.substr(f.length-1,1)&&b.modify('extend','forward','word'),f=b.toString(),-1!=navigator.appVersion.indexOf('Win')){' '==f.substr(f.length-1,1)&&(b.modify('extend','backward','character'),a=a.trim(),d++),f=b.toString();var g=/^[0-9a-zA-Z]+$/;f.substr(f.length-1,1).match(g)||(b.modify('extend','backward','character'),a=a.trim(),d++)}}var h=e.value,j=e.selectionStart,k=e.selectionEnd;if(-1!=navigator.appVersion.indexOf('Win'));else switch(h.slice(k).substr(0,1)){case' ':a=a.trim(),d++;break;case';':case':':case'!':case'.':a=a.trim(),d++,d++;}e.value=h.slice(0,j)+a+h.slice(k),this.CurrentPosition=j+a.length+d}else{var b=window.getSelection();if(this.setCaretPositionDiv(e),32==this.currentChar.charCodeAt(0)||160==this.currentChar.charCodeAt(0));else{b.modify('move','backward','word'),b.modify('move','backward','character'),b.modify('extend','forward','character');var f=b.toString();'-'==f?(b.modify('extend','backward','character'),b.modify('move','forward','character'),b.modify('move','backward','word'),b.modify('extend','forward','word'),b.modify('extend','forward','word')):32==f.charCodeAt(0)&&b.modify('move','forward','character'),b.modify('extend','forward','word')}b.rangeCount?(c=b.getRangeAt(0),c.deleteContents(),c.insertNode(document.createTextNode(a))):b.deleteFromDocument();var h=e.value,j=e.selectionStart,k=e.selectionEnd;e.value=h.slice(0,j)+a+h.slice(k),setCaretPositionDiv(e,j+a.length)}}else document.selection&&document.selection.createRange&&(c=document.selection.createRange(),c.text=a)},this.getCaretCharacterOffsetWithin=function(a){var b,c=0,d=a.ownerDocument||a.document,e=d.defaultView||d.parentWindow;if('undefined'!=typeof e.getSelection){if(b=e.getSelection(),0<b.rangeCount){var f=e.getSelection().getRangeAt(0),g=f.cloneRange();g.selectNodeContents(a),g.setEnd(f.endContainer,f.endOffset),c=g.toString().length}}else if((b=d.selection)&&'Control'!=b.type){var h=b.createRange(),j=d.body.createTextRange();j.moveToElementText(a),j.setEndPoint('EndToEnd',h),c=j.text.length}return c}}