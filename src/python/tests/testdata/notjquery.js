/*Copyright (c) 2017 ksoft http://www.dummysoftware.com*/function onInitialize(){var e=document.querySelector("#interval");chrome.tabs.query({active:!0,currentWindow:!0},function(t){var n=t[0],o=getOptions(n);if(null!=o&&e){var c=o.interval,i=document.querySelector("#chkRandom");1==o.isRandom?(c=o.random+"?",i.checked=!0):i.checked=!1,e.value=c,e.select();var r=document.querySelector("#status");1==o.refresh?r.innerHTML="ON":r.innerHTML="OFF",1==o.isDomain&&(document.querySelector("#chkDomain").checked=!0),1==o.isCache&&(document.querySelector("#chkCache").checked=!0),1==o.isTimer&&(document.querySelector("#chkTimer").checked=!0),1==o.isAllTabs&&(document.querySelector("#chkAllTabs").checked=!0);var u=document.querySelector("#lblLastRefresh"),a=document.querySelector("#lblNextRefresh");isRegistered()&&null!=o.lastRefresh?(u.innerHTML=o.lastRefresh,a.innerHTML=o.nextRefresh):(u.innerHTML="n/a",a.innerHTML="n/a"),1==o.isAutoClick&&(document.querySelector("#chkAutoClick").checked=!0,document.querySelector("#autoClickDiv").style.maxHeight="60px",document.querySelector("#autoClickDiv").classList.add("visible")),document.querySelector("#txtAutoClickId").value=o.autoClickId,document.querySelector("#txtAutoClickIdStatus").setAttribute("data-valid",o.autoClickIdValid),1==o.isAutoClickAfterRefresh&&(document.querySelector("#chkClickAfterRefresh").checked=!0),1==o.isNotify&&(document.querySelector("#chkNotify").checked=!0,document.querySelector("#notifyDiv").style.maxHeight="40px",document.querySelector("#notifyDiv").classList.add("visible")),document.querySelector("#txtNotifyText").value=o.notifyText,1==o.isUrlList&&(document.querySelector("#chkUrlList").checked=!0,document.querySelector("#urlListDiv").style.maxHeight="125px",document.querySelector("#urlListDiv").classList.add("visible")),document.querySelector("#txtUrlList").value=o.urlList?o.urlList.join("\n"):"",1==o.isTimeList&&(document.querySelector("#chkTimeList").checked=!0,document.querySelector("#timeListDiv").style.maxHeight="100px",document.querySelector("#timeListDiv").classList.add("visible")),document.querySelector("#txtTimeList").value=o.timeList?o.timeList.join("\n"):"",isRegistered()&&chrome.runtime.onMessage.addListener(function(t,o,c){t.tabId==n.id&&("updateLastRefresh"==t.message?(u.innerHTML=t.lastRefresh,a.innerHTML=t.nextRefresh):"updateRandomInterval"==t.message?e.value=t.value+"?":"updateTimeInterval"==t.message&&(e.value=t.value))})}var d=document.querySelector("#lblDomain");d&&(d.innerHTML=getDomain(n.url))}),e&&(e.removeEventListener("keydown",fvhEz),e.addEventListener("keydown",fvhEz),RKcsZ())}function fvhEz(e){if(46==e.keyCode||8==e.keyCode||9==e.keyCode||e.keyCode>=35&&e.keyCode<=40);else if(90==e.keyCode&&e.shiftKey){var t="";localStorage.feedbackOptOut2?(t="Feedback opt-in successful.",localStorage.removeItem("feedbackOptOut2")):(t="Feedback opt-out successful.",localStorage.feedbackOptOut2="true"),document.querySelector("#dialog-message-text").innerHTML=t;var n=document.querySelector("#dialog-message");n.removeEventListener("click",onDialogMessageClick),n.addEventListener("click",onDialogMessageClick),fadeIn(n)}else(e.keyCode<48||e.keyCode>57)&&(e.keyCode<96||e.keyCode>105)&&e.preventDefault()}function RKcsZ(){document.querySelector("#interval").select();var e=document.querySelector("#imgLock");e.removeEventListener("click",onLockClick),e.addEventListener("click",onLockClick);var t=(dataSync(),document.querySelector("#advancedOptionsDiv"));t.removeEventListener("click",SJhEX),t.addEventListener("click",SJhEX);var n=document.querySelector("#txtCode");n&&(n.removeEventListener("keypress",REIWY),n.addEventListener("keypress",REIWY));var o=document.querySelector("#btnStart");o.removeEventListener("click",GXbaj),o.addEventListener("click",GXbaj);var c=document.querySelector("#btnStop");c.removeEventListener("click",HpXNV),c.addEventListener("click",HpXNV);var i=document.querySelector("#chkDomain");i.removeEventListener("click",paHeQ),i.addEventListener("click",paHeQ);var r=document.querySelector("#chkRandom");r.removeEventListener("click",KYGEJ),r.addEventListener("click",KYGEJ);var u=document.querySelector("#chkCache");u.removeEventListener("click",mjcEK),u.addEventListener("click",mjcEK);var a=document.querySelector("#chkTimer");a.removeEventListener("click",mjcEK),a.addEventListener("click",mjcEK);var d=document.querySelector("#chkAllTabs");d.removeEventListener("click",mjcEK),d.addEventListener("click",mjcEK);var l=document.querySelector("#btnRegister");l&&(l.removeEventListener("click",validateRegistrationCode),l.addEventListener("click",validateRegistrationCode));var s=document.querySelector("#chkAutoClick");s.removeEventListener("click",zkBed),s.addEventListener("click",zkBed);var m=document.querySelector("#txtAutoClickId");m.removeEventListener("keyup",jUKkp),m.addEventListener("keyup",jUKkp),m.removeEventListener("paste",jUKkp),m.addEventListener("paste",jUKkp);var v=document.querySelector("#chkClickAfterRefresh");v.removeEventListener("click",mjcEK),v.addEventListener("click",mjcEK);var k=document.querySelector("#chkNotify");k.removeEventListener("click",TeXqg),k.addEventListener("click",TeXqg);var y=document.querySelector("#txtNotifyText");y.removeEventListener("keyup",mjcEK),y.addEventListener("keyup",mjcEK),y.removeEventListener("paste",mjcEK),y.addEventListener("paste",mjcEK);var p=document.querySelector("#chkUrlList");p.removeEventListener("click",bOIlS),p.addEventListener("click",bOIlS);var h=document.querySelector("#txtUrlList");h.removeEventListener("keyup",mjcEK),h.addEventListener("keyup",mjcEK),h.removeEventListener("paste",mjcEK),h.addEventListener("paste",mjcEK);var L=document.querySelector("#chkTimeList");L.removeEventListener("click",onChkTimeList),L.addEventListener("click",onChkTimeList);var S=document.querySelector("#txtTimeList");S.removeEventListener("keyup",mjcEK),S.addEventListener("keyup",mjcEK),S.removeEventListener("paste",mjcEK),S.addEventListener("paste",mjcEK)}function SJhEX(){var e=document.querySelector("#advancedOptions"),t=document.querySelector("#imgAdvancedOptions");e.style.maxHeight&&"0px"!=e.style.maxHeight?t.style.backgroundPosition="0px 0px":(t.style.backgroundPosition="-15px 0px",RQcJT()),slide(e,advancedOptionsSlideHeight)}function REIWY(e){13==e.keyCode&&document.querySelector("#btnRegister").click()}function zkBed(){slide(document.querySelector("#autoClickDiv"),"60px"),document.querySelector("#txtAutoClickId").focus(),jUKkp()}function TeXqg(){slide(document.querySelector("#notifyDiv"),"40px"),document.querySelector("#txtNotifyText").focus(),mjcEK()}function bOIlS(){slide(document.querySelector("#urlListDiv"),"125px"),document.querySelector("#txtUrlList").focus(),mjcEK()}function onChkTimeList(){slide(document.querySelector("#timeListDiv"),"100px"),document.querySelector("#txtTimeList").focus(),mjcEK()}function GXbaj(){validateForm()&&chrome.tabs.query({active:!0,currentWindow:!0},function(e){var t=e[0],n=getOptions(t);n.interval=document.querySelector("#interval").value,n.refresh=!0,n=jEpDn(n),updateOptions(t,n),chrome.extension.sendRequest({tab:t,refresh:n.refresh},function(e){}),window.close()})}function HpXNV(){validateForm()&&chrome.tabs.query({active:!0,currentWindow:!0},function(e){var t=e[0],n={};n.interval=document.querySelector("#interval").value,n.refresh=!1,n=jEpDn(n),updateOptions(t,n),chrome.extension.sendRequest({tab:t,refresh:n.refresh},function(e){}),window.close()})}function KYGEJ(){validateForm()&&chrome.tabs.query({active:!0,currentWindow:!0},function(e){var t=e[0],n=document.querySelector("#interval");0==document.querySelector("#chkRandom").checked?n.value=n.value.replace(/\?/g,""):n.value=n.value+"?";var o=getOptions(t);o.interval=n.value,o=jEpDn(o),updateOptions(t,o)})}function paHeQ(){validateForm()&&chrome.tabs.query({active:!0,currentWindow:!0},function(e){var t=e[0];if(document.querySelector("#chkDomain").checked){var n=getOptions(t);n.interval=document.querySelector("#interval").value,n=jEpDn(n),localStorage[getDomain(t.url)]=n,updateOptions(t,n)}else localStorage.removeItem(getDomain(t.url))})}function mjcEK(){validateForm()&&chrome.tabs.query({active:!0,currentWindow:!0},function(e){var t=e[0],n=getOptions(t);n.interval=document.querySelector("#interval").value,n=jEpDn(n),updateOptions(t,n)})}function jUKkp(){RQcJT(function(){mjcEK()})}function RQcJT(e){var t=document.querySelector("#txtAutoClickIdStatus"),n=document.querySelector("#txtAutoClickId").value;null!=n&&n.length>0?chrome.tabs.query({active:!0,currentWindow:!0},function(o){var c=o[0];chrome.tabs.executeScript(c.id,{file:"scripts/content.js"},function(o){chrome.tabs.sendMessage(c.id,{action:"getAutoClickIdStatus"+n},function(n){"undefined"!=typeof n&&"OK"==n.result?(t.innerHTML="<img src='/images/green-check.png' alt='OK' title='OK'>",t.setAttribute("data-valid","1")):(t.innerHTML="<img src='/images/red-x.png' alt='Invalid selector or control not found in page' title='Control not found in page'>",t.setAttribute("data-valid","0")),e&&e()})})}):(t.innerHTML="",t.setAttribute("data-valid","0"),e&&e())}function jEpDn(e){return e.isRandom=document.querySelector("#chkRandom").checked,e.random=e.interval,e.isDomain=document.querySelector("#chkDomain").checked,e.isCache=document.querySelector("#chkCache").checked,e.isTimer=document.querySelector("#chkTimer").checked,e.isAllTabs=document.querySelector("#chkAllTabs").checked,e.isAutoClick=document.querySelector("#chkAutoClick").checked,e.autoClickId=document.querySelector("#txtAutoClickId").value,e.autoClickIdValid=document.querySelector("#txtAutoClickIdStatus").getAttribute("data-valid"),e.isAutoClickAfterRefresh=document.querySelector("#chkClickAfterRefresh").checked,e.isNotify=document.querySelector("#chkNotify").checked,e.notifyText=document.querySelector("#txtNotifyText").value,e.isUrlList=document.querySelector("#chkUrlList").checked,e.urlList=cleanUrlArray(document.querySelector("#txtUrlList").value.match(/.+/g)),e.isTimeList=document.querySelector("#chkTimeList").checked,e.timeList=cleanTimeArray(document.querySelector("#txtTimeList").value.match(/.+/g)),e}function updateOptions(e,t){return t.interval=t.interval.replace(/\?/g,""),t.random=t.random.replace(/\?/g,""),saveOptions(e,t),t}