var Popup={lastTab:"appMain",extId:null,user:null,preferences:null,hideLast:function(){this.lastTab&&$("#"+this.lastTab).hide()},show:function(e){this.hideLast(),this.lastTab=e,$("#"+e).show(),"appMain"===e?this.hideBack():this.showBack()},hideBack:function(){$("#slideapp-back").hide()},showBack:function(){$("#slideapp-back").show()},showMain:function(){this.show("appMain")},showSettings:function(){this.show("appSettings")},showSharingPage:function(){this.show("appSharing")},showLogin:function(){this.show("appLogin")},login:function(e){var t=this;$.ajax({url:Config.server+"/api/login?token="+Config.apiToken+"&app_uid="+this.getExtId(),type:"POST",data:{email:$("#loginEmail").val(),password:$("#loginPw").val()},success:function(e){e&&e.hasOwnProperty("ok")&&e.ok===!0&&e.hasOwnProperty("auth")&&e.hasOwnProperty("app_key")?(chrome.runtime.sendMessage({action:"setUser",user:{auth:e.auth,app_key:e.app_key,earnings:e.earnings}},function(e){}),t.setUser({auth:e.auth,appKey:e.app_key,earnings:e.earnings}),chrome.runtime.sendMessage({action:"setSavings",savings:e.savings},function(e){}),t.setSavings({savings:e.savings}),$("#loginError").hide(),t.showMain()):$("#loginError").show()}})},logout:function(){var e=this;chrome.runtime.sendMessage({action:"clearUser"},function(e){}),e.setUser({auth:null,appKey:null,earnings:null}),e.showMain()},loadFAQs:function(e){var t="",n="";for(var s in e)t+='<li role="presentation"><a href="#piggyfaq'+s+'" aria-controls="piggyfaq01" role="tab" data-toggle="tab">'+e[s].q+"</a></li>",n+='<div role="tabpanel" class="tab-pane" id="piggyfaq'+s+'">                      <h5>'+e[s].q+'</h5>                      <h6><a class="piggy-tab-pane-close">< back to FAQ list</a></h6>                      <p>'+e[s].a+"</p>                  </div>";$("#appFaqs .piggy-faq-nav").html(t),$("#appFaqs .tab-content").html(n),$(".piggy-tab-pane-close").click(function(){$(this).parent().parent().removeClass("active"),$(".piggy-faq-nav li").removeClass("active")})},showFAQs:function(){this.show("appFaqs")},getExtId:function(){return this.extId},setExtId:function(e){this.extId=e},setUser:function(e){this.user=e,e&&e.hasOwnProperty("auth")&&(e.auth?($("#preLogin").hide(),$("#earnings").html(this.getUser().earnings),$("#accountActivity").show()):($("#preLogin").show(),$("#earnings").html("0.00"),$("#accountActivity").hide()))},getUser:function(){return this.user},setPreferences:function(e){this.preferences=$.extend(Config.defaultPreferences,e),$("#appSettings input.cashbackAlerts").bootstrapSwitch("state",this.preferences.cashbackAlerts),$("#appSettings input.dailyDeals").bootstrapSwitch("state",this.preferences.dailyDeals),$("#appSettings input.worksHere").bootstrapSwitch("state",this.preferences.worksHere)},savePreference:function(e,t){this.preferences.hasOwnProperty(e)&&(this.preferences[e]=t,chrome.runtime.sendMessage({action:"setPreferences",preferences:this.preferences}))},getSavings:function(){return this.savings},setSavings:function(e){this.savings=e,isNaN(parseFloat(e))||$("#savings").html(parseFloat(e).toFixed(2))}};chrome.tabs.query({active:!0,currentWindow:!0},function(e){var t=e[0];$(document).ready(function(){$(".this-site").html(Url.getHost(t.url)),chrome.storage.local.get("_cofund.id",function(e){function n(s){var o=$(this),a=["www.joinpiggy.com","newtab"].filter(function(e){return Url.getHost(t.url)===e}).length;return a?void o.text("Thank you for your suggestion"):(s.preventDefault(),void $.get(Config.server+"/toolbar/addStoreRequest?domain_name="+Url.getHost(t.url)+"&store_title="+Url.getHost(t.url)+"&app_uid="+encodeURIComponent(e["_cofund.id"]),function(e){o.text("Thank you for your suggestion"),o.off("click",n)}))}$(".this-site").parent().on("click",n)}),$("#slideapp-close").on("click",function(e){e.preventDefault(),window.close()}),$("[name='my-checkbox']").bootstrapSwitch(),$("[name='my-checkbox']").attr("tabindex","-1"),$(".piggy-sliderapp-back").on("click",function(){Popup.showMain()}),$("#account, .disable-cashback").on("click",function(e){e.preventDefault(),Popup.showSettings()}),$("#appSettings input").on("switchChange.bootstrapSwitch",function(e,t){var n=$(this).attr("data-preference");Popup.savePreference(n,t)}),$("#shareButtons").share({networks:["facebook","reddit","twitter","googleplus","pinterest","linkedin","tumblr","stumbleupon","digg","email"]}),$("#sharepopup").on("click",function(e){e.preventDefault(),Popup.showSharingPage()}),$.getJSON(Config.server+"/toolbar/faqs?callback=?",{},function(e){Popup.loadFAQs(e)}),$("#faqs").on("click",function(e){e.preventDefault(),Popup.showFAQs()}),$("#sharepopup").on("click",function(e){e.preventDefault(),Popup.showSharingPage()}),$(".login-cashback").on("click",function(e){e.preventDefault(),Popup.showLogin()}),$("#loginForm").on("submit",function(e){e.preventDefault(),Popup.login(t.id)}),$("#fbAuth").on("click",function(e){e.preventDefault(),chrome.tabs.create({url:Config.server+"/api/fbauth?app_uid="+Popup.getExtId()+"&token="+Config.apiToken},function(e){})}),$("#logout").on("click",function(e){e.preventDefault(),Popup.logout()}),$("#sleeping").css("display","block"),chrome.tabs.sendMessage(t.id,{action:"getConfig"},function(e){if(e&&e.hasOwnProperty("extId")&&Popup.setExtId(e.extId),e&&e.hasOwnProperty("user")&&Popup.setUser(e.user),e&&e.hasOwnProperty("preferences")&&Popup.setPreferences(e.preferences),e&&e.hasOwnProperty("savings")&&Popup.setSavings(e.savings),e){if(e.hasOwnProperty("cashback")&&e.cashback.hasOwnProperty("pay")&&Number(e.cashback.pay)>0)$("#sleeping").css("display","none"),$("#cashback").css("display","block"),$("#percent").text(CoFund.Cashback.formatForDisplay(e.cashback)),$("a#seeDeals").attr("href",Config.server+"/coupons/"+e.cashback.shortName),0===e.codes.length&&$(".see-coupons, #autotry").hide();else{if(!(e.hasOwnProperty("codes")&&e.codes.length>0&&e.hasOwnProperty("codeDetails")))return;$("#sleeping, #cashback").css("display","none"),$("#coupons").css("display","block"),e.hasOwnProperty("ruleset")&&!e.ruleset&&($("#coupons h3").html("Piggy has coupons!"),$("#coupons p.piggy-popup-autotry-txt").html("Click on the See Coupons button to see what<br>he has for you..."))}$(".see-coupons").on("click",function(n){n.preventDefault(),chrome.tabs.sendMessage(t.id,{action:"showCouponDetails",codes:e.codes,codeDetails:e.codeDetails}),window.close()})}})})});
//# sourceMappingURL=chrome-minified/src/popup/popup.js.map